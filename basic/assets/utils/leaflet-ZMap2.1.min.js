/* @preserve
 * Leaflet 1.3.4, a JS library for interactive maps. http://leafletjs.com
 * (c) 2010-2018 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 *//* esri-leaflet - v2.2.3 - Thu Aug 16 2018 13:01:56 GMT-0700 (PDT)
 * Copyright (c) 2018 Environmental Systems Research Institute, Inc.
 * Apache-2.0 *//*
 (c) 2014, Vladimir Agafonkin
 simpleheat, a tiny JavaScript library for drawing heatmaps with Canvas
 https://github.com/mourner/simpleheat
*//**
 * Created by dingzhuang on 2018/7/30.
 */
!function(a,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(a.L={})}(this,function(a){function e(d){var n,b,c,a;b=1;for(c=arguments.length;b<c;b++)for(n in a=arguments[b],a)d[n]=a[n];return d}function g(d,n){var b=Array.prototype.slice;if(d.bind)return d.bind.apply(d,b.call(arguments,1));var c=b.call(arguments,2);return function(){return d.apply(n,c.length?c.concat(b.call(arguments)):arguments)}}function f(d){return d._leaflet_id=d._leaflet_id||++fa,d._leaflet_id}function m(d,n,b){var A,c,a,l;return l=function(){A=!1;c&&(a.apply(b,c),c=!1)},a=function(){A?c=arguments:(d.apply(b,arguments),setTimeout(l,n),A=!0)}}function k(d,n,b){var A=n[1];n=n[0];var c=A-n;return d===A&&b?d:((d-n)%c+c)%c+n}function h(){return!1}function q(d,n){var b=Math.pow(10,void 0===n?6:n);return Math.round(d*b)/b}function p(d){return d.trim?d.trim():d.replace(/^\s+|\s+$/g,"")}function u(d){return p(d).split(/\s+/)}function v(d,n){d.hasOwnProperty("options")||(d.options=d.options?Ib(d.options):{});for(var b in n)d.options[b]=n[b];return d.options}function z(d,n,b){var A=[],c;for(c in d)A.push(encodeURIComponent(b?c.toUpperCase():c)+"\x3d"+encodeURIComponent(d[c]));return(n&&-1!==n.indexOf("?")?"\x26":"?")+A.join("\x26")}function w(d,n){return d.replace(vb,function(d,b){var A=n[b];if(void 0===A)throw Error("No value provided for variable "+d);return"function"==typeof A&&(A=A(n)),A})}function F(d,n){for(var b=0;b<d.length;b++)if(d[b]===n)return b;return-1}function E(d){return window["webkit"+d]||window["moz"+d]||window["ms"+d]}function H(d){var n=+new Date,b=Math.max(0,16-(n-ib));return ib=n+b,window.setTimeout(d,b)}function P(d,n,b){if(!b||ab!==H)return ab.call(window,g(d,n));d.call(n)}function V(d){d&&bb.call(window,d)}function ba(){}function Ca(d){if("undefined"!=typeof L&&L&&L.Mixin){d=na(d)?d:[d];for(var n=0;n<d.length;n++)d[n]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",Error().stack)}}function B(d,n,b){this.x=b?Math.round(d):d;this.y=b?Math.round(n):n}function I(d,n,b){return d instanceof B?d:na(d)?new B(d[0],d[1]):void 0===d||null===d?d:"object"==typeof d&&"x"in d&&"y"in d?new B(d.x,d.y):new B(d,n,b)}function J(d,n){if(d)for(var b=n?[d,n]:d,c=0,a=b.length;c<a;c++)this.extend(b[c])}function ka(d,n){return!d||d instanceof J?d:new J(d,n)}function ca(d,n){if(d)for(var b=n?[d,n]:d,c=0,a=b.length;c<a;c++)this.extend(b[c])}function U(d,n){return d instanceof ca?d:new ca(d,n)}function N(d,n,b){if(isNaN(d)||isNaN(n))throw Error("Invalid LatLng object: ("+d+", "+n+")");this.lat=+d;this.lng=+n;void 0!==b&&(this.alt=+b)}function O(d,n,b){return d instanceof N?d:na(d)&&"object"!=typeof d[0]?3===d.length?new N(d[0],d[1],d[2]):2===d.length?new N(d[0],d[1]):null:void 0===d||null===d?d:"object"==typeof d&&"lat"in d?new N(d.lat,"lng"in d?d.lng:d.lon,d.alt):void 0===n?null:new N(d,n,b)}function Da(d,n,b,c){if(na(d))return this._a=d[0],this._b=d[1],this._c=d[2],void(this._d=d[3]);this._a=d;this._b=n;this._c=b;this._d=c}function qa(d,n,b,c){return new Da(d,n,b,c)}function cb(d){return document.createElementNS("http://www.w3.org/2000/svg",d)}function ra(d,n){var b,c,a,l,r,f,e="";b=0;for(a=d.length;b<a;b++){c=0;for(l=(r=d[b]).length;c<l;c++)f=r[c],e+=(c?"L":"M")+f.x+" "+f.y;e+=n?sc?"z":"x":""}return e||"M0 0"}function da(d){return 0<=navigator.userAgent.toLowerCase().indexOf(d)}function Jb(d,n,b,c){return"touchstart"===n?Ja(d,b,c):"touchmove"===n?y(d,b,c):"touchend"===n&&aa(d,b,c),this}function jb(d,n,b){b=d["_leaflet_"+n+b];return"touchstart"===n?d.removeEventListener(Ic,b,!1):"touchmove"===n?d.removeEventListener(Jc,b,!1):"touchend"===n&&(d.removeEventListener(Kc,b,!1),d.removeEventListener(Lc,b,!1)),this}function Ja(d,n,b){var c=g(function(d){if("mouse"!==d.pointerType&&d.MSPOINTER_TYPE_MOUSE&&d.pointerType!==d.MSPOINTER_TYPE_MOUSE){if(!(0>xd.indexOf(d.target.tagName)))return;sa(d)}wa(d,n)});d["_leaflet_touchstart"+b]=c;d.addEventListener(Ic,c,!1);$c||(document.documentElement.addEventListener(Ic,x,!0),document.documentElement.addEventListener(Jc,Kb,!0),document.documentElement.addEventListener(Kc,xa,!0),document.documentElement.addEventListener(Lc,xa,!0),$c=!0)}function x(d){Lb[d.pointerId]=d;Mc++}function Kb(d){Lb[d.pointerId]&&(Lb[d.pointerId]=d)}function xa(d){delete Lb[d.pointerId];Mc--}function wa(d,n){d.touches=[];for(var b in Lb)d.touches.push(Lb[b]);d.changedTouches=[d];n(d)}function y(d,n,b){var c=function(d){(d.pointerType!==d.MSPOINTER_TYPE_MOUSE&&"mouse"!==d.pointerType||0!==d.buttons)&&wa(d,n)};d["_leaflet_touchmove"+b]=c;d.addEventListener(Jc,c,!1)}function aa(d,n,b){var c=function(d){wa(d,n)};d["_leaflet_touchend"+b]=c;d.addEventListener(Kc,c,!1);d.addEventListener(Lc,c,!1)}function ya(d,n,b){function c(d){var n;if(Ka){if(!wb||"mouse"===d.pointerType)return;n=Mc}else n=d.touches.length;if(!(1<n)){n=Date.now();var b=n-(a||n);l=d.touches?d.touches[0]:d;r=0<b&&b<=f;a=n}}function A(d){if(r&&!l.cancelBubble){if(Ka){if(!wb||"mouse"===d.pointerType)return;var b,c={};for(b in l)d=l[b],c[b]=d&&d.bind?d.bind(l):d;l=c}l.type="dblclick";n(l);a=null}}var a,l,r=!1,f=250;return d[Mb+tc+b]=c,d[Mb+uc+b]=A,d[Mb+"dblclick"+b]=n,d.addEventListener(tc,c,!1),d.addEventListener(uc,A,!1),d.addEventListener("dblclick",n,!1),this}function K(d,n){var b=d[Mb+uc+n],c=d[Mb+"dblclick"+n];return d.removeEventListener(tc,d[Mb+tc+n],!1),d.removeEventListener(uc,b,!1),wb||d.removeEventListener("dblclick",c,!1),this}function La(d){return"string"==typeof d?document.getElementById(d):d}function R(d,n){var b=d.style[n]||d.currentStyle&&d.currentStyle[n];b&&"auto"!==b||!document.defaultView||(b=(b=document.defaultView.getComputedStyle(d,null))?b[n]:null);return"auto"===b?null:b}function M(d,n,b){d=document.createElement(d);return d.className=n||"",b&&b.appendChild(d),d}function W(d){var n=d.parentNode;n&&n.removeChild(d)}function Ea(d){for(;d.firstChild;)d.removeChild(d.firstChild)}function Aa(d){var n=d.parentNode;n.lastChild!==d&&n.appendChild(d)}function ta(d){var n=d.parentNode;n.firstChild!==d&&n.insertBefore(d,n.firstChild)}function Sa(d,n){if(void 0!==d.classList)return d.classList.contains(n);var b=Ta(d);return 0<b.length&&(new RegExp("(^|\\s)"+n+"(\\s|$)")).test(b)}function G(d,n){if(void 0!==d.classList)for(var b=u(n),c=0,a=b.length;c<a;c++)d.classList.add(b[c]);else Sa(d,n)||(b=Ta(d),za(d,(b?b+" ":"")+n))}function X(d,n){void 0!==d.classList?d.classList.remove(n):za(d,p((" "+Ta(d)+" ").replace(" "+n+" "," ")))}function za(d,n){void 0===d.className.baseVal?d.className=n:d.className.baseVal=n}function Ta(d){return void 0===d.className.baseVal?d.className:d.className.baseVal}function ga(d,n){if("opacity"in d.style)d.style.opacity=n;else if("filter"in d.style)a:{var b=n,c=!1;try{c=d.filters.item("DXImageTransform.Microsoft.Alpha")}catch(Nd){if(1===b)break a}b=Math.round(100*b);c?(c.Enabled=100!==b,c.Opacity=b):d.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(opacity\x3d"+b+")"}}function Ua(d){for(var n=document.documentElement.style,b=0;b<d.length;b++)if(d[b]in n)return d[b];return!1}function T(d,n,b){n=n||new B(0,0);d.style[Nc]=(l?"translate("+n.x+"px,"+n.y+"px)":"translate3d("+n.x+"px,"+n.y+"px,0)")+(b?" scale("+b+")":"")}function Y(d,n){d._leaflet_pos=n;Fa?T(d,n):(d.style.left=n.x+"px",d.style.top=n.y+"px")}function ua(d){return d._leaflet_pos||new B(0,0)}function oa(){c(window,"dragstart",sa)}function C(){D(window,"dragstart",sa)}function ha(d){for(;-1===d.tabIndex;)d=d.parentNode;d.style&&(va(),vc=d,Oc=d.style.outline,d.style.outline="none",c(window,"keydown",va))}function va(){vc&&(vc.style.outline=Oc,vc=void 0,Oc=void 0,D(window,"keydown",va))}function db(d){do d=d.parentNode;while(!(d.offsetWidth&&d.offsetHeight||d===document.body));return d}function Ma(d){var n=d.getBoundingClientRect();return{x:n.width/d.offsetWidth||1,y:n.height/d.offsetHeight||1,boundingClientRect:n}}function c(d,n,b,c){if("object"==typeof n)for(var a in n)ea(d,a,n[a],b);else{a=0;for(var A=(n=u(n)).length;a<A;a++)ea(d,n[a],b,c)}return this}function D(d,n,b,c){if("object"==typeof n)for(var a in n)Va(d,a,n[a],b);else if(n){a=0;for(var A=(n=u(n)).length;a<A;a++)Va(d,n[a],b,c)}else{for(A in d[Na])Va(d,A,d[Na][A]);delete d[Na]}return this}function ea(d,n,b,c){var a=n+f(b)+(c?"_"+f(c):"");if(d[Na]&&d[Na][a])return this;var A=function(n){return b.call(c||d,n||window.event)},l=A;Ka&&0===n.indexOf("touch")?Jb(d,n,A,a):!Wa||"dblclick"!==n||!ya||Ka&&Oa?"addEventListener"in d?"mousewheel"===n?d.addEventListener("onwheel"in d?"wheel":"mousewheel",A,!1):"mouseenter"===n||"mouseleave"===n?(A=function(n){n=n||window.event;la(d,n)&&l(n)},d.addEventListener("mouseenter"===n?"mouseover":"mouseout",A,!1)):("click"===n&&kb&&(A=function(d){var n=d.timeStamp||d.originalEvent&&d.originalEvent.timeStamp,b=Pc&&n-Pc;b&&100<b&&500>b||d.target._simulatedClick&&!d._simulated?Ba(d):(Pc=n,l(d))}),d.addEventListener(n,A,!1)):"attachEvent"in d&&d.attachEvent("on"+n,A):ya(d,A,a);d[Na]=d[Na]||{};d[Na][a]=A}function Va(d,n,b,c){b=n+f(b)+(c?"_"+f(c):"");c=d[Na]&&d[Na][b];if(!c)return this;Ka&&0===n.indexOf("touch")?jb(d,n,b):!Wa||"dblclick"!==n||!K||Ka&&Oa?"removeEventListener"in d?"mousewheel"===n?d.removeEventListener("onwheel"in d?"wheel":"mousewheel",c,!1):d.removeEventListener("mouseenter"===n?"mouseover":"mouseleave"===n?"mouseout":n,c,!1):"detachEvent"in d&&d.detachEvent("on"+n,c):K(d,b);d[Na][b]=null}function pa(d){return d.stopPropagation?d.stopPropagation():d.originalEvent?d.originalEvent._stopped=!0:d.cancelBubble=!0,ia(d),this}function xb(d){return ea(d,"mousewheel",pa),this}function lb(d){return c(d,"mousedown touchstart dblclick",pa),ea(d,"click",Xa),this}function sa(d){return d.preventDefault?d.preventDefault():d.returnValue=!1,this}function Ba(d){return sa(d),pa(d),this}function bc(d,n){if(!n)return new B(d.clientX,d.clientY);var b=Ma(n),c=b.boundingClientRect;return new B((d.clientX-c.left)/b.x-n.clientLeft,(d.clientY-c.top)/b.y-n.clientTop)}function cc(d){return wb?d.wheelDeltaY/2:d.deltaY&&0===d.deltaMode?-d.deltaY/yd:d.deltaY&&1===d.deltaMode?20*-d.deltaY:d.deltaY&&2===d.deltaMode?60*-d.deltaY:d.deltaX||d.deltaZ?0:d.wheelDelta?(d.wheelDeltaY||d.wheelDelta)/2:d.detail&&32765>Math.abs(d.detail)?20*-d.detail:d.detail?d.detail/-32765*60:0}function Xa(d){Qc[d.type]=!0}function ia(d){var n=Qc[d.type];return Qc[d.type]=!1,n}function la(d,n){var b=n.relatedTarget;if(!b)return!0;try{for(;b&&b!==d;)b=b.parentNode}catch(Md){return!1}return b!==d}function mb(d,n){if(!n||!d.length)return d.slice();for(var b=n*n,c=d,a=[c[0]],l=1,r=0,f=c.length;l<f;l++){var e=c[l],h=c[r],k=h.x-e.x,e=h.y-e.y;k*k+e*e>b&&(a.push(c[l]),r=l)}c=d=(r<f-1&&a.push(c[f-1]),a);a=c.length;l=new ("undefined"!=typeof Uint8Array?Uint8Array:Array)(a);l[0]=l[a-1]=1;dc(c,l,b,0,a-1);r=[];for(b=0;b<a;b++)l[b]&&r.push(c[b]);return r}function nb(d,n,b){return Math.sqrt(yb(d,n,b,!0))}function dc(d,n,b,c,a){var A,l,r,f=0;for(l=c+1;l<=a-1;l++)(r=yb(d[l],d[c],d[a],!0))>f&&(A=l,f=r);f>b&&(n[A]=1,dc(d,n,b,c,A),dc(d,n,b,A,a))}function ec(d,n,b,c,a){var A,l,r=c?ad:Ya(d,b),f=Ya(n,b);for(ad=f;;){if(!(r|f))return[d,n];if(r&f)return!1;l=Ya(A=eb(d,n,c=r||f,b,a),b);c===r?(d=A,r=l):(n=A,f=l)}}function eb(d,n,b,c,a){var A,l,r=n.x-d.x;n=n.y-d.y;var f=c.min;c=c.max;return 8&b?(A=d.x+r*(c.y-d.y)/n,l=c.y):4&b?(A=d.x+r*(f.y-d.y)/n,l=f.y):2&b?(A=c.x,l=d.y+n*(c.x-d.x)/r):1&b&&(A=f.x,l=d.y+n*(f.x-d.x)/r),new B(A,l,a)}function Ya(d,n){var b=0;return d.x<n.min.x?b|=1:d.x>n.max.x&&(b|=2),d.y<n.min.y?b|=4:d.y>n.max.y&&(b|=8),b}function yb(d,b,c,a){var n,l=b.x;b=b.y;var A=c.x-l,r=c.y-b,f=A*A+r*r;return 0<f&&(1<(n=((d.x-l)*A+(d.y-b)*r)/f)?(l=c.x,b=c.y):0<n&&(l+=A*n,b+=r*n)),A=d.x-l,r=d.y-b,a?A*A+r*r:new B(l,b)}function Ga(d){return!na(d[0])||"object"!=typeof d[0][0]&&void 0!==d[0][0]}function Nb(d){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Ga(d)}function Ob(d,b,c){var n,a,l,A,r,f,e,h,k=[1,4,2,8];a=0;for(f=d.length;a<f;a++)d[a]._code=Ya(d[a],b);for(A=0;4>A;A++){e=k[A];n=[];a=0;for(l=(f=d.length)-1;a<f;l=a++)r=d[a],l=d[l],r._code&e?l._code&e||((h=eb(l,r,e,b,c))._code=Ya(h,b),n.push(h)):(l._code&e&&((h=eb(l,r,e,b,c))._code=Ya(h,b),n.push(h)),n.push(r));d=n}return d}function Pb(d,b){var n,c,a,l="Feature"===d.type?d.geometry:d,r=l?l.coordinates:null,f=[],e=b&&b.pointToLayer,h=b&&b.coordsToLatLng||ob;if(!r&&!l)return null;switch(l.type){case "Point":return n=h(r),e?e(d,n):new fc(n);case "MultiPoint":c=0;for(a=r.length;c<a;c++)n=h(r[c]),f.push(e?e(d,n):new fc(n));return new zb(f);case "LineString":case "MultiLineString":return c=Qb(r,"LineString"===l.type?0:1,h),new fb(c,b);case "Polygon":case "MultiPolygon":return c=Qb(r,"Polygon"===l.type?1:2,h),new Rb(c,b);case "GeometryCollection":c=0;for(a=l.geometries.length;c<a;c++)(n=Pb({geometry:l.geometries[c],type:"Feature",properties:d.properties},b))&&f.push(n);return new zb(f);default:throw Error("Invalid GeoJSON object.");}}function ob(d){return new N(d[1],d[0],d[2])}function Qb(d,b,c){for(var n,a=[],l=0,A=d.length;l<A;l++)n=b?Qb(d[l],b-1,c):(c||ob)(d[l]),a.push(n);return a}function Ab(d,b){return b="number"==typeof b?b:6,void 0!==d.alt?[q(d.lng,b),q(d.lat,b),q(d.alt,b)]:[q(d.lng,b),q(d.lat,b)]}function Sb(d,b,c,a){for(var n=[],l=0,A=d.length;l<A;l++)n.push(b?Sb(d[l],b-1,c,a):Ab(d[l],a));return!b&&c&&n.push(n[0]),n}function pb(d,b){return d.feature?e({},d.feature,{geometry:b}):Tb(b)}function Tb(d){return"Feature"===d.type||"FeatureCollection"===d.type?d:{type:"Feature",properties:{},geometry:d}}function wc(d,b){return new gb(d,b)}function xc(d,b){return new Ub(d,b)}function yc(d){return bd?new cd(d):null}function zc(d){return sc||Ac?new gc(d):null}var Bc=Object.freeze;Object.freeze=function(d){return d};var Ib=Object.create||function(){function d(){}return function(b){return d.prototype=b,new d}}(),fa=0,vb=/\{ *([\w_-]+) *\}/g,na=Array.isArray||function(d){return"[object Array]"===Object.prototype.toString.call(d)},ib=0,ab=window.requestAnimationFrame||E("RequestAnimationFrame")||H,bb=window.cancelAnimationFrame||E("CancelAnimationFrame")||E("CancelRequestAnimationFrame")||function(d){window.clearTimeout(d)},qb=(Object.freeze||Object)({freeze:Bc,extend:e,create:Ib,bind:g,lastId:fa,stamp:f,throttle:m,wrapNum:k,falseFn:h,formatNum:q,trim:p,splitWords:u,setOptions:v,getParamString:z,template:w,isArray:na,indexOf:F,emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs\x3d",requestFn:ab,cancelFn:bb,requestAnimFrame:P,cancelAnimFrame:V});ba.extend=function(d){var b=function(){this.initialize&&this.initialize.apply(this,arguments);this.callInitHooks()},c=b.__super__=this.prototype,a=Ib(c);a.constructor=b;b.prototype=a;for(var l in this)this.hasOwnProperty(l)&&"prototype"!==l&&"__super__"!==l&&(b[l]=this[l]);return d.statics&&(e(b,d.statics),delete d.statics),d.includes&&(Ca(d.includes),e.apply(null,[a].concat(d.includes)),delete d.includes),a.options&&(d.options=e(Ib(a.options),d.options)),e(a,d),a._initHooks=[],a.callInitHooks=function(){if(!this._initHooksCalled){c.callInitHooks&&c.callInitHooks.call(this);this._initHooksCalled=!0;for(var d=0,b=a._initHooks.length;d<b;d++)a._initHooks[d].call(this)}},b};ba.include=function(d){return e(this.prototype,d),this};ba.mergeOptions=function(d){return e(this.prototype.options,d),this};ba.addInitHook=function(d){var b=Array.prototype.slice.call(arguments,1);return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push("function"==typeof d?d:function(){this[d].apply(this,b)}),this};var ja={on:function(d,b,c){if("object"==typeof d)for(var n in d)this._on(n,d[n],b);else{n=0;for(var a=(d=u(d)).length;n<a;n++)this._on(d[n],b,c)}return this},off:function(d,b,c){if(d)if("object"==typeof d)for(var n in d)this._off(n,d[n],b);else{n=0;for(var a=(d=u(d)).length;n<a;n++)this._off(d[n],b,c)}else delete this._events;return this},_on:function(d,b,c){this._events=this._events||{};var n=this._events[d];n||(n=[],this._events[d]=n);c===this&&(c=void 0);d={fn:b,ctx:c};for(var a=0,l=n.length;a<l;a++)if(n[a].fn===b&&n[a].ctx===c)return;n.push(d)},_off:function(d,b,c){var n,a,l;if(this._events&&(n=this._events[d]))if(b){if(c===this&&(c=void 0),n)for(a=0,l=n.length;a<l;a++){var A=n[a];if(A.ctx===c&&A.fn===b)return A.fn=h,this._firingCount&&(this._events[d]=n=n.slice()),void n.splice(a,1)}}else{a=0;for(l=n.length;a<l;a++)n[a].fn=h;delete this._events[d]}},fire:function(d,b,c){if(!this.listens(d,c))return this;b=e({},b,{type:d,target:this,sourceTarget:b&&b.sourceTarget||this});if(this._events&&(d=this._events[d])){this._firingCount=this._firingCount+1||1;for(var n=0,a=d.length;n<a;n++){var l=d[n];l.fn.call(l.ctx||this,b)}this._firingCount--}return c&&this._propagateEvent(b),this},listens:function(d,b){var n=this._events&&this._events[d];if(n&&n.length)return!0;if(b)for(var c in this._eventParents)if(this._eventParents[c].listens(d,b))return!0;return!1},once:function(d,b,c){if("object"==typeof d){for(var n in d)this.once(n,d[n],b);return this}var a=g(function(){this.off(d,b,c).off(d,a,c)},this);return this.on(d,b,c).on(d,a,c)},addEventParent:function(d){return this._eventParents=this._eventParents||{},this._eventParents[f(d)]=d,this},removeEventParent:function(d){return this._eventParents&&delete this._eventParents[f(d)],this},_propagateEvent:function(d){for(var b in this._eventParents)this._eventParents[b].fire(d.type,e({layer:d.target,propagatedFrom:d.target},d),!0)}};ja.addEventListener=ja.on;ja.removeEventListener=ja.clearAllEventListeners=ja.off;ja.addOneTimeEventListener=ja.once;ja.fireEvent=ja.fire;ja.hasEventListeners=ja.listens;var Bb=ba.extend(ja),Pa=Math.trunc||function(d){return 0<d?Math.floor(d):Math.ceil(d)};B.prototype={clone:function(){return new B(this.x,this.y)},add:function(d){return this.clone()._add(I(d))},_add:function(d){return this.x+=d.x,this.y+=d.y,this},subtract:function(d){return this.clone()._subtract(I(d))},_subtract:function(d){return this.x-=d.x,this.y-=d.y,this},divideBy:function(d){return this.clone()._divideBy(d)},_divideBy:function(d){return this.x/=d,this.y/=d,this},multiplyBy:function(d){return this.clone()._multiplyBy(d)},_multiplyBy:function(d){return this.x*=d,this.y*=d,this},scaleBy:function(d){return new B(this.x*d.x,this.y*d.y)},unscaleBy:function(d){return new B(this.x/d.x,this.y/d.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Pa(this.x),this.y=Pa(this.y),this},distanceTo:function(d){var b=(d=I(d)).x-this.x;d=d.y-this.y;return Math.sqrt(b*b+d*d)},equals:function(d){return(d=I(d)).x===this.x&&d.y===this.y},contains:function(d){return d=I(d),Math.abs(d.x)<=Math.abs(this.x)&&Math.abs(d.y)<=Math.abs(this.y)},toString:function(){return"Point("+q(this.x)+", "+q(this.y)+")"}};J.prototype={extend:function(d){return d=I(d),this.min||this.max?(this.min.x=Math.min(d.x,this.min.x),this.max.x=Math.max(d.x,this.max.x),this.min.y=Math.min(d.y,this.min.y),this.max.y=Math.max(d.y,this.max.y)):(this.min=d.clone(),this.max=d.clone()),this},getCenter:function(d){return new B((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,d)},getBottomLeft:function(){return new B(this.min.x,this.max.y)},getTopRight:function(){return new B(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(d){var b,c;return(d="number"==typeof d[0]||d instanceof B?I(d):ka(d))instanceof J?(b=d.min,c=d.max):b=c=d,b.x>=this.min.x&&c.x<=this.max.x&&b.y>=this.min.y&&c.y<=this.max.y},intersects:function(d){d=ka(d);var b=this.min,c=this.max,a=d.min;d=d.max;var l=d.y>=b.y&&a.y<=c.y;return d.x>=b.x&&a.x<=c.x&&l},overlaps:function(d){d=ka(d);var b=this.min,c=this.max,a=d.min;d=d.max;var l=d.y>b.y&&a.y<c.y;return d.x>b.x&&a.x<c.x&&l},isValid:function(){return!(!this.min||!this.max)}};ca.prototype={extend:function(d){var b,c,a=this._southWest,l=this._northEast;if(d instanceof N)c=b=d;else{if(!(d instanceof ca))return d?this.extend(O(d)||U(d)):this;if(b=d._southWest,c=d._northEast,!b||!c)return this}return a||l?(a.lat=Math.min(b.lat,a.lat),a.lng=Math.min(b.lng,a.lng),l.lat=Math.max(c.lat,l.lat),l.lng=Math.max(c.lng,l.lng)):(this._southWest=new N(b.lat,b.lng),this._northEast=new N(c.lat,c.lng)),this},pad:function(d){var b=this._southWest,c=this._northEast,a=Math.abs(b.lat-c.lat)*d;d*=Math.abs(b.lng-c.lng);return new ca(new N(b.lat-a,b.lng-d),new N(c.lat+a,c.lng+d))},getCenter:function(){return new N((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new N(this.getNorth(),this.getWest())},getSouthEast:function(){return new N(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(d){d="number"==typeof d[0]||d instanceof N||"lat"in d?O(d):U(d);var b,c,a=this._southWest,l=this._northEast;return d instanceof ca?(b=d.getSouthWest(),c=d.getNorthEast()):b=c=d,b.lat>=a.lat&&c.lat<=l.lat&&b.lng>=a.lng&&c.lng<=l.lng},intersects:function(d){d=U(d);var b=this._southWest,c=this._northEast,a=d.getSouthWest();d=d.getNorthEast();var l=d.lng>=b.lng&&a.lng<=c.lng;return d.lat>=b.lat&&a.lat<=c.lat&&l},overlaps:function(d){d=U(d);var b=this._southWest,c=this._northEast,a=d.getSouthWest();d=d.getNorthEast();var l=d.lng>b.lng&&a.lng<c.lng;return d.lat>b.lat&&a.lat<c.lat&&l},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join()},equals:function(d,b){return!!d&&(d=U(d),this._southWest.equals(d.getSouthWest(),b)&&this._northEast.equals(d.getNorthEast(),b))},isValid:function(){return!(!this._southWest||!this._northEast)}};N.prototype={equals:function(d,b){return!!d&&(d=O(d),Math.max(Math.abs(this.lat-d.lat),Math.abs(this.lng-d.lng))<=(void 0===b?1E-9:b))},toString:function(d){return"LatLng("+q(this.lat,d)+", "+q(this.lng,d)+")"},distanceTo:function(d){return ma.distance(this,O(d))},wrap:function(){return ma.wrapLatLng(this)},toBounds:function(d){d=180*d/40075017;var b=d/Math.cos(Math.PI/180*this.lat);return U([this.lat-d,this.lng-b],[this.lat+d,this.lng+b])},clone:function(){return new N(this.lat,this.lng,this.alt)}};var Qa={latLngToPoint:function(d,b){var n=this.projection.project(d),c=this.scale(b);return this.transformation._transform(n,c)},pointToLatLng:function(d,b){var n=this.scale(b),n=this.transformation.untransform(d,n);return this.projection.unproject(n)},project:function(d){return this.projection.project(d)},unproject:function(d){return this.projection.unproject(d)},scale:function(d){return 256*Math.pow(2,d)},zoom:function(d){return Math.log(d/256)/Math.LN2},getProjectedBounds:function(d){if(this.infinite)return null;var b=this.projection.bounds;d=this.scale(d);return new J(this.transformation.transform(b.min,d),this.transformation.transform(b.max,d))},infinite:!1,wrapLatLng:function(d){var b=this.wrapLng?k(d.lng,this.wrapLng,!0):d.lng;return new N(this.wrapLat?k(d.lat,this.wrapLat,!0):d.lat,b,d.alt)},wrapLatLngBounds:function(d){var b=d.getCenter(),c=this.wrapLatLng(b),a=b.lat-c.lat,b=b.lng-c.lng;if(0===a&&0===b)return d;c=d.getSouthWest();d=d.getNorthEast();return new ca(new N(c.lat-a,c.lng-b),new N(d.lat-a,d.lng-b))}},ma=e({},Qa,{wrapLng:[-180,180],R:6371E3,distance:function(d,b){var n=Math.PI/180,c=Math.sin((b.lat-d.lat)*n/2),a=Math.sin((b.lng-d.lng)*n/2),n=c*c+Math.cos(d.lat*n)*Math.cos(b.lat*n)*a*a;return 2*this.R*Math.atan2(Math.sqrt(n),Math.sqrt(1-n))}}),hc={R:6378137,MAX_LATITUDE:85.0511287798,project:function(d){var b=Math.PI/180,c=this.MAX_LATITUDE,c=Math.sin(Math.max(Math.min(c,d.lat),-c)*b);return new B(this.R*d.lng*b,this.R*Math.log((1+c)/(1-c))/2)},unproject:function(d){var b=180/Math.PI;return new N((2*Math.atan(Math.exp(d.y/this.R))-Math.PI/2)*b,d.x*b/this.R)},bounds:function(){var d=6378137*Math.PI;return new J([-d,-d],[d,d])}()};Da.prototype={transform:function(d,b){return this._transform(d.clone(),b)},_transform:function(d,b){return b=b||1,d.x=b*(this._a*d.x+this._b),d.y=b*(this._c*d.y+this._d),d},untransform:function(d,b){return b=b||1,new B((d.x/b-this._b)/this._a,(d.y/b-this._d)/this._c)}};var Cb,Db,ic,jc=e({},ma,{code:"EPSG:3857",projection:hc,transformation:function(){var d=.5/(Math.PI*hc.R);return qa(d,.5,-d,.5)}()}),Rc=e({},jc,{code:"EPSG:900913"}),kc=document.documentElement.style,Vb="ActiveXObject"in window,rb=Vb&&!document.addEventListener,wb="msLaunchUri"in navigator&&!("documentMode"in document),lc=da("webkit"),kb=da("android"),Eb=da("android 2")||da("android 3"),S=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Cc=kb&&da("Google")&&537>S&&!("AudioNode"in window),Fb=!!window.opera,Oa=da("chrome"),Wb=da("gecko")&&!lc&&!Fb&&!Vb,Dc=!Oa&&da("safari"),Gb=da("phantom"),Ec="OTransition"in kc,b=0===navigator.platform.indexOf("Win"),l=Vb&&"transition"in kc,r="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Eb,Ha="MozPerspective"in kc,Fa=!window.L_DISABLE_3D&&(l||r||Ha)&&!Ec&&!Gb,Xb="undefined"!=typeof orientation||da("mobile"),Fc=Xb&&lc,zd=Xb&&r,sb=!window.PointerEvent&&window.MSPointerEvent,Ka=!(!window.PointerEvent&&!sb),Wa=!window.L_NO_TOUCH&&(Ka||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),dd=Xb&&Fb,Ad=Xb&&Wb,tb=1<(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI),bd=!!document.createElement("canvas").getContext,sc=!(!document.createElementNS||!cb("svg").createSVGRect),Ac=!sc&&function(){try{var d=document.createElement("div");d.innerHTML='\x3cv:shape adj\x3d"1"/\x3e';var b=d.firstChild;return b.style.behavior="url(#default#VML)",b&&"object"==typeof b.adj}catch(A){return!1}}(),Bd=(Object.freeze||Object)({ie:Vb,ielt9:rb,edge:wb,webkit:lc,android:kb,android23:Eb,androidStock:Cc,opera:Fb,chrome:Oa,gecko:Wb,safari:Dc,phantom:Gb,opera12:Ec,win:b,ie3d:l,webkit3d:r,gecko3d:Ha,any3d:Fa,mobile:Xb,mobileWebkit:Fc,mobileWebkit3d:zd,msPointer:sb,pointer:Ka,touch:Wa,mobileOpera:dd,mobileGecko:Ad,retina:tb,canvas:bd,svg:sc,vml:Ac}),Ic=sb?"MSPointerDown":"pointerdown",Jc=sb?"MSPointerMove":"pointermove",Kc=sb?"MSPointerUp":"pointerup",Lc=sb?"MSPointerCancel":"pointercancel",xd=["INPUT","SELECT","OPTION"],Lb={},$c=!1,Mc=0,tc=sb?"MSPointerDown":Ka?"pointerdown":"touchstart",uc=sb?"MSPointerUp":Ka?"pointerup":"touchend",Mb="_leaflet_",Nc=Ua(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),mc=Ua(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ed="webkitTransition"===mc||"OTransition"===mc?mc+"End":"transitionend";if("onselectstart"in document)Cb=function(){c(window,"selectstart",sa)},Db=function(){D(window,"selectstart",sa)};else{var nc=Ua(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Cb=function(){if(nc){var d=document.documentElement.style;ic=d[nc];d[nc]="none"}};Db=function(){nc&&(document.documentElement.style[nc]=ic,ic=void 0)}}var vc,Oc,Pc,Cd=(Object.freeze||Object)({TRANSFORM:Nc,TRANSITION:mc,TRANSITION_END:ed,get:La,getStyle:R,create:M,remove:W,empty:Ea,toFront:Aa,toBack:ta,hasClass:Sa,addClass:G,removeClass:X,setClass:za,getClass:Ta,setOpacity:ga,testProp:Ua,setTransform:T,setPosition:Y,getPosition:ua,disableTextSelection:Cb,enableTextSelection:Db,disableImageDrag:oa,enableImageDrag:C,preventOutline:ha,restoreOutline:va,getSizedParentNode:db,getScale:Ma}),Na="_leaflet_events",yd=b&&Oa?2*window.devicePixelRatio:Wb?window.devicePixelRatio:1,Qc={},Dd=(Object.freeze||Object)({on:c,off:D,stopPropagation:pa,disableScrollPropagation:xb,disableClickPropagation:lb,preventDefault:sa,stop:Ba,getMousePosition:bc,getWheelDelta:cc,fakeStop:Xa,skipped:ia,isExternalTarget:la,addListener:c,removeListener:D}),fd=Bb.extend({run:function(d,b,c,a){this.stop();this._el=d;this._inProgress=!0;this._duration=c||.25;this._easeOutPower=1/Math.max(a||.5,.2);this._startPos=ua(d);this._offset=b.subtract(this._startPos);this._startTime=+new Date;this.fire("start");this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=P(this._animate,this);this._step()},_step:function(d){var b=+new Date-this._startTime,c=1E3*this._duration;b<c?this._runFrame(this._easeOut(b/c),d):(this._runFrame(1),this._complete())},_runFrame:function(d,b){var n=this._startPos.add(this._offset.multiplyBy(d));b&&n._round();Y(this._el,n);this.fire("step")},_complete:function(){V(this._animId);this._inProgress=!1;this.fire("end")},_easeOut:function(d){return 1-Math.pow(1-d,this._easeOutPower)}}),Q=Bb.extend({options:{crs:jc,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(d,b){b=v(this,b);this._initContainer(d);this._initLayout();this._onResize=g(this._onResize,this);this._initEvents();b.maxBounds&&this.setMaxBounds(b.maxBounds);void 0!==b.zoom&&(this._zoom=this._limitZoom(b.zoom));b.center&&void 0!==b.zoom&&this.setView(O(b.center),b.zoom,{reset:!0});this._handlers=[];this._layers={};this._zoomBoundLayers={};this._sizeChanged=!0;this.callInitHooks();(this._zoomAnimated=mc&&Fa&&!dd&&this.options.zoomAnimation)&&(this._createAnimProxy(),c(this._proxy,ed,this._catchTransitionEnd,this));this._addLayers(this.options.layers)},setView:function(d,b,c){return b=void 0===b?this._zoom:this._limitZoom(b),d=this._limitCenter(O(d),b,this.options.maxBounds),c=c||{},this._stop(),this._loaded&&!c.reset&&!0!==c&&(void 0!==c.animate&&(c.zoom=e({animate:c.animate},c.zoom),c.pan=e({animate:c.animate,duration:c.duration},c.pan)),this._zoom!==b?this._tryAnimatedZoom&&this._tryAnimatedZoom(d,b,c.zoom):this._tryAnimatedPan(d,c.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(d,b),this)},setZoom:function(d,b){return this._loaded?this.setView(this.getCenter(),d,{zoom:b}):(this._zoom=d,this)},zoomIn:function(d,b){return d=d||(Fa?this.options.zoomDelta:1),this.setZoom(this._zoom+d,b)},zoomOut:function(d,b){return d=d||(Fa?this.options.zoomDelta:1),this.setZoom(this._zoom-d,b)},setZoomAround:function(d,b,c){var n=this.getZoomScale(b),a=this.getSize().divideBy(2);d=(d instanceof B?d:this.latLngToContainerPoint(d)).subtract(a).multiplyBy(1-1/n);a=this.containerPointToLatLng(a.add(d));return this.setView(a,b,{zoom:c})},_getBoundsCenterZoom:function(d,b){b=b||{};d=d.getBounds?d.getBounds():U(d);var n=I(b.paddingTopLeft||b.padding||[0,0]),c=I(b.paddingBottomRight||b.padding||[0,0]),a=this.getBoundsZoom(d,!1,n.add(c));if((a="number"==typeof b.maxZoom?Math.min(b.maxZoom,a):a)===1/0)return{center:d.getCenter(),zoom:a};var n=c.subtract(n).divideBy(2),c=this.project(d.getSouthWest(),a),l=this.project(d.getNorthEast(),a);return{center:this.unproject(c.add(l).divideBy(2).add(n),a),zoom:a}},fitBounds:function(d,b){if(!(d=U(d)).isValid())throw Error("Bounds are not valid.");var n=this._getBoundsCenterZoom(d,b);return this.setView(n.center,n.zoom,b)},fitWorld:function(d){return this.fitBounds([[-90,-180],[90,180]],d)},panTo:function(d,b){return this.setView(d,this._zoom,{pan:b})},panBy:function(d,b){if(d=I(d).round(),b=b||{},!d.x&&!d.y)return this.fire("moveend");if(!0!==b.animate&&!this.getSize().contains(d))return this._resetView(this.unproject(this.project(this.getCenter()).add(d)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new fd,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),b.noMoveStart||this.fire("movestart"),!1!==b.animate){G(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(d).round();this._panAnim.run(this._mapPane,n,b.duration||.25,b.easeLinearity)}else this._rawPanBy(d),this.fire("move").fire("moveend");return this},flyTo:function(d,b,c){function n(d){d=(m*m-Ha*Ha+(d?-1:1)*p*p*D*D)/(2*(d?m:Ha)*p*D);d=Math.sqrt(d*d+1)-d;return 1E-9>d?-18:Math.log(d)}function a(d){return(Math.exp(d)+Math.exp(-d))/2}function l(d){return Ha*(a(q)/a(q+g*d))}function r(d){var b=Ha,n=a(q);d=q+g*d;d=(Math.exp(d)-Math.exp(-d))/2/a(d);return b*(n*d-(Math.exp(q)-Math.exp(-q))/2)/p}function f(){var n=(Date.now()-ea)/Va,c=(1-Math.pow(1-n,1.5))*Fc;1>=n?(this._flyToFrame=P(f,this),this._move(this.unproject(A.add(e.subtract(A).multiplyBy(r(c)/D)),k),this.getScaleZoom(Ha/l(c),k),{flyTo:!0})):this._move(d,b)._moveEnd(!0)}if(!1===(c=c||{}).animate||!Fa)return this.setView(d,b,c);this._stop();var A=this.project(this.getCenter()),e=this.project(d),h=this.getSize(),k=this._zoom;d=O(d);b=void 0===b?k:b;var Ha=Math.max(h.x,h.y),m=Ha*this.getZoomScale(k,b),D=e.distanceTo(A)||1,g=1.42,p=g*g,q=n(0),ea=Date.now(),Fc=(n(1)-q)/g,Va=c.duration?1E3*c.duration:800*Fc;return this._moveStart(!0,c.noMoveStart),f.call(this),this},flyToBounds:function(d,b){var n=this._getBoundsCenterZoom(d,b);return this.flyTo(n.center,n.zoom,b)},setMaxBounds:function(d){return(d=U(d)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=d,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(d){var b=this.options.minZoom;return this.options.minZoom=d,this._loaded&&b!==d&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(d):this},setMaxZoom:function(d){var b=this.options.maxZoom;return this.options.maxZoom=d,this._loaded&&b!==d&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(d):this},panInsideBounds:function(d,b){this._enforcingBounds=!0;var n=this.getCenter(),c=this._limitCenter(n,this._zoom,U(d));return n.equals(c)||this.panTo(c,b),this._enforcingBounds=!1,this},invalidateSize:function(d){if(!this._loaded)return this;d=e({animate:!1,pan:!0},!0===d?{animate:!0}:d);var b=this.getSize();this._sizeChanged=!0;this._lastCenter=null;var c=this.getSize(),a=b.divideBy(2).round(),l=c.divideBy(2).round(),a=a.subtract(l);return a.x||a.y?(d.animate&&d.pan?this.panBy(a):(d.pan&&this._rawPanBy(a),this.fire("move"),d.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(g(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:b,newSize:c})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(d){if(d=this._locateOptions=e({timeout:1E4,watch:!1},d),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var b=g(this._handleGeolocationResponse,this),c=g(this._handleGeolocationError,this);return d.watch?this._locationWatchId=navigator.geolocation.watchPosition(b,c,d):navigator.geolocation.getCurrentPosition(b,c,d),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(d){var b=d.code;d=d.message||(1===b?"permission denied":2===b?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld();this.fire("locationerror",{code:b,message:"Geolocation error: "+d+"."})},_handleGeolocationResponse:function(d){var b=new N(d.coords.latitude,d.coords.longitude),c=b.toBounds(2*d.coords.accuracy),a=this._locateOptions;if(a.setView){var l=this.getBoundsZoom(c);this.setView(b,a.maxZoom?Math.min(l,a.maxZoom):l)}var b={latlng:b,bounds:c,timestamp:d.timestamp},r;for(r in d.coords)"number"==typeof d.coords[r]&&(b[r]=d.coords[r]);this.fire("locationfound",b)},addHandler:function(d,b){if(!b)return this;var n=this[d]=new b(this);return this._handlers.push(n),this.options[d]&&n.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(n){this._containerId=this._container._leaflet_id=void 0}void 0!==this._locationWatchId&&this.stopLocate();this._stop();W(this._mapPane);this._clearControlPos&&this._clearControlPos();this._resizeRequest&&(V(this._resizeRequest),this._resizeRequest=null);this._clearHandlers();this._loaded&&this.fire("unload");for(var d in this._layers)this._layers[d].remove();for(d in this._panes)W(this._panes[d]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(d,b){var n=M("div","leaflet-pane"+(d?" leaflet-"+d.replace("Pane","")+"-pane":""),b||this._mapPane);return d&&(this._panes[d]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var d=this.getPixelBounds();return new ca(this.unproject(d.getBottomLeft()),this.unproject(d.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(d,b,c){d=U(d);c=I(c||[0,0]);var n=this.getZoom()||0,a=this.getMinZoom(),l=this.getMaxZoom(),r=d.getNorthWest();d=d.getSouthEast();c=this.getSize().subtract(c);var f=ka(this.project(d,n),this.project(r,n)).getSize(),r=Fa?this.options.zoomSnap:1;d=c.x/f.x;c=c.y/f.y;return n=this.getScaleZoom(b?Math.max(d,c):Math.min(d,c),n),r&&(n=r/100*Math.round(n/(r/100)),n=b?Math.ceil(n/r)*r:Math.floor(n/r)*r),Math.max(a,Math.min(l,n))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new B(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(d,b){var n=this._getTopLeftPoint(d,b);return new J(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(d){return this.options.crs.getProjectedBounds(void 0===d?this.getZoom():d)},getPane:function(d){return"string"==typeof d?this._panes[d]:d},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(d,b){var n=this.options.crs;return b=void 0===b?this._zoom:b,n.scale(d)/n.scale(b)},getScaleZoom:function(d,b){var n=this.options.crs;b=void 0===b?this._zoom:b;n=n.zoom(d*n.scale(b));return isNaN(n)?1/0:n},project:function(d,b){return b=void 0===b?this._zoom:b,this.options.crs.latLngToPoint(O(d),b)},unproject:function(d,b){return b=void 0===b?this._zoom:b,this.options.crs.pointToLatLng(I(d),b)},layerPointToLatLng:function(d){d=I(d).add(this.getPixelOrigin());return this.unproject(d)},latLngToLayerPoint:function(d){return this.project(O(d))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(d){return this.options.crs.wrapLatLng(O(d))},wrapLatLngBounds:function(d){return this.options.crs.wrapLatLngBounds(U(d))},distance:function(d,b){return this.options.crs.distance(O(d),O(b))},containerPointToLayerPoint:function(d){return I(d).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(d){return I(d).add(this._getMapPanePos())},containerPointToLatLng:function(d){d=this.containerPointToLayerPoint(I(d));return this.layerPointToLatLng(d)},latLngToContainerPoint:function(d){return this.layerPointToContainerPoint(this.latLngToLayerPoint(O(d)))},mouseEventToContainerPoint:function(d){return bc(d,this._container)},mouseEventToLayerPoint:function(d){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(d))},mouseEventToLatLng:function(d){return this.layerPointToLatLng(this.mouseEventToLayerPoint(d))},_initContainer:function(d){d=this._container=La(d);if(!d)throw Error("Map container not found.");if(d._leaflet_id)throw Error("Map container is already initialized.");c(d,"scroll",this._onScroll,this);this._containerId=f(d)},_initLayout:function(){var d=this._container;this._fadeAnimated=this.options.fadeAnimation&&Fa;G(d,"leaflet-container"+(Wa?" leaflet-touch":"")+(tb?" leaflet-retina":"")+(rb?" leaflet-oldie":"")+(Dc?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var b=R(d,"position");"absolute"!==b&&"relative"!==b&&"fixed"!==b&&(d.style.position="relative");this._initPanes();this._initControlPos&&this._initControlPos()},_initPanes:function(){var d=this._panes={};this._paneRenderers={};this._mapPane=this.createPane("mapPane",this._container);Y(this._mapPane,new B(0,0));this.createPane("tilePane");this.createPane("shadowPane");this.createPane("overlayPane");this.createPane("markerPane");this.createPane("tooltipPane");this.createPane("popupPane");this.options.markerZoomAnimation||(G(d.markerPane,"leaflet-zoom-hide"),G(d.shadowPane,"leaflet-zoom-hide"))},_resetView:function(d,b){Y(this._mapPane,new B(0,0));var n=!this._loaded;this._loaded=!0;b=this._limitZoom(b);this.fire("viewprereset");var c=this._zoom!==b;this._moveStart(c,!1)._move(d,b)._moveEnd(c);this.fire("viewreset");n&&this.fire("load")},_moveStart:function(d,b){return d&&this.fire("zoomstart"),b||this.fire("movestart"),this},_move:function(d,b,c){void 0===b&&(b=this._zoom);var n=this._zoom!==b;return this._zoom=b,this._lastCenter=d,this._pixelOrigin=this._getNewPixelOrigin(d),(n||c&&c.pinch)&&this.fire("zoom",c),this.fire("move",c)},_moveEnd:function(d){return d&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return V(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(d){Y(this._mapPane,this._getMapPanePos().subtract(d))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw Error("Set map center and zoom first.");},_initEvents:function(d){this._targets={};this._targets[f(this._container)]=this;var b=d?D:c;b(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this);this.options.trackResize&&b(window,"resize",this._onResize,this);Fa&&this.options.transform3DLimit&&(d?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){V(this._resizeRequest);this._resizeRequest=P(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0;this._container.scrollLeft=0},_onMoveEnd:function(){var d=this._getMapPanePos();Math.max(Math.abs(d.x),Math.abs(d.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(d,b){for(var n,c=[],a="mouseout"===b||"mouseover"===b,l=d.target||d.srcElement,r=!1;l;){if((n=this._targets[f(l)])&&("click"===b||"preclick"===b)&&!d._simulated&&this._draggableMoved(n)){r=!0;break}if(n&&n.listens(b,!0)){if(a&&!la(l,d))break;if(c.push(n),a)break}if(l===this._container)break;l=l.parentNode}return c.length||r||a||!la(l,d)||(c=[this]),c},_handleDOMEvent:function(d){if(this._loaded&&!ia(d)){var b=d.type;"mousedown"!==b&&"keypress"!==b||ha(d.target||d.srcElement);this._fireDOMEvent(d,b)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(d,b,c){if("click"===d.type){var n=e({},d);n.type="preclick";this._fireDOMEvent(n,n.type,c)}if(!d._stopped&&(c=(c||[]).concat(this._findEventTargets(d,b))).length){var a=c[0];"contextmenu"===b&&a.listens(b,!0)&&sa(d);n={originalEvent:d};if("keypress"!==d.type){var l=a.getLatLng&&(!a._radius||10>=a._radius);n.containerPoint=l?this.latLngToContainerPoint(a.getLatLng()):this.mouseEventToContainerPoint(d);n.layerPoint=this.containerPointToLayerPoint(n.containerPoint);n.latlng=l?a.getLatLng():this.layerPointToLatLng(n.layerPoint)}for(d=0;d<c.length&&!(c[d].fire(b,n,!0),n.originalEvent._stopped||!1===c[d].options.bubblingMouseEvents&&-1!==F(this._mouseEvents,b));d++);}},_draggableMoved:function(d){return(d=d.dragging&&d.dragging.enabled()?d:this).dragging&&d.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var d=0,b=this._handlers.length;d<b;d++)this._handlers[d].disable()},whenReady:function(d,b){return this._loaded?d.call(b||this,{target:this}):this.on("load",d,b),this},_getMapPanePos:function(){return ua(this._mapPane)||new B(0,0)},_moved:function(){var d=this._getMapPanePos();return d&&!d.equals([0,0])},_getTopLeftPoint:function(d,b){return(d&&void 0!==b?this._getNewPixelOrigin(d,b):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(d,b){var n=this.getSize()._divideBy(2);return this.project(d,b)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(d,b,c){c=this._getNewPixelOrigin(c,b);return this.project(d,b)._subtract(c)},_latLngBoundsToNewLayerBounds:function(d,b,c){c=this._getNewPixelOrigin(c,b);return ka([this.project(d.getSouthWest(),b)._subtract(c),this.project(d.getNorthWest(),b)._subtract(c),this.project(d.getSouthEast(),b)._subtract(c),this.project(d.getNorthEast(),b)._subtract(c)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(d){return this.latLngToLayerPoint(d).subtract(this._getCenterLayerPoint())},_limitCenter:function(d,b,c){if(!c)return d;var n=this.project(d,b),a=this.getSize().divideBy(2),a=new J(n.subtract(a),n.add(a));c=this._getBoundsOffset(a,c,b);return c.round().equals([0,0])?d:this.unproject(n.add(c),b)},_limitOffset:function(d,b){if(!b)return d;var n=this.getPixelBounds(),n=new J(n.min.add(d),n.max.add(d));return d.add(this._getBoundsOffset(n,b))},_getBoundsOffset:function(d,b,c){c=ka(this.project(b.getNorthEast(),c),this.project(b.getSouthWest(),c));b=c.min.subtract(d.min);d=c.max.subtract(d.max);return new B(this._rebound(b.x,-d.x),this._rebound(b.y,-d.y))},_rebound:function(d,b){return 0<d+b?Math.round(d-b)/2:Math.max(0,Math.ceil(d))-Math.max(0,Math.floor(b))},_limitZoom:function(d){var b=this.getMinZoom(),c=this.getMaxZoom(),a=Fa?this.options.zoomSnap:1;return a&&(d=Math.round(d/a)*a),Math.max(b,Math.min(c,d))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){X(this._mapPane,"leaflet-pan-anim");this.fire("moveend")},_tryAnimatedPan:function(d,b){var n=this._getCenterOffset(d)._trunc();return!(!0!==(b&&b.animate)&&!this.getSize().contains(n))&&(this.panBy(n,b),!0)},_createAnimProxy:function(){var d=this._proxy=M("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(d);this.on("zoomanim",function(d){var b=Nc,n=this._proxy.style[b];T(this._proxy,this.project(d.center,d.zoom),this.getZoomScale(d.zoom,1));n===this._proxy.style[b]&&this._animatingZoom&&this._onZoomTransitionEnd()},this);this.on("load moveend",function(){var d=this.getCenter(),b=this.getZoom();T(this._proxy,this.project(d,b),this.getZoomScale(b,1))},this);this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){W(this._proxy);delete this._proxy},_catchTransitionEnd:function(d){this._animatingZoom&&0<=d.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(d,b,c){if(this._animatingZoom)return!0;if(c=c||{},!this._zoomAnimated||!1===c.animate||this._nothingToAnimate()||Math.abs(b-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(b),n=this._getCenterOffset(d)._divideBy(1-1/n);return!(!0!==c.animate&&!this.getSize().contains(n))&&(P(function(){this._moveStart(!0,!1)._animateZoom(d,b,!0)},this),!0)},_animateZoom:function(d,b,c,a){this._mapPane&&(c&&(this._animatingZoom=!0,this._animateToCenter=d,this._animateToZoom=b,G(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:d,zoom:b,noUpdate:a}),setTimeout(g(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&X(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),P(function(){this._moveEnd(!0)},this))}}),Ra=ba.extend({options:{position:"topright"},initialize:function(d){v(this,d)},getPosition:function(){return this.options.position},setPosition:function(d){var b=this._map;return b&&b.removeControl(this),this.options.position=d,b&&b.addControl(this),this},getContainer:function(){return this._container},addTo:function(d){this.remove();this._map=d;var b=this._container=this.onAdd(d),c=this.getPosition();d=d._controlCorners[c];return G(b,"leaflet-control"),-1!==c.indexOf("bottom")?d.insertBefore(b,d.firstChild):d.appendChild(b),this},remove:function(){return this._map?(W(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this):this},_refocusOnMap:function(d){this._map&&d&&0<d.screenX&&0<d.screenY&&this._map.getContainer().focus()}}),oc=function(d){return new Ra(d)};Q.include({addControl:function(d){return d.addTo(this),this},removeControl:function(d){return d.remove(),this},_initControlPos:function(){function d(d,n){b[d+n]=M("div",c+d+" "+c+n,a)}var b=this._controlCorners={},c="leaflet-",a=this._controlContainer=M("div",c+"control-container",this._container);d("top","left");d("top","right");d("bottom","left");d("bottom","right")},_clearControlPos:function(){for(var d in this._controlCorners)W(this._controlCorners[d]);W(this._controlContainer);delete this._controlCorners;delete this._controlContainer}});var gd=Ra.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(d,b,c,a){return c<a?-1:a<c?1:0}},initialize:function(d,b,c){v(this,c);this._layerControlInputs=[];this._layers=[];this._lastZIndex=0;this._handlingClick=!1;for(var n in d)this._addLayer(d[n],n);for(n in b)this._addLayer(b[n],n,!0)},onAdd:function(d){this._initLayout();this._update();this._map=d;d.on("zoomend",this._checkDisabledLayers,this);for(d=0;d<this._layers.length;d++)this._layers[d].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(d){return Ra.prototype.addTo.call(this,d),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var d=0;d<this._layers.length;d++)this._layers[d].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(d,b){return this._addLayer(d,b),this._map?this._update():this},addOverlay:function(d,b){return this._addLayer(d,b,!0),this._map?this._update():this},removeLayer:function(d){d.off("add remove",this._onLayerChange,this);d=this._getLayer(f(d));return d&&this._layers.splice(this._layers.indexOf(d),1),this._map?this._update():this},expand:function(){G(this._container,"leaflet-control-layers-expanded");this._form.style.height=null;var d=this._map.getSize().y-(this._container.offsetTop+50);return d<this._form.clientHeight?(G(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=d+"px"):X(this._form,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return X(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var d=this._container=M("div","leaflet-control-layers"),b=this.options.collapsed;d.setAttribute("aria-haspopup",!0);lb(d);xb(d);var a=this._form=M("form","leaflet-control-layers-list");b&&(this._map.on("click",this.collapse,this),kb||c(d,{mouseenter:this.expand,mouseleave:this.collapse},this));var l=this._layersLink=M("a","leaflet-control-layers-toggle",d);l.href="#";l.title="Layers";Wa?(c(l,"click",Ba),c(l,"click",this.expand,this)):c(l,"focus",this.expand,this);b||this.expand();this._baseLayersList=M("div","leaflet-control-layers-base",a);this._separator=M("div","leaflet-control-layers-separator",a);this._overlaysList=M("div","leaflet-control-layers-overlays",a);d.appendChild(a)},_getLayer:function(d){for(var b=0;b<this._layers.length;b++)if(this._layers[b]&&f(this._layers[b].layer)===d)return this._layers[b]},_addLayer:function(d,b,c){this._map&&d.on("add remove",this._onLayerChange,this);this._layers.push({layer:d,name:b,overlay:c});this.options.sortLayers&&this._layers.sort(g(function(d,b){return this.options.sortFunction(d.layer,b.layer,d.name,b.name)},this));this.options.autoZIndex&&d.setZIndex&&(this._lastZIndex++,d.setZIndex(this._lastZIndex));this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Ea(this._baseLayersList);Ea(this._overlaysList);this._layerControlInputs=[];var d,b,c,a,l=0;for(c=0;c<this._layers.length;c++)a=this._layers[c],this._addItem(a),b=b||a.overlay,d=d||!a.overlay,l+=a.overlay?0:1;return this.options.hideSingleBase&&(d=d&&1<l,this._baseLayersList.style.display=d?"":"none"),this._separator.style.display=b&&d?"":"none",this},_onLayerChange:function(d){this._handlingClick||this._update();var b=this._getLayer(f(d.target));(d=b.overlay?"add"===d.type?"overlayadd":"overlayremove":"add"===d.type?"baselayerchange":null)&&this._map.fire(d,b)},_createRadioElement:function(d,b){var c='\x3cinput type\x3d"radio" class\x3d"leaflet-control-layers-selector" name\x3d"'+d+'"'+(b?' checked\x3d"checked"':"")+"/\x3e",n=document.createElement("div");return n.innerHTML=c,n.firstChild},_addItem:function(d){var b,a=document.createElement("label"),l=this._map.hasLayer(d.layer);d.overlay?((b=document.createElement("input")).type="checkbox",b.className="leaflet-control-layers-selector",b.defaultChecked=l):b=this._createRadioElement("leaflet-base-layers",l);this._layerControlInputs.push(b);b.layerId=f(d.layer);c(b,"click",this._onInputClick,this);l=document.createElement("span");l.innerHTML=" "+d.name;var r=document.createElement("div");return a.appendChild(r),r.appendChild(b),r.appendChild(l),(d.overlay?this._overlaysList:this._baseLayersList).appendChild(a),this._checkDisabledLayers(),a},_onInputClick:function(){var d,b,c=this._layerControlInputs,a=[],l=[];this._handlingClick=!0;for(var r=c.length-1;0<=r;r--)d=c[r],b=this._getLayer(d.layerId).layer,d.checked?a.push(b):d.checked||l.push(b);for(r=0;r<l.length;r++)this._map.hasLayer(l[r])&&this._map.removeLayer(l[r]);for(r=0;r<a.length;r++)this._map.hasLayer(a[r])||this._map.addLayer(a[r]);this._handlingClick=!1;this._refocusOnMap()},_checkDisabledLayers:function(){for(var d,b,c=this._layerControlInputs,a=this._map.getZoom(),l=c.length-1;0<=l;l--)d=c[l],b=this._getLayer(d.layerId).layer,d.disabled=void 0!==b.options.minZoom&&a<b.options.minZoom||void 0!==b.options.maxZoom&&a>b.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),Sc=Ra.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"\x26#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(d){var b=M("div","leaflet-control-zoom leaflet-bar"),c=this.options;return this._zoomInButton=this._createButton(c.zoomInText,c.zoomInTitle,"leaflet-control-zoom-in",b,this._zoomIn),this._zoomOutButton=this._createButton(c.zoomOutText,c.zoomOutTitle,"leaflet-control-zoom-out",b,this._zoomOut),this._updateDisabled(),d.on("zoomend zoomlevelschange",this._updateDisabled,this),b},onRemove:function(d){d.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(d){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(d.shiftKey?3:1))},_zoomOut:function(d){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(d.shiftKey?3:1))},_createButton:function(d,b,a,l,r){a=M("a",a,l);return a.innerHTML=d,a.href="#",a.title=b,a.setAttribute("role","button"),a.setAttribute("aria-label",b),lb(a),c(a,"click",Ba),c(a,"click",r,this),c(a,"click",this._refocusOnMap,this),a},_updateDisabled:function(){var d=this._map;X(this._zoomInButton,"leaflet-disabled");X(this._zoomOutButton,"leaflet-disabled");(this._disabled||d._zoom===d.getMinZoom())&&G(this._zoomOutButton,"leaflet-disabled");(this._disabled||d._zoom===d.getMaxZoom())&&G(this._zoomInButton,"leaflet-disabled")}});Q.mergeOptions({zoomControl:!0});Q.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Sc,this.addControl(this.zoomControl))});var hd=Ra.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(d){var b=M("div","leaflet-control-scale"),c=this.options;return this._addScales(c,"leaflet-control-scale-line",b),d.on(c.updateWhenIdle?"moveend":"move",this._update,this),d.whenReady(this._update,this),b},onRemove:function(d){d.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(d,b,c){d.metric&&(this._mScale=M("div",b,c));d.imperial&&(this._iScale=M("div",b,c))},_update:function(){var d=this._map,b=d.getSize().y/2,d=d.distance(d.containerPointToLatLng([0,b]),d.containerPointToLatLng([this.options.maxWidth,b]));this._updateScales(d)},_updateScales:function(d){this.options.metric&&d&&this._updateMetric(d);this.options.imperial&&d&&this._updateImperial(d)},_updateMetric:function(d){var b=this._getRoundNum(d);this._updateScale(this._mScale,1E3>b?b+" m":b/1E3+" km",b/d)},_updateImperial:function(d){var b,c,a;d*=3.2808399;5280<d?(b=d/5280,c=this._getRoundNum(b),this._updateScale(this._iScale,c+" mi",c/b)):(a=this._getRoundNum(d),this._updateScale(this._iScale,a+" ft",a/d))},_updateScale:function(d,b,c){d.style.width=Math.round(this.options.maxWidth*c)+"px";d.innerHTML=b},_getRoundNum:function(d){var b=Math.pow(10,(Math.floor(d)+"").length-1);d/=b;return d=10<=d?10:5<=d?5:3<=d?3:2<=d?2:1,b*d}}),Tc=Ra.extend({options:{position:"bottomright",prefix:'\x3ca href\x3d"http://leafletjs.com" title\x3d"A JS library for interactive maps"\x3eLeaflet\x3c/a\x3e'},initialize:function(d){v(this,d);this._attributions={}},onAdd:function(d){d.attributionControl=this;this._container=M("div","leaflet-control-attribution");lb(this._container);for(var b in d._layers)d._layers[b].getAttribution&&this.addAttribution(d._layers[b].getAttribution());return this._update(),this._container},setPrefix:function(d){return this.options.prefix=d,this._update(),this},addAttribution:function(d){return d?(this._attributions[d]||(this._attributions[d]=0),this._attributions[d]++,this._update(),this):this},removeAttribution:function(d){return d?(this._attributions[d]&&(this._attributions[d]--,this._update()),this):this},_update:function(){if(this._map){var d=[],b;for(b in this._attributions)this._attributions[b]&&d.push(b);b=[];this.options.prefix&&b.push(this.options.prefix);d.length&&b.push(d.join(", "));this._container.innerHTML=b.join(" | ")}}});Q.mergeOptions({attributionControl:!0});Q.addInitHook(function(){this.options.attributionControl&&(new Tc).addTo(this)});Ra.Layers=gd;Ra.Zoom=Sc;Ra.Scale=hd;Ra.Attribution=Tc;oc.layers=function(d,b,c){return new gd(d,b,c)};oc.zoom=function(d){return new Sc(d)};oc.scale=function(d){return new hd(d)};oc.attribution=function(d){return new Tc(d)};var Za=ba.extend({initialize:function(d){this._map=d},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Za.addTo=function(d,b){return d.addHandler(b,this),this};var ad,Ed={Events:ja},id=Wa?"touchstart mousedown":"mousedown",jd={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},Uc={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},Hb=Bb.extend({options:{clickTolerance:3},initialize:function(d,b,c,a){v(this,a);this._element=d;this._dragStartTarget=b||d;this._preventOutline=c},enable:function(){this._enabled||(c(this._dragStartTarget,id,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Hb._dragging===this&&this.finishDrag(),D(this._dragStartTarget,id,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(d){if(!d._simulated&&this._enabled&&(this._moved=!1,!(Sa(this._element,"leaflet-zoom-anim")||Hb._dragging||d.shiftKey||1!==d.which&&1!==d.button&&!d.touches||(Hb._dragging=this,this._preventOutline&&ha(this._element),oa(),Cb(),this._moving)))){this.fire("down");var b=d.touches?d.touches[0]:d,a=db(this._element);this._startPoint=new B(b.clientX,b.clientY);this._parentScale=Ma(a);c(document,Uc[d.type],this._onMove,this);c(document,jd[d.type],this._onUp,this)}},_onMove:function(d){if(!d._simulated&&this._enabled)if(d.touches&&1<d.touches.length)this._moved=!0;else{var b=d.touches&&1===d.touches.length?d.touches[0]:d,b=(new B(b.clientX,b.clientY))._subtract(this._startPoint);(b.x||b.y)&&(Math.abs(b.x)+Math.abs(b.y)<this.options.clickTolerance||(b.x/=this._parentScale.x,b.y/=this._parentScale.y,sa(d),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=ua(this._element).subtract(b),G(document.body,"leaflet-dragging"),this._lastTarget=d.target||d.srcElement,window.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),G(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(b),this._moving=!0,V(this._animRequest),this._lastEvent=d,this._animRequest=P(this._updatePosition,this,!0)))}},_updatePosition:function(){var d={originalEvent:this._lastEvent};this.fire("predrag",d);Y(this._element,this._newPos);this.fire("drag",d)},_onUp:function(d){!d._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){X(document.body,"leaflet-dragging");this._lastTarget&&(X(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var d in Uc)D(document,Uc[d],this._onMove,this),D(document,jd[d],this._onUp,this);C();Db();this._moved&&this._moving&&(V(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)}));this._moving=!1;Hb._dragging=!1}}),Fd=(Object.freeze||Object)({simplify:mb,pointToSegmentDistance:nb,closestPointOnSegment:function(d,b,c){return yb(d,b,c)},clipSegment:ec,_getEdgeIntersection:eb,_getBitCode:Ya,_sqClosestPointOnSegment:yb,isFlat:Ga,_flat:Nb}),Gd=(Object.freeze||Object)({clipPolygon:Ob}),Vc={project:function(d){return new B(d.lng,d.lat)},unproject:function(d){return new N(d.y,d.x)},bounds:new J([-180,-90],[180,90])},Wc={R:6378137,R_MINOR:6356752.314245179,bounds:new J([-2.003750834279E7,-1.549657073972E7],[2.003750834279E7,1.876465623138E7]),project:function(d){var b=Math.PI/180,c=this.R,a=d.lat*b,l=this.R_MINOR/c,l=Math.sqrt(1-l*l),r=l*Math.sin(a);return a=-c*Math.log(Math.max(Math.tan(Math.PI/4-a/2)/Math.pow((1-r)/(1+r),l/2),1E-10)),new B(d.lng*b*c,a)},unproject:function(d){var b,c=180/Math.PI,a=this.R,l=this.R_MINOR/a,l=Math.sqrt(1-l*l),r=Math.exp(-d.y/a),f=Math.PI/2-2*Math.atan(r),e=0;for(b=.1;15>e&&1E-7<Math.abs(b);e++)b=l*Math.sin(f),b=Math.pow((1-b)/(1+b),l/2),f+=b=Math.PI/2-2*Math.atan(r*b)-f;return new N(f*c,d.x*c/a)}},Hd=(Object.freeze||Object)({LonLat:Vc,Mercator:Wc,SphericalMercator:hc}),Id=e({},ma,{code:"EPSG:3395",projection:Wc,transformation:function(){var d=.5/(Math.PI*Wc.R);return qa(d,.5,-d,.5)}()}),kd=e({},ma,{code:"EPSG:4326",projection:Vc,transformation:qa(1/180,1,-1/180,.5)}),Jd=e({},Qa,{projection:Vc,transformation:qa(1,0,-1,0),scale:function(d){return Math.pow(2,d)},zoom:function(d){return Math.log(d)/Math.LN2},distance:function(d,b){var c=b.lng-d.lng,n=b.lat-d.lat;return Math.sqrt(c*c+n*n)},infinite:!0});Qa.Earth=ma;Qa.EPSG3395=Id;Qa.EPSG3857=jc;Qa.EPSG900913=Rc;Qa.EPSG4326=kd;Qa.Simple=Jd;var Ia=Bb.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(d){return d.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(d){return d&&d.removeLayer(this),this},getPane:function(d){return this._map.getPane(d?this.options[d]||d:this.options.pane)},addInteractiveTarget:function(d){return this._map._targets[f(d)]=this,this},removeInteractiveTarget:function(d){return delete this._map._targets[f(d)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(d){var b=d.target;if(b.hasLayer(this)){if(this._map=b,this._zoomAnimated=b._zoomAnimated,this.getEvents){var c=this.getEvents();b.on(c,this);this.once("remove",function(){b.off(c,this)},this)}this.onAdd(b);this.getAttribution&&b.attributionControl&&b.attributionControl.addAttribution(this.getAttribution());this.fire("add");b.fire("layeradd",{layer:this})}}});Q.include({addLayer:function(d){if(!d._layerAdd)throw Error("The provided object is not a Layer.");var b=f(d);return this._layers[b]?this:(this._layers[b]=d,d._mapToAdd=this,d.beforeAdd&&d.beforeAdd(this),this.whenReady(d._layerAdd,d),this)},removeLayer:function(d){var b=f(d);return this._layers[b]?(this._loaded&&d.onRemove(this),d.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(d.getAttribution()),delete this._layers[b],this._loaded&&(this.fire("layerremove",{layer:d}),d.fire("remove")),d._map=d._mapToAdd=null,this):this},hasLayer:function(d){return!!d&&f(d)in this._layers},eachLayer:function(d,b){for(var c in this._layers)d.call(b,this._layers[c]);return this},_addLayers:function(d){for(var b=0,c=(d=d?na(d)?d:[d]:[]).length;b<c;b++)this.addLayer(d[b])},_addZoomLimit:function(d){!isNaN(d.options.maxZoom)&&isNaN(d.options.minZoom)||(this._zoomBoundLayers[f(d)]=d,this._updateZoomLevels())},_removeZoomLimit:function(d){d=f(d);this._zoomBoundLayers[d]&&(delete this._zoomBoundLayers[d],this._updateZoomLevels())},_updateZoomLevels:function(){var d=1/0,b=-1/0,c=this._getZoomSpan(),a;for(a in this._zoomBoundLayers)var l=this._zoomBoundLayers[a].options,d=void 0===l.minZoom?d:Math.min(d,l.minZoom),b=void 0===l.maxZoom?b:Math.max(b,l.maxZoom);this._layersMaxZoom=b===-1/0?void 0:b;this._layersMinZoom=d===1/0?void 0:d;c!==this._getZoomSpan()&&this.fire("zoomlevelschange");void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom);void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Yb=Ia.extend({initialize:function(d,b){v(this,b);this._layers={};var c,n;if(d)for(c=0,n=d.length;c<n;c++)this.addLayer(d[c])},addLayer:function(d){var b=this.getLayerId(d);return this._layers[b]=d,this._map&&this._map.addLayer(d),this},removeLayer:function(d){d=d in this._layers?d:this.getLayerId(d);return this._map&&this._layers[d]&&this._map.removeLayer(this._layers[d]),delete this._layers[d],this},hasLayer:function(d){return!!d&&(d in this._layers||this.getLayerId(d)in this._layers)},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(d){var b,c,a=Array.prototype.slice.call(arguments,1);for(b in this._layers)(c=this._layers[b])[d]&&c[d].apply(c,a);return this},onAdd:function(d){this.eachLayer(d.addLayer,d)},onRemove:function(d){this.eachLayer(d.removeLayer,d)},eachLayer:function(d,b){for(var c in this._layers)d.call(b,this._layers[c]);return this},getLayer:function(d){return this._layers[d]},getLayers:function(){var d=[];return this.eachLayer(d.push,d),d},setZIndex:function(d){return this.invoke("setZIndex",d)},getLayerId:function(d){return f(d)}}),zb=Yb.extend({addLayer:function(d){return this.hasLayer(d)?this:(d.addEventParent(this),Yb.prototype.addLayer.call(this,d),this.fire("layeradd",{layer:d}))},removeLayer:function(d){return this.hasLayer(d)?(d in this._layers&&(d=this._layers[d]),d.removeEventParent(this),Yb.prototype.removeLayer.call(this,d),this.fire("layerremove",{layer:d})):this},setStyle:function(d){return this.invoke("setStyle",d)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var d=new ca,b;for(b in this._layers){var c=this._layers[b];d.extend(c.getBounds?c.getBounds():c.getLatLng())}return d}}),Zb=ba.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(d){v(this,d)},createIcon:function(d){return this._createIcon("icon",d)},createShadow:function(d){return this._createIcon("shadow",d)},_createIcon:function(d,b){var c=this._getIconUrl(d);if(!c){if("icon"===d)throw Error("iconUrl not set in Icon options (see the docs).");return null}c=this._createImg(c,b&&"IMG"===b.tagName?b:null);return this._setIconStyles(c,d),c},_setIconStyles:function(d,b){var c=this.options,a=c[b+"Size"];"number"==typeof a&&(a=[a,a]);var a=I(a),n=I("shadow"===b&&c.shadowAnchor||c.iconAnchor||a&&a.divideBy(2,!0));d.className="leaflet-marker-"+b+" "+(c.className||"");n&&(d.style.marginLeft=-n.x+"px",d.style.marginTop=-n.y+"px");a&&(d.style.width=a.x+"px",d.style.height=a.y+"px")},_createImg:function(d,b){return b=b||document.createElement("img"),b.src=d,b},_getIconUrl:function(d){return tb&&this.options[d+"RetinaUrl"]||this.options[d+"Url"]}}),pc=Zb.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(d){return pc.imagePath||(pc.imagePath=this._detectIconPath()),(this.options.imagePath||pc.imagePath)+Zb.prototype._getIconUrl.call(this,d)},_detectIconPath:function(){var d=M("div","leaflet-default-icon-path",document.body),b=R(d,"background-image")||R(d,"backgroundImage");return document.body.removeChild(d),null===b||0!==b.indexOf("url")?"":b.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,"")}}),ld=Za.extend({initialize:function(d){this._marker=d},addHooks:function(){var d=this._marker._icon;this._draggable||(this._draggable=new Hb(d,d,!0));this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable();G(d,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable();this._marker._icon&&X(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(d){var b=this._marker,c=b._map,a=this._marker.options.autoPanSpeed,l=this._marker.options.autoPanPadding,r=ua(b._icon),f=c.getPixelBounds(),e=c.getPixelOrigin(),l=ka(f.min._subtract(e).add(l),f.max._subtract(e).subtract(l));l.contains(r)||(a=I((Math.max(l.max.x,r.x)-l.max.x)/(f.max.x-l.max.x)-(Math.min(l.min.x,r.x)-l.min.x)/(f.min.x-l.min.x),(Math.max(l.max.y,r.y)-l.max.y)/(f.max.y-l.max.y)-(Math.min(l.min.y,r.y)-l.min.y)/(f.min.y-l.min.y)).multiplyBy(a),c.panBy(a,{animate:!1}),this._draggable._newPos._add(a),this._draggable._startPos._add(a),Y(b._icon,this._draggable._newPos),this._onDrag(d),this._panRequest=P(this._adjustPan.bind(this,d)))},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng();this._marker.closePopup().fire("movestart").fire("dragstart")},_onPreDrag:function(d){this._marker.options.autoPan&&(V(this._panRequest),this._panRequest=P(this._adjustPan.bind(this,d)))},_onDrag:function(d){var b=this._marker,c=b._shadow,a=ua(b._icon),l=b._map.layerPointToLatLng(a);c&&Y(c,a);b._latlng=l;d.latlng=l;d.oldLatLng=this._oldLatLng;b.fire("move",d).fire("drag",d)},_onDragEnd:function(d){V(this._panRequest);delete this._oldLatLng;this._marker.fire("moveend").fire("dragend",d)}}),fc=Ia.extend({options:{icon:new pc,interactive:!0,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",bubblingMouseEvents:!1,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(d,b){v(this,b);this._latlng=O(d)},onAdd:function(d){(this._zoomAnimated=this._zoomAnimated&&d.options.markerZoomAnimation)&&d.on("zoomanim",this._animateZoom,this);this._initIcon();this.update()},onRemove:function(d){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks());delete this.dragging;this._zoomAnimated&&d.off("zoomanim",this._animateZoom,this);this._removeIcon();this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(d){var b=this._latlng;return this._latlng=O(d),this.update(),this.fire("move",{oldLatLng:b,latlng:this._latlng})},setZIndexOffset:function(d){return this.options.zIndexOffset=d,this.update()},setIcon:function(d){return this.options.icon=d,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var d=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(d)}return this},_initIcon:function(){var d=this.options,b="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),c=d.icon.createIcon(this._icon),a=!1;c!==this._icon&&(this._icon&&this._removeIcon(),a=!0,d.title&&(c.title=d.title),"IMG"===c.tagName&&(c.alt=d.alt||""));G(c,b);d.keyboard&&(c.tabIndex="0");this._icon=c;d.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var c=d.icon.createShadow(this._shadow),l=!1;c!==this._shadow&&(this._removeShadow(),l=!0);c&&(G(c,b),c.alt="");this._shadow=c;1>d.opacity&&this._updateOpacity();a&&this.getPane().appendChild(this._icon);this._initInteraction();c&&l&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex});W(this._icon);this.removeInteractiveTarget(this._icon);this._icon=null},_removeShadow:function(){this._shadow&&W(this._shadow);this._shadow=null},_setPos:function(d){Y(this._icon,d);this._shadow&&Y(this._shadow,d);this._zIndex=d.y+this.options.zIndexOffset;this._resetZIndex()},_updateZIndex:function(d){this._icon.style.zIndex=this._zIndex+d},_animateZoom:function(d){null!=this._map&&(d=this._map._latLngToNewLayerPoint(this._latlng,d.zoom,d.center).round(),this._setPos(d))},_initInteraction:function(){if(this.options.interactive&&(G(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),ld)){var d=this.options.draggable;this.dragging&&(d=this.dragging.enabled(),this.dragging.disable());this.dragging=new ld(this);d&&this.dragging.enable()}},setOpacity:function(d){return this.options.opacity=d,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var d=this.options.opacity;ga(this._icon,d);this._shadow&&ga(this._shadow,d)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}}),ub=Ia.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(d){this._renderer=d.getRenderer(this)},onAdd:function(){this._renderer._initPath(this);this._reset();this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(d){return v(this,d),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project();this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),Gc=ub.extend({options:{fill:!0,radius:10},initialize:function(d,b){v(this,b);this._latlng=O(d);this._radius=this.options.radius},setLatLng:function(d){return this._latlng=O(d),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(d){return this.options.radius=this._radius=d,this.redraw()},getRadius:function(){return this._radius},setStyle:function(d){var b=d&&d.radius||this._radius;return ub.prototype.setStyle.call(this,d),this.setRadius(b),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng);this._updateBounds()},_updateBounds:function(){var d=this._radius,b=this._radiusY||d,c=this._clickTolerance(),d=[d+c,b+c];this._pxBounds=new J(this._point.subtract(d),this._point.add(d))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(d){return d.distanceTo(this._point)<=this._radius+this._clickTolerance()}}),Xc=Gc.extend({initialize:function(d,b,c){if("number"==typeof b&&(b=e({},c,{radius:b})),v(this,b),this._latlng=O(d),isNaN(this.options.radius))throw Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(d){return this._mRadius=d,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var d=[this._radius,this._radiusY||this._radius];return new ca(this._map.layerPointToLatLng(this._point.subtract(d)),this._map.layerPointToLatLng(this._point.add(d)))},setStyle:ub.prototype.setStyle,_project:function(){var d=this._latlng.lng,b=this._latlng.lat,c=this._map,a=c.options.crs;if(a.distance===ma.distance){var l=Math.PI/180,a=this._mRadius/ma.R/l,r=c.project([b+a,d]),f=c.project([b-a,d]),f=r.add(f).divideBy(2),e=c.unproject(f).lat,l=Math.acos((Math.cos(a*l)-Math.sin(b*l)*Math.sin(e*l))/(Math.cos(b*l)*Math.cos(e*l)))/l;(isNaN(l)||0===l)&&(l=a/Math.cos(Math.PI/180*b));this._point=f.subtract(c.getPixelOrigin());this._radius=isNaN(l)?0:f.x-c.project([e,d-l]).x;this._radiusY=f.y-r.y}else d=a.unproject(a.project(this._latlng).subtract([this._mRadius,0])),this._point=c.latLngToLayerPoint(this._latlng),this._radius=this._point.x-c.latLngToLayerPoint(d).x;this._updateBounds()}}),fb=ub.extend({options:{smoothFactor:1,noClip:!1},initialize:function(d,b){v(this,b);this._setLatLngs(d)},getLatLngs:function(){return this._latlngs},setLatLngs:function(d){return this._setLatLngs(d),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(d){for(var b,c,a=1/0,l=null,r=yb,f=0,e=this._parts.length;f<e;f++)for(var h=this._parts[f],k=1,Ha=h.length;k<Ha;k++){var m=r(d,b=h[k-1],c=h[k],!0);m<a&&(a=m,l=r(d,b,c))}return l&&(l.distance=Math.sqrt(a)),l},getCenter:function(){if(!this._map)throw Error("Must add layer to map before using getCenter()");var d,b,c,a,l,r,f,e=this._rings[0],h=e.length;if(!h)return null;for(b=d=0;d<h-1;d++)b+=e[d].distanceTo(e[d+1])/2;if(0===b)return this._map.layerPointToLatLng(e[0]);for(a=d=0;d<h-1;d++)if(l=e[d],r=e[d+1],c=l.distanceTo(r),(a+=c)>b)return f=(a-b)/c,this._map.layerPointToLatLng([r.x-f*(r.x-l.x),r.y-f*(r.y-l.y)])},getBounds:function(){return this._bounds},addLatLng:function(d,b){return b=b||this._defaultShape(),d=O(d),b.push(d),this._bounds.extend(d),this.redraw()},_setLatLngs:function(d){this._bounds=new ca;this._latlngs=this._convertLatLngs(d)},_defaultShape:function(){return Ga(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(d){for(var b=[],c=Ga(d),a=0,l=d.length;a<l;a++)c?(b[a]=O(d[a]),this._bounds.extend(b[a])):b[a]=this._convertLatLngs(d[a]);return b},_project:function(){var d=new J;this._rings=[];this._projectLatlngs(this._latlngs,this._rings,d);var b=this._clickTolerance(),b=new B(b,b);this._bounds.isValid()&&d.isValid()&&(d.min._subtract(b),d.max._add(b),this._pxBounds=d)},_projectLatlngs:function(d,b,c){var a,n,l=d.length;if(d[0]instanceof N){n=[];for(a=0;a<l;a++)n[a]=this._map.latLngToLayerPoint(d[a]),c.extend(n[a]);b.push(n)}else for(a=0;a<l;a++)this._projectLatlngs(d[a],b,c)},_clipPoints:function(){var d=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(d))if(this.options.noClip)this._parts=this._rings;else{var b,c,a,l,r,f,e,h=this._parts;a=b=0;for(l=this._rings.length;b<l;b++)for(c=0,r=(e=this._rings[b]).length;c<r-1;c++)(f=ec(e[c],e[c+1],d,c,!0))&&(h[a]=h[a]||[],h[a].push(f[0]),f[1]===e[c+1]&&c!==r-2||(h[a].push(f[1]),a++))}},_simplifyPoints:function(){for(var d=this._parts,b=this.options.smoothFactor,c=0,a=d.length;c<a;c++)d[c]=mb(d[c],b)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(d,b){var c,a,n,l,r,f,e=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(d))return!1;c=0;for(l=this._parts.length;c<l;c++)for(a=0,n=(r=(f=this._parts[c]).length)-1;a<r;n=a++)if((b||0!==a)&&nb(d,f[n],f[a])<=e)return!0;return!1}});fb._flat=Nb;var Rb=fb.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw Error("Must add layer to map before using getCenter()");var d,b,c,a,l,r,f,e,h=this._rings[0],k=h.length;if(!k)return null;d=l=r=f=0;for(b=k-1;d<k;b=d++)c=h[d],b=h[b],a=c.y*b.x-b.y*c.x,r+=(c.x+b.x)*a,f+=(c.y+b.y)*a,l+=3*a;return e=0===l?h[0]:[r/l,f/l],this._map.layerPointToLatLng(e)},_convertLatLngs:function(d){d=fb.prototype._convertLatLngs.call(this,d);var b=d.length;return 2<=b&&d[0]instanceof N&&d[0].equals(d[b-1])&&d.pop(),d},_setLatLngs:function(d){fb.prototype._setLatLngs.call(this,d);Ga(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Ga(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var d=this._renderer._bounds,b=this.options.weight,b=new B(b,b);if(d=new J(d.min.subtract(b),d.max.add(b)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(d))if(this.options.noClip)this._parts=this._rings;else for(var c,b=0,a=this._rings.length;b<a;b++)(c=Ob(this._rings[b],d,!0)).length&&this._parts.push(c)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(d){var b,c,a,l,r,f,e,h=!1;if(!this._pxBounds||!this._pxBounds.contains(d))return!1;l=0;for(f=this._parts.length;l<f;l++)for(r=0,a=(e=(b=this._parts[l]).length)-1;r<e;a=r++)c=b[r],a=b[a],c.y>d.y!=a.y>d.y&&d.x<(a.x-c.x)*(d.y-c.y)/(a.y-c.y)+c.x&&(h=!h);return h||fb.prototype._containsPoint.call(this,d,!0)}}),gb=zb.extend({initialize:function(d,b){v(this,b);this._layers={};d&&this.addData(d)},addData:function(d){var b,c,a=na(d)?d:d.features;if(a){d=0;for(b=a.length;d<b;d++)((c=a[d]).geometries||c.geometry||c.features||c.coordinates)&&this.addData(c);return this}c=this.options;return c.filter&&!c.filter(d)?this:(a=Pb(d,c))?(a.feature=Tb(d),a.defaultOptions=a.options,this.resetStyle(a),c.onEachFeature&&c.onEachFeature(d,a),this.addLayer(a)):this},resetStyle:function(d){return d.options=e({},d.defaultOptions),this._setLayerStyle(d,this.options.style),this},setStyle:function(d){return this.eachLayer(function(b){this._setLayerStyle(b,d)},this)},_setLayerStyle:function(d,b){"function"==typeof b&&(b=b(d.feature));d.setStyle&&d.setStyle(b)}}),Yc={toGeoJSON:function(d){return pb(this,{type:"Point",coordinates:Ab(this.getLatLng(),d)})}};fc.include(Yc);Xc.include(Yc);Gc.include(Yc);fb.include({toGeoJSON:function(d){var b=!Ga(this._latlngs);d=Sb(this._latlngs,b?1:0,!1,d);return pb(this,{type:(b?"Multi":"")+"LineString",coordinates:d})}});Rb.include({toGeoJSON:function(d){var b=!Ga(this._latlngs),c=b&&!Ga(this._latlngs[0]);d=Sb(this._latlngs,c?2:b?1:0,!0,d);return b||(d=[d]),pb(this,{type:(c?"Multi":"")+"Polygon",coordinates:d})}});Yb.include({toMultiPoint:function(d){var b=[];return this.eachLayer(function(c){b.push(c.toGeoJSON(d).geometry.coordinates)}),pb(this,{type:"MultiPoint",coordinates:b})},toGeoJSON:function(d){var b=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===b)return this.toMultiPoint(d);var c="GeometryCollection"===b,a=[];return this.eachLayer(function(b){b.toGeoJSON&&(b=b.toGeoJSON(d),c?a.push(b.geometry):(b=Tb(b),"FeatureCollection"===b.type?a.push.apply(a,b.features):a.push(b)))}),c?pb(this,{geometries:a,type:"GeometryCollection"}):{type:"FeatureCollection",features:a}}});var Zc=Ia.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(d,b,c){this._url=d;this._bounds=U(b);v(this,c)},onAdd:function(){this._image||(this._initImage(),1>this.options.opacity&&this._updateOpacity());this.options.interactive&&(G(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image));this.getPane().appendChild(this._image);this._reset()},onRemove:function(){W(this._image);this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(d){return this.options.opacity=d,this._image&&this._updateOpacity(),this},setStyle:function(d){return d.opacity&&this.setOpacity(d.opacity),this},bringToFront:function(){return this._map&&Aa(this._image),this},bringToBack:function(){return this._map&&ta(this._image),this},setUrl:function(d){return this._url=d,this._image&&(this._image.src=d),this},setBounds:function(d){return this._bounds=U(d),this._map&&this._reset(),this},getEvents:function(){var d={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(d.zoomanim=this._animateZoom),d},setZIndex:function(d){return this.options.zIndex=d,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var d="IMG"===this._url.tagName,b=this._image=d?this._url:M("img");G(b,"leaflet-image-layer");this._zoomAnimated&&G(b,"leaflet-zoom-animated");this.options.className&&G(b,this.options.className);b.onselectstart=h;b.onmousemove=h;b.onload=g(this.fire,this,"load");b.onerror=g(this._overlayOnError,this,"error");(this.options.crossOrigin||""===this.options.crossOrigin)&&(b.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin);this.options.zIndex&&this._updateZIndex();d?this._url=b.src:(b.src=this._url,b.alt=this.options.alt)},_animateZoom:function(d){var b=this._map.getZoomScale(d.zoom);d=this._map._latLngBoundsToNewLayerBounds(this._bounds,d.zoom,d.center).min;T(this._image,d,b)},_reset:function(){var d=this._image,b=new J(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),c=b.getSize();Y(d,b.min);d.style.width=c.x+"px";d.style.height=c.y+"px"},_updateOpacity:function(){ga(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var d=this.options.errorOverlayUrl;d&&this._url!==d&&(this._url=d,this._image.src=d)}}),md=Zc.extend({options:{autoplay:!0,loop:!0},_initImage:function(){var d="VIDEO"===this._url.tagName,b=this._image=d?this._url:M("video");if(G(b,"leaflet-image-layer"),this._zoomAnimated&&G(b,"leaflet-zoom-animated"),b.onselectstart=h,b.onmousemove=h,b.onloadeddata=g(this.fire,this,"load"),d){for(var d=b.getElementsByTagName("source"),c=[],a=0;a<d.length;a++)c.push(d[a].src);this._url=0<d.length?c:[b.src]}else for(na(this._url)||(this._url=[this._url]),b.autoplay=!!this.options.autoplay,b.loop=!!this.options.loop,d=0;d<this._url.length;d++)c=M("source"),c.src=this._url[d],b.appendChild(c)}}),hb=Ia.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(d,b){v(this,d);this._source=b},onAdd:function(d){this._zoomAnimated=d._zoomAnimated;this._container||this._initLayout();d._fadeAnimated&&ga(this._container,0);clearTimeout(this._removeTimeout);this.getPane().appendChild(this._container);this.update();d._fadeAnimated&&ga(this._container,1);this.bringToFront()},onRemove:function(d){d._fadeAnimated?(ga(this._container,0),this._removeTimeout=setTimeout(g(W,void 0,this._container),200)):W(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(d){return this._latlng=O(d),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(d){return this._content=d,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var d={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(d.zoomanim=this._animateZoom),d},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Aa(this._container),this},bringToBack:function(){return this._map&&ta(this._container),this},_updateContent:function(){if(this._content){var d=this._contentNode,b="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof b)d.innerHTML=b;else{for(;d.hasChildNodes();)d.removeChild(d.firstChild);d.appendChild(b)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var d=this._map.latLngToLayerPoint(this._latlng),b=I(this.options.offset),c=this._getAnchor();this._zoomAnimated?Y(this._container,d.add(c)):b=b.add(d).add(c);d=this._containerBottom=-b.y;b=this._containerLeft=-Math.round(this._containerWidth/2)+b.x;this._container.style.bottom=d+"px";this._container.style.left=b+"px"}},_getAnchor:function(){return[0,0]}}),$b=hb.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(d){return d.openPopup(this),this},onAdd:function(d){hb.prototype.onAdd.call(this,d);d.fire("popupopen",{popup:this});this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ub||this._source.on("preclick",pa))},onRemove:function(d){hb.prototype.onRemove.call(this,d);d.fire("popupclose",{popup:this});this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ub||this._source.off("preclick",pa))},getEvents:function(){var d=hb.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(d.preclick=this._close),this.options.keepInView&&(d.moveend=this._adjustPan),d},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var d=this._container=M("div","leaflet-popup "+(this.options.className||"")+" leaflet-zoom-animated"),b=this._wrapper=M("div","leaflet-popup-content-wrapper",d);if(this._contentNode=M("div","leaflet-popup-content",b),lb(b),xb(this._contentNode),c(b,"contextmenu",pa),this._tipContainer=M("div","leaflet-popup-tip-container",d),this._tip=M("div","leaflet-popup-tip",this._tipContainer),this.options.closeButton)d=this._closeButton=M("a","leaflet-popup-close-button",d),d.href="#close",d.innerHTML="\x26#215;",c(d,"click",this._onCloseButtonClick,this)},_updateLayout:function(){var d=this._contentNode,b=d.style;b.width="";b.whiteSpace="nowrap";var c=d.offsetWidth,c=Math.min(c,this.options.maxWidth),c=Math.max(c,this.options.minWidth);b.width=c+1+"px";b.whiteSpace="";b.height="";var c=d.offsetHeight,a=this.options.maxHeight;a&&c>a?(b.height=a+"px",G(d,"leaflet-popup-scrolled")):X(d,"leaflet-popup-scrolled");this._containerWidth=this._container.offsetWidth},_animateZoom:function(d){d=this._map._latLngToNewLayerPoint(this._latlng,d.zoom,d.center);var b=this._getAnchor();Y(this._container,d.add(b))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var d=this._map,b=parseInt(R(this._container,"marginBottom"),10)||0,b=this._container.offsetHeight+b,c=this._containerWidth,a=new B(this._containerLeft,-b-this._containerBottom);a._add(ua(this._container));var a=d.layerPointToContainerPoint(a),l=I(this.options.autoPanPadding),r=I(this.options.autoPanPaddingTopLeft||l),l=I(this.options.autoPanPaddingBottomRight||l),f=d.getSize(),e=0,h=0;a.x+c+l.x>f.x&&(e=a.x+c-f.x+l.x);0>a.x-e-r.x&&(e=a.x-r.x);a.y+b+l.y>f.y&&(h=a.y+b-f.y+l.y);0>a.y-h-r.y&&(h=a.y-r.y);(e||h)&&d.fire("autopanstart").panBy([e,h])}},_onCloseButtonClick:function(d){this._close();Ba(d)},_getAnchor:function(){return I(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});Q.mergeOptions({closePopupOnClick:!0});Q.include({openPopup:function(d,b,c){return d instanceof $b||(d=(new $b(c)).setContent(d)),b&&d.setLatLng(b),this.hasLayer(d)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=d,this.addLayer(d))},closePopup:function(d){return d&&d!==this._popup||(d=this._popup,this._popup=null),d&&this.removeLayer(d),this}});Ia.include({bindPopup:function(d,b){return d instanceof $b?(v(d,b),this._popup=d,d._source=this):(this._popup&&!b||(this._popup=new $b(b,this)),this._popup.setContent(d)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(d,b){if(d instanceof Ia||(b=d,d=this),d instanceof zb)for(var c in this._layers){d=this._layers[c];break}return b||(b=d.getCenter?d.getCenter():d.getLatLng()),this._popup&&this._map&&(this._popup._source=d,this._popup.update(),this._map.openPopup(this._popup,b)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(d){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(d)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(d){return this._popup&&this._popup.setContent(d),this},getPopup:function(){return this._popup},_openPopup:function(d){var b=d.layer||d.target;this._popup&&this._map&&(Ba(d),b instanceof ub?this.openPopup(d.layer||d.target,d.latlng):this._map.hasLayer(this._popup)&&this._popup._source===b?this.closePopup():this.openPopup(b,d.latlng))},_movePopup:function(d){this._popup.setLatLng(d.latlng)},_onKeyPress:function(d){13===d.originalEvent.keyCode&&this._openPopup(d)}});var ac=hb.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(d){hb.prototype.onAdd.call(this,d);this.setOpacity(this.options.opacity);d.fire("tooltipopen",{tooltip:this});this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(d){hb.prototype.onRemove.call(this,d);d.fire("tooltipclose",{tooltip:this});this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var d=hb.prototype.getEvents.call(this);return Wa&&!this.options.permanent&&(d.preclick=this._close),d},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){this._contentNode=this._container=M("div","leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(d){var b=this._map,c=this._container,a=b.latLngToContainerPoint(b.getCenter()),b=b.layerPointToContainerPoint(d),l=this.options.direction,r=c.offsetWidth,f=c.offsetHeight,e=I(this.options.offset),h=this._getAnchor();"top"===l?d=d.add(I(-r/2+e.x,-f+e.y+h.y,!0)):"bottom"===l?d=d.subtract(I(r/2-e.x,-e.y,!0)):"center"===l?d=d.subtract(I(r/2+e.x,f/2-h.y+e.y,!0)):"right"===l||"auto"===l&&b.x<a.x?(l="right",d=d.add(I(e.x+h.x,h.y-f/2+e.y,!0))):(l="left",d=d.subtract(I(r+h.x-e.x,f/2-h.y-e.y,!0)));X(c,"leaflet-tooltip-right");X(c,"leaflet-tooltip-left");X(c,"leaflet-tooltip-top");X(c,"leaflet-tooltip-bottom");G(c,"leaflet-tooltip-"+l);Y(c,d)},_updatePosition:function(){var d=this._map.latLngToLayerPoint(this._latlng);this._setPosition(d)},setOpacity:function(d){this.options.opacity=d;this._container&&ga(this._container,d)},_animateZoom:function(d){d=this._map._latLngToNewLayerPoint(this._latlng,d.zoom,d.center);this._setPosition(d)},_getAnchor:function(){return I(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});Q.include({openTooltip:function(d,b,c){return d instanceof ac||(d=(new ac(c)).setContent(d)),b&&d.setLatLng(b),this.hasLayer(d)?this:this.addLayer(d)},closeTooltip:function(d){return d&&this.removeLayer(d),this}});Ia.include({bindTooltip:function(d,b){return d instanceof ac?(v(d,b),this._tooltip=d,d._source=this):(this._tooltip&&!b||(this._tooltip=new ac(b,this)),this._tooltip.setContent(d)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(d){if(d||!this._tooltipHandlersAdded){var b={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?b.add=this._openTooltip:(b.mouseover=this._openTooltip,b.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(b.mousemove=this._moveTooltip),Wa&&(b.click=this._openTooltip));this[d?"off":"on"](b);this._tooltipHandlersAdded=!d}},openTooltip:function(d,b){if(d instanceof Ia||(b=d,d=this),d instanceof zb)for(var c in this._layers){d=this._layers[c];break}return b||(b=d.getCenter?d.getCenter():d.getLatLng()),this._tooltip&&this._map&&(this._tooltip._source=d,this._tooltip.update(),this._map.openTooltip(this._tooltip,b),this._tooltip.options.interactive&&this._tooltip._container&&(G(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(X(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(d){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(d)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(d){return this._tooltip&&this._tooltip.setContent(d),this},getTooltip:function(){return this._tooltip},_openTooltip:function(d){var b=d.layer||d.target;this._tooltip&&this._map&&this.openTooltip(b,this._tooltip.options.sticky?d.latlng:void 0)},_moveTooltip:function(d){var b,c,a=d.latlng;this._tooltip.options.sticky&&d.originalEvent&&(b=this._map.mouseEventToContainerPoint(d.originalEvent),c=this._map.containerPointToLayerPoint(b),a=this._map.layerPointToLatLng(c));this._tooltip.setLatLng(a)}});var nd=Zb.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(d){d=d&&"DIV"===d.tagName?d:document.createElement("div");var b=this.options;if(d.innerHTML=!1!==b.html?b.html:"",b.bgPos)b=I(b.bgPos),d.style.backgroundPosition=-b.x+"px "+-b.y+"px";return this._setIconStyles(d,"icon"),d},createShadow:function(){return null}});Zb.Default=pc;var qc=Ia.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Xb,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(d){v(this,d)},onAdd:function(){this._initContainer();this._levels={};this._tiles={};this._resetView();this._update()},beforeAdd:function(d){d._addZoomLimit(this)},onRemove:function(d){this._removeAllTiles();W(this._container);d._removeZoomLimit(this);this._container=null;this._tileZoom=void 0},bringToFront:function(){return this._map&&(Aa(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(ta(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(d){return this.options.opacity=d,this._updateOpacity(),this},setZIndex:function(d){return this.options.zIndex=d,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var d={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=m(this._onMoveEnd,this.options.updateInterval,this)),d.move=this._onMove),this._zoomAnimated&&(d.zoomanim=this._animateZoom),d},createTile:function(){return document.createElement("div")},getTileSize:function(){var d=this.options.tileSize;return d instanceof B?d:new B(d,d)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(d){for(var b,c=this.getPane().children,a=-d(-1/0,1/0),l=0,r=c.length;l<r;l++)b=c[l].style.zIndex,c[l]!==this._container&&b&&(a=d(a,+b));isFinite(a)&&(this.options.zIndex=a+d(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!rb){ga(this._container,this.options.opacity);var d=+new Date,b=!1,c=!1,a;for(a in this._tiles){var l=this._tiles[a];if(l.current&&l.loaded){var r=Math.min(1,(d-l.loaded)/200);ga(l.el,r);1>r?b=!0:(l.active?c=!0:this._onOpaqueTile(l),l.active=!0)}}c&&!this._noPrune&&this._pruneTiles();b&&(V(this._fadeFrame),this._fadeFrame=P(this._updateOpacity,this))}},_onOpaqueTile:h,_initContainer:function(){this._container||(this._container=M("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),1>this.options.opacity&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var d=this._tileZoom,b=this.options.maxZoom;if(void 0!==d){for(var c in this._levels)this._levels[c].el.children.length||c===d?(this._levels[c].el.style.zIndex=b-Math.abs(d-c),this._onUpdateLevel(c)):(W(this._levels[c].el),this._removeTilesAtZoom(c),this._onRemoveLevel(c),delete this._levels[c]);c=this._levels[d];var a=this._map;return c||((c=this._levels[d]={}).el=M("div","leaflet-tile-container leaflet-zoom-animated",this._container),c.el.style.zIndex=b,c.origin=a.project(a.unproject(a.getPixelOrigin()),d).round(),c.zoom=d,this._setZoomTransform(c,a.getCenter(),a.getZoom()),c.el.offsetWidth,this._onCreateLevel(c)),this._level=c,c}},_onUpdateLevel:h,_onRemoveLevel:h,_onCreateLevel:h,_pruneTiles:function(){if(this._map){var d,b,c=this._map.getZoom();if(c>this.options.maxZoom||c<this.options.minZoom)this._removeAllTiles();else{for(d in this._tiles)(b=this._tiles[d]).retain=b.current;for(d in this._tiles)(b=this._tiles[d]).current&&!b.active&&(c=b.coords,this._retainParent(c.x,c.y,c.z,c.z-5)||this._retainChildren(c.x,c.y,c.z,c.z+2));for(d in this._tiles)this._tiles[d].retain||this._removeTile(d)}}},_removeTilesAtZoom:function(d){for(var b in this._tiles)this._tiles[b].coords.z===d&&this._removeTile(b)},_removeAllTiles:function(){for(var d in this._tiles)this._removeTile(d)},_invalidateAll:function(){for(var d in this._levels)W(this._levels[d].el),this._onRemoveLevel(d),delete this._levels[d];this._removeAllTiles();this._tileZoom=void 0},_retainParent:function(d,b,c,a){d=Math.floor(d/2);b=Math.floor(b/2);--c;var l=new B(+d,+b);l.z=+c;l=this._tileCoordsToKey(l);return(l=this._tiles[l])&&l.active?(l.retain=!0,!0):(l&&l.loaded&&(l.retain=!0),c>a&&this._retainParent(d,b,c,a))},_retainChildren:function(d,b,c,a){for(var l=2*d;l<2*d+2;l++)for(var r=2*b;r<2*b+2;r++){var n=new B(l,r);n.z=c+1;n=this._tileCoordsToKey(n);(n=this._tiles[n])&&n.active?n.retain=!0:(n&&n.loaded&&(n.retain=!0),c+1<a&&this._retainChildren(l,r,c+1,a))}},_resetView:function(d){d=d&&(d.pinch||d.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),d,d)},_animateZoom:function(d){this._setView(d.center,d.zoom,!0,d.noUpdate)},_clampZoom:function(d){var b=this.options;return void 0!==b.minNativeZoom&&d<b.minNativeZoom?b.minNativeZoom:void 0!==b.maxNativeZoom&&b.maxNativeZoom<d?b.maxNativeZoom:d},_setView:function(d,b,c,a){var l=this._clampZoom(Math.round(b));(void 0!==this.options.maxZoom&&l>this.options.maxZoom||void 0!==this.options.minZoom&&l<this.options.minZoom)&&(l=void 0);var r=this.options.updateWhenZooming&&l!==this._tileZoom;a&&!r||(this._tileZoom=l,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==l&&this._update(d),c||this._pruneTiles(),this._noPrune=!!c);this._setZoomTransforms(d,b)},_setZoomTransforms:function(d,b){for(var c in this._levels)this._setZoomTransform(this._levels[c],d,b)},_setZoomTransform:function(d,b,c){var a=this._map.getZoomScale(c,d.zoom);b=d.origin.multiplyBy(a).subtract(this._map._getNewPixelOrigin(b,c)).round();Fa?T(d.el,b,a):Y(d.el,b)},_resetGrid:function(){var d=this._map,b=d.options.crs,c=this._tileSize=this.getTileSize(),a=this._tileZoom,l=this._map.getPixelWorldBounds(this._tileZoom);l&&(this._globalTileRange=this._pxBoundsToTileRange(l));this._wrapX=b.wrapLng&&!this.options.noWrap&&[Math.floor(d.project([0,b.wrapLng[0]],a).x/c.x),Math.ceil(d.project([0,b.wrapLng[1]],a).x/c.y)];this._wrapY=b.wrapLat&&!this.options.noWrap&&[Math.floor(d.project([b.wrapLat[0],0],a).y/c.x),Math.ceil(d.project([b.wrapLat[1],0],a).y/c.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(d){var b=this._map,c=b._animatingZoom?Math.max(b._animateToZoom,b.getZoom()):b.getZoom(),c=b.getZoomScale(c,this._tileZoom);d=b.project(d,this._tileZoom).floor();b=b.getSize().divideBy(2*c);return new J(d.subtract(b),d.add(b))},_update:function(d){var b=this._map;if(b){var c=this._clampZoom(b.getZoom());if(void 0===d&&(d=b.getCenter()),void 0!==this._tileZoom){var b=this._getTiledPixelBounds(d),a=this._pxBoundsToTileRange(b),l=a.getCenter(),b=[],r=this.options.keepBuffer,r=new J(a.getBottomLeft().subtract([r,-r]),a.getTopRight().add([r,-r]));if(!(isFinite(a.min.x)&&isFinite(a.min.y)&&isFinite(a.max.x)&&isFinite(a.max.y)))throw Error("Attempted to load an infinite number of tiles");for(var f in this._tiles){var e=this._tiles[f].coords;e.z===this._tileZoom&&r.contains(new B(e.x,e.y))||(this._tiles[f].current=!1)}if(1<Math.abs(c-this._tileZoom))this._setView(d,c);else{for(c=a.min.y;c<=a.max.y;c++)for(d=a.min.x;d<=a.max.x;d++)if(f=new B(d,c),f.z=this._tileZoom,this._isValidTile(f))(r=this._tiles[this._tileCoordsToKey(f)])?r.current=!0:b.push(f);if(b.sort(function(d,b){return d.distanceTo(l)-b.distanceTo(l)}),0!==b.length){this._loading||(this._loading=!0,this.fire("loading"));a=document.createDocumentFragment();for(d=0;d<b.length;d++)this._addTile(b[d],a);this._level.el.appendChild(a)}}}}},_isValidTile:function(d){var b=this._map.options.crs;if(!b.infinite){var c=this._globalTileRange;if(!b.wrapLng&&(d.x<c.min.x||d.x>c.max.x)||!b.wrapLat&&(d.y<c.min.y||d.y>c.max.y))return!1}if(!this.options.bounds)return!0;d=this._tileCoordsToBounds(d);return U(this.options.bounds).overlaps(d)},_keyToBounds:function(d){return this._tileCoordsToBounds(this._keyToTileCoords(d))},_tileCoordsToNwSe:function(d){var b=this._map,c=this.getTileSize(),a=d.scaleBy(c),c=a.add(c);return[b.unproject(a,d.z),b.unproject(c,d.z)]},_tileCoordsToBounds:function(d){d=this._tileCoordsToNwSe(d);d=new ca(d[0],d[1]);return this.options.noWrap||(d=this._map.wrapLatLngBounds(d)),d},_tileCoordsToKey:function(d){return d.x+":"+d.y+":"+d.z},_keyToTileCoords:function(d){d=d.split(":");var b=new B(+d[0],+d[1]);return b.z=+d[2],b},_removeTile:function(d){var b=this._tiles[d];b&&(W(b.el),delete this._tiles[d],this.fire("tileunload",{tile:b.el,coords:this._keyToTileCoords(d)}))},_initTile:function(d){G(d,"leaflet-tile");var b=this.getTileSize();d.style.width=b.x+"px";d.style.height=b.y+"px";d.onselectstart=h;d.onmousemove=h;rb&&1>this.options.opacity&&ga(d,this.options.opacity);kb&&!Eb&&(d.style.WebkitBackfaceVisibility="hidden")},_addTile:function(d,b){var c=this._getTilePos(d),a=this._tileCoordsToKey(d),l=this.createTile(this._wrapCoords(d),g(this._tileReady,this,d));this._initTile(l);2>this.createTile.length&&P(g(this._tileReady,this,d,null,l));Y(l,c);this._tiles[a]={el:l,coords:d,current:!0};b.appendChild(l);this.fire("tileloadstart",{tile:l,coords:d})},_tileReady:function(d,b,c){b&&this.fire("tileerror",{error:b,tile:c,coords:d});var a=this._tileCoordsToKey(d);(c=this._tiles[a])&&(c.loaded=+new Date,this._map._fadeAnimated?(ga(c.el,0),V(this._fadeFrame),this._fadeFrame=P(this._updateOpacity,this)):(c.active=!0,this._pruneTiles()),b||(G(c.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:c.el,coords:d})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),rb||!this._map._fadeAnimated?P(this._pruneTiles,this):setTimeout(g(this._pruneTiles,this),250)))},_getTilePos:function(d){return d.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(d){var b=new B(this._wrapX?k(d.x,this._wrapX):d.x,this._wrapY?k(d.y,this._wrapY):d.y);return b.z=d.z,b},_pxBoundsToTileRange:function(d){var b=this.getTileSize();return new J(d.min.unscaleBy(b).floor(),d.max.unscaleBy(b).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var d in this._tiles)if(!this._tiles[d].loaded)return!1;return!0}}),Ub=qc.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(d,b){this._url=d;(b=v(this,b)).detectRetina&&tb&&0<b.maxZoom&&(b.tileSize=Math.floor(b.tileSize/2),b.zoomReverse?(b.zoomOffset--,b.minZoom++):(b.zoomOffset++,b.maxZoom--),b.minZoom=Math.max(0,b.minZoom));"string"==typeof b.subdomains&&(b.subdomains=b.subdomains.split(""));kb||this.on("tileunload",this._onTileRemove)},setUrl:function(d,b){return this._url=d,b||this.redraw(),this},createTile:function(d,b){var a=document.createElement("img");return c(a,"load",g(this._tileOnLoad,this,b,a)),c(a,"error",g(this._tileOnError,this,b,a)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(a.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),a.alt="",a.setAttribute("role","presentation"),a.src=this.getTileUrl(d),a},getTileUrl:function(d){var b={r:tb?"@2x":"",s:this._getSubdomain(d),x:d.x,y:d.y,z:this._getZoomForUrl()};this._map&&!this._map.options.crs.infinite&&(d=this._globalTileRange.max.y-d.y,this.options.tms&&(b.y=d),b["-y"]=d);return w(this._url,e(b,this.options))},_tileOnLoad:function(d,b){rb?setTimeout(g(d,this,null,b),0):d(null,b)},_tileOnError:function(d,b,c){var a=this.options.errorTileUrl;a&&b.getAttribute("src")!==a&&(b.src=a);d(c,b)},_onTileRemove:function(d){d.tile.onload=null},_getZoomForUrl:function(){var d=this._tileZoom,b=this.options.maxZoom,c=this.options.zoomOffset;return this.options.zoomReverse&&(d=b-d),d+c},_getSubdomain:function(d){return this.options.subdomains[Math.abs(d.x+d.y)%this.options.subdomains.length]},_abortLoading:function(){var d,b;for(d in this._tiles)this._tiles[d].coords.z!==this._tileZoom&&((b=this._tiles[d].el).onload=h,b.onerror=h,b.complete||(b.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs\x3d",W(b),delete this._tiles[d]))},_removeTile:function(d){var b=this._tiles[d];if(b)return Cc||b.el.setAttribute("src","data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs\x3d"),qc.prototype._removeTile.call(this,d)},_tileReady:function(d,b,c){if(this._map&&(!c||"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs\x3d"!==c.getAttribute("src")))return qc.prototype._tileReady.call(this,d,b,c)}}),od=Ub.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(d,b){this._url=d;var c=e({},this.defaultWmsParams),a;for(a in b)a in this.options||(c[a]=b[a]);a=v(this,b).detectRetina&&tb?2:1;var l=this.getTileSize();c.width=l.x*a;c.height=l.y*a;this.wmsParams=c},onAdd:function(d){this._crs=this.options.crs||d.options.crs;this._wmsVersion=parseFloat(this.wmsParams.version);this.wmsParams[1.3<=this._wmsVersion?"crs":"srs"]=this._crs.code;Ub.prototype.onAdd.call(this,d)},getTileUrl:function(d){var b=this._tileCoordsToNwSe(d),c=this._crs,c=ka(c.project(b[0]),c.project(b[1])),b=c.min,c=c.max,b=(1.3<=this._wmsVersion&&this._crs===kd?[b.y,b.x,c.y,c.x]:[b.x,b.y,c.x,c.y]).join(",");d=Ub.prototype.getTileUrl.call(this,d);return d+z(this.wmsParams,d,this.options.uppercase)+(this.options.uppercase?"\x26BBOX\x3d":"\x26bbox\x3d")+b},setParams:function(d,b){return e(this.wmsParams,d),b||this.redraw(),this}});Ub.WMS=od;xc.wms=function(d,b){return new od(d,b)};var $a=Ia.extend({options:{padding:.1,tolerance:0},initialize:function(d){v(this,d);f(this);this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&G(this._container,"leaflet-zoom-animated"));this.getPane().appendChild(this._container);this._update();this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this);this._destroyContainer()},getEvents:function(){var d={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(d.zoomanim=this._onAnimZoom),d},_onAnimZoom:function(d){this._updateTransform(d.center,d.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(d,b){var c=this._map.getZoomScale(b,this._zoom),a=ua(this._container),l=this._map.getSize().multiplyBy(.5+this.options.padding),r=this._map.project(this._center,b),r=this._map.project(d,b).subtract(r),a=l.multiplyBy(-c).add(a).add(l).subtract(r);Fa?T(this._container,a,c):Y(this._container,a)},_reset:function(){this._update();this._updateTransform(this._center,this._zoom);for(var d in this._layers)this._layers[d]._reset()},_onZoomEnd:function(){for(var d in this._layers)this._layers[d]._project()},_updatePaths:function(){for(var d in this._layers)this._layers[d]._update()},_update:function(){var d=this.options.padding,b=this._map.getSize(),c=this._map.containerPointToLayerPoint(b.multiplyBy(-d)).round();this._bounds=new J(c,c.add(b.multiplyBy(1+2*d)).round());this._center=this._map.getCenter();this._zoom=this._map.getZoom()}}),cd=$a.extend({getEvents:function(){var d=$a.prototype.getEvents.call(this);return d.viewprereset=this._onViewPreReset,d},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){$a.prototype.onAdd.call(this);this._draw()},_initContainer:function(){var d=this._container=document.createElement("canvas");c(d,"mousemove",m(this._onMouseMove,32,this),this);c(d,"click dblclick mousedown mouseup contextmenu",this._onClick,this);c(d,"mouseout",this._handleMouseOut,this);this._ctx=d.getContext("2d")},_destroyContainer:function(){V(this._redrawRequest);delete this._ctx;W(this._container);D(this._container);delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){this._redrawBounds=null;for(var d in this._layers)this._layers[d]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={};$a.prototype._update.call(this);var d=this._bounds,b=this._container,c=d.getSize(),a=tb?2:1;Y(b,d.min);b.width=a*c.x;b.height=a*c.y;b.style.width=c.x+"px";b.style.height=c.y+"px";tb&&this._ctx.scale(2,2);this._ctx.translate(-d.min.x,-d.min.y);this.fire("update")}},_reset:function(){$a.prototype._reset.call(this);this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(d){this._updateDashArray(d);this._layers[f(d)]=d;d=d._order={layer:d,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=d);this._drawLast=d;this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(d){this._requestRedraw(d)},_removePath:function(d){var b=d._order,c=b.next,b=b.prev;c?c.prev=b:this._drawLast=b;b?b.next=c:this._drawFirst=c;delete this._drawnLayers[d._leaflet_id];delete d._order;delete this._layers[f(d)];this._requestRedraw(d)},_updatePath:function(d){this._extendRedrawBounds(d);d._project();d._update();this._requestRedraw(d)},_updateStyle:function(d){this._updateDashArray(d);this._requestRedraw(d)},_updateDashArray:function(d){if("string"==typeof d.options.dashArray){var b,c=d.options.dashArray.split(/[, ]+/),a=[];for(b=0;b<c.length;b++)a.push(Number(c[b]));d.options._dashArray=a}else d.options._dashArray=d.options.dashArray},_requestRedraw:function(d){this._map&&(this._extendRedrawBounds(d),this._redrawRequest=this._redrawRequest||P(this._redraw,this))},_extendRedrawBounds:function(d){if(d._pxBounds){var b=(d.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new J;this._redrawBounds.extend(d._pxBounds.min.subtract([b,b]));this._redrawBounds.extend(d._pxBounds.max.add([b,b]))}},_redraw:function(){this._redrawRequest=null;this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil());this._clear();this._draw();this._redrawBounds=null},_clear:function(){var d=this._redrawBounds;if(d){var b=d.getSize();this._ctx.clearRect(d.min.x,d.min.y,b.x,b.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var d,b=this._redrawBounds;if(this._ctx.save(),b)d=b.getSize(),this._ctx.beginPath(),this._ctx.rect(b.min.x,b.min.y,d.x,d.y),this._ctx.clip();this._drawing=!0;for(var c=this._drawFirst;c;c=c.next)d=c.layer,(!b||d._pxBounds&&d._pxBounds.intersects(b))&&d._updatePath();this._drawing=!1;this._ctx.restore()},_updatePoly:function(d,b){if(this._drawing){var c,a,l,r,f=d._parts,e=f.length,n=this._ctx;if(e){this._drawnLayers[d._leaflet_id]=d;n.beginPath();for(c=0;c<e;c++){a=0;for(l=f[c].length;a<l;a++)r=f[c][a],n[a?"lineTo":"moveTo"](r.x,r.y);b&&n.closePath()}this._fillStroke(n,d)}}},_updateCircle:function(d){if(this._drawing&&!d._empty()){var b=d._point,c=this._ctx,a=Math.max(Math.round(d._radius),1),l=(Math.max(Math.round(d._radiusY),1)||a)/a;this._drawnLayers[d._leaflet_id]=d;1!==l&&(c.save(),c.scale(1,l));c.beginPath();c.arc(b.x,b.y/l,a,0,2*Math.PI,!1);1!==l&&c.restore();this._fillStroke(c,d)}},_fillStroke:function(d,b){var c=b.options;c.fill&&(d.globalAlpha=c.fillOpacity,d.fillStyle=c.fillColor||c.color,d.fill(c.fillRule||"evenodd"));c.stroke&&0!==c.weight&&(d.setLineDash&&d.setLineDash(b.options&&b.options._dashArray||[]),d.globalAlpha=c.opacity,d.lineWidth=c.weight,d.strokeStyle=c.color,d.lineCap=c.lineCap,d.lineJoin=c.lineJoin,d.stroke())},_onClick:function(d){for(var b,c,a=this._map.mouseEventToLayerPoint(d),l=this._drawFirst;l;l=l.next)(b=l.layer).options.interactive&&b._containsPoint(a)&&!this._map._draggableMoved(b)&&(c=b);c&&(Xa(d),this._fireEvent([c],d))},_onMouseMove:function(d){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var b=this._map.mouseEventToLayerPoint(d);this._handleMouseHover(d,b)}},_handleMouseOut:function(d){var b=this._hoveredLayer;b&&(X(this._container,"leaflet-interactive"),this._fireEvent([b],d,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(d,b){for(var c,a,l=this._drawFirst;l;l=l.next)(c=l.layer).options.interactive&&c._containsPoint(b)&&(a=c);a!==this._hoveredLayer&&(this._handleMouseOut(d),a&&(G(this._container,"leaflet-interactive"),this._fireEvent([a],d,"mouseover"),this._hoveredLayer=a));this._hoveredLayer&&this._fireEvent([this._hoveredLayer],d)},_fireEvent:function(d,b,c){this._map._fireDOMEvent(b,c||b.type,d)},_bringToFront:function(d){var b=d._order,c=b.next,a=b.prev;c&&(c.prev=a,a?a.next=c:c&&(this._drawFirst=c),b.prev=this._drawLast,this._drawLast.next=b,b.next=null,this._drawLast=b,this._requestRedraw(d))},_bringToBack:function(d){var b=d._order,c=b.next,a=b.prev;a&&(a.next=c,c?c.prev=a:a&&(this._drawLast=a),b.prev=null,b.next=this._drawFirst,this._drawFirst.prev=b,this._drawFirst=b,this._requestRedraw(d))}}),rc=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(d){return document.createElement("\x3clvml:"+d+' class\x3d"lvml"\x3e')}}catch(d){return function(d){return document.createElement("\x3c"+d+' xmlns\x3d"urn:schemas-microsoft.com:vml" class\x3d"lvml"\x3e')}}}(),Kd={_initContainer:function(){this._container=M("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||($a.prototype._update.call(this),this.fire("update"))},_initPath:function(d){var b=d._container=rc("shape");G(b,"leaflet-vml-shape "+(this.options.className||""));b.coordsize="1 1";d._path=rc("path");b.appendChild(d._path);this._updateStyle(d);this._layers[f(d)]=d},_addPath:function(d){var b=d._container;this._container.appendChild(b);d.options.interactive&&d.addInteractiveTarget(b)},_removePath:function(d){var b=d._container;W(b);d.removeInteractiveTarget(b);delete this._layers[f(d)]},_updateStyle:function(d){var b=d._stroke,c=d._fill,a=d.options,l=d._container;l.stroked=!!a.stroke;l.filled=!!a.fill;a.stroke?(b||(b=d._stroke=rc("stroke")),l.appendChild(b),b.weight=a.weight+"px",b.color=a.color,b.opacity=a.opacity,a.dashArray?b.dashStyle=na(a.dashArray)?a.dashArray.join(" "):a.dashArray.replace(/( *, *)/g," "):b.dashStyle="",b.endcap=a.lineCap.replace("butt","flat"),b.joinstyle=a.lineJoin):b&&(l.removeChild(b),d._stroke=null);a.fill?(c||(c=d._fill=rc("fill")),l.appendChild(c),c.color=a.fillColor||a.color,c.opacity=a.fillOpacity):c&&(l.removeChild(c),d._fill=null)},_updateCircle:function(d){var b=d._point.round(),c=Math.round(d._radius),a=Math.round(d._radiusY||c);this._setPath(d,d._empty()?"M0 0":"AL "+b.x+","+b.y+" "+c+","+a+" 0,23592600")},_setPath:function(d,b){d._path.v=b},_bringToFront:function(d){Aa(d._container)},_bringToBack:function(d){ta(d._container)}},Hc=Ac?rc:cb,gc=$a.extend({getEvents:function(){var d=$a.prototype.getEvents.call(this);return d.zoomstart=this._onZoomStart,d},_initContainer:function(){this._container=Hc("svg");this._container.setAttribute("pointer-events","none");this._rootGroup=Hc("g");this._container.appendChild(this._rootGroup)},_destroyContainer:function(){W(this._container);D(this._container);delete this._container;delete this._rootGroup;delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){$a.prototype._update.call(this);var d=this._bounds,b=d.getSize(),c=this._container;this._svgSize&&this._svgSize.equals(b)||(this._svgSize=b,c.setAttribute("width",b.x),c.setAttribute("height",b.y));Y(c,d.min);c.setAttribute("viewBox",[d.min.x,d.min.y,b.x,b.y].join(" "));this.fire("update")}},_initPath:function(d){var b=d._path=Hc("path");d.options.className&&G(b,d.options.className);d.options.interactive&&G(b,"leaflet-interactive");this._updateStyle(d);this._layers[f(d)]=d},_addPath:function(d){this._rootGroup||this._initContainer();this._rootGroup.appendChild(d._path);d.addInteractiveTarget(d._path)},_removePath:function(d){W(d._path);d.removeInteractiveTarget(d._path);delete this._layers[f(d)]},_updatePath:function(d){d._project();d._update()},_updateStyle:function(d){var b=d._path;d=d.options;b&&(d.stroke?(b.setAttribute("stroke",d.color),b.setAttribute("stroke-opacity",d.opacity),b.setAttribute("stroke-width",d.weight),b.setAttribute("stroke-linecap",d.lineCap),b.setAttribute("stroke-linejoin",d.lineJoin),d.dashArray?b.setAttribute("stroke-dasharray",d.dashArray):b.removeAttribute("stroke-dasharray"),d.dashOffset?b.setAttribute("stroke-dashoffset",d.dashOffset):b.removeAttribute("stroke-dashoffset")):b.setAttribute("stroke","none"),d.fill?(b.setAttribute("fill",d.fillColor||d.color),b.setAttribute("fill-opacity",d.fillOpacity),b.setAttribute("fill-rule",d.fillRule||"evenodd")):b.setAttribute("fill","none"))},_updatePoly:function(d,b){this._setPath(d,ra(d._parts,b))},_updateCircle:function(b){var d=b._point,c=Math.max(Math.round(b._radius),1),a="a"+c+","+(Math.max(Math.round(b._radiusY),1)||c)+" 0 1,0 ",d=b._empty()?"M0 0":"M"+(d.x-c)+","+d.y+a+2*c+",0 "+a+2*-c+",0 ";this._setPath(b,d)},_setPath:function(b,c){b._path.setAttribute("d",c)},_bringToFront:function(b){Aa(b._path)},_bringToBack:function(b){ta(b._path)}});Ac&&gc.include(Kd);Q.include({getRenderer:function(b){b=b.options.renderer||this._getPaneRenderer(b.options.pane)||this.options.renderer||this._renderer;return b||(b=this._renderer=this._createRenderer()),this.hasLayer(b)||this.addLayer(b),b},_getPaneRenderer:function(b){if("overlayPane"===b||void 0===b)return!1;var d=this._paneRenderers[b];return void 0===d&&(d=this._createRenderer({pane:b}),this._paneRenderers[b]=d),d},_createRenderer:function(b){return this.options.preferCanvas&&yc(b)||zc(b)}});var pd=Rb.extend({initialize:function(b,c){Rb.prototype.initialize.call(this,this._boundsToLatLngs(b),c)},setBounds:function(b){return this.setLatLngs(this._boundsToLatLngs(b))},_boundsToLatLngs:function(b){return b=U(b),[b.getSouthWest(),b.getNorthWest(),b.getNorthEast(),b.getSouthEast()]}});gc.create=Hc;gc.pointsToPath=ra;gb.geometryToLayer=Pb;gb.coordsToLatLng=ob;gb.coordsToLatLngs=Qb;gb.latLngToCoords=Ab;gb.latLngsToCoords=Sb;gb.getFeature=pb;gb.asFeature=Tb;Q.mergeOptions({boxZoom:!0});var qd=Za.extend({initialize:function(b){this._map=b;this._container=b._container;this._pane=b._panes.overlayPane;this._resetStateTimeout=0;b.on("unload",this._destroy,this)},addHooks:function(){c(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){D(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){W(this._pane);delete this._pane},_resetState:function(){this._resetStateTimeout=0;this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(b){if(!b.shiftKey||1!==b.which&&1!==b.button)return!1;this._clearDeferredResetState();this._resetState();Cb();oa();this._startPoint=this._map.mouseEventToContainerPoint(b);c(document,{contextmenu:Ba,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(b){this._moved||(this._moved=!0,this._box=M("div","leaflet-zoom-box",this._container),G(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart"));this._point=this._map.mouseEventToContainerPoint(b);b=new J(this._point,this._startPoint);var d=b.getSize();Y(this._box,b.min);this._box.style.width=d.x+"px";this._box.style.height=d.y+"px"},_finish:function(){this._moved&&(W(this._box),X(this._container,"leaflet-crosshair"));Db();C();D(document,{contextmenu:Ba,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(b){1!==b.which&&1!==b.button||(this._finish(),!this._moved)||(this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(g(this._resetState,this),0),b=new ca(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point)),this._map.fitBounds(b).fire("boxzoomend",{boxZoomBounds:b}))},_onKeyDown:function(b){27===b.keyCode&&this._finish()}});Q.addInitHook("addHandler","boxZoom",qd);Q.mergeOptions({doubleClickZoom:!0});var rd=Za.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(b){var d=this._map,c=d.getZoom(),a=d.options.zoomDelta,c=b.originalEvent.shiftKey?c-a:c+a;"center"===d.options.doubleClickZoom?d.setZoom(c):d.setZoomAround(b.containerPoint,c)}});Q.addInitHook("addHandler","doubleClickZoom",rd);Q.mergeOptions({dragging:!0,inertia:!Eb,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var sd=Za.extend({addHooks:function(){if(!this._draggable){var b=this._map;this._draggable=new Hb(b._mapPane,b._container);this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this);this._draggable.on("predrag",this._onPreDragLimit,this);b.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),b.on("zoomend",this._onZoomEnd,this),b.whenReady(this._onZoomEnd,this))}G(this._map._container,"leaflet-grab leaflet-touch-drag");this._draggable.enable();this._positions=[];this._times=[]},removeHooks:function(){X(this._map._container,"leaflet-grab");X(this._map._container,"leaflet-touch-drag");this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var b=this._map;if(b._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=U(this._map.options.maxBounds);this._offsetLimit=ka(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize()));this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;b.fire("movestart").fire("dragstart");b.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(b){if(this._map.options.inertia){var d=this._lastTime=+new Date,c=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(c);this._times.push(d);this._prunePositions(d)}this._map.fire("move",b).fire("drag",b)},_prunePositions:function(b){for(;1<this._positions.length&&50<b-this._times[0];)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var b=this._map.getSize().divideBy(2);this._initialWorldOffset=this._map.latLngToLayerPoint([0,0]).subtract(b).x;this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(b,c){return b-(b-c)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var b=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;b.x<c.min.x&&(b.x=this._viscousLimit(b.x,c.min.x));b.y<c.min.y&&(b.y=this._viscousLimit(b.y,c.min.y));b.x>c.max.x&&(b.x=this._viscousLimit(b.x,c.max.x));b.y>c.max.y&&(b.y=this._viscousLimit(b.y,c.max.y));this._draggable._newPos=this._draggable._startPos.add(b)}},_onPreDragWrap:function(){var b=this._worldWidth,c=Math.round(b/2),a=this._initialWorldOffset,l=this._draggable._newPos.x,r=(l-c+a)%b+c-a,b=(l+c+a)%b-c-a,a=Math.abs(r+a)<Math.abs(b+a)?r:b;this._draggable._absPos=this._draggable._newPos.clone();this._draggable._newPos.x=a},_onDragEnd:function(b){var d=this._map,c=d.options,a=!c.inertia||2>this._times.length;if(d.fire("dragend",b),a)d.fire("moveend");else{this._prunePositions(+new Date);b=this._lastPos.subtract(this._positions[0]);var l=c.easeLinearity,a=b.multiplyBy(l/((this._lastTime-this._times[0])/1E3)),r=a.distanceTo([0,0]);b=Math.min(c.inertiaMaxSpeed,r);var a=a.multiplyBy(b/r),f=b/(c.inertiaDeceleration*l),e=a.multiplyBy(-f/2).round();e.x||e.y?(e=d._limitOffset(e,d.options.maxBounds),P(function(){d.panBy(e,{duration:f,easeLinearity:l,noMoveStart:!0,animate:!0})})):d.fire("moveend")}}});Q.addInitHook("addHandler","dragging",sd);Q.mergeOptions({keyboard:!0,keyboardPanDelta:80});var td=Za.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(b){this._map=b;this._setPanDelta(b.options.keyboardPanDelta);this._setZoomDelta(b.options.zoomDelta)},addHooks:function(){var b=this._map._container;0>=b.tabIndex&&(b.tabIndex="0");c(b,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this);this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks();D(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this);this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var b=document.body,c=document.documentElement,a=b.scrollTop||c.scrollTop,b=b.scrollLeft||c.scrollLeft;this._map._container.focus();window.scrollTo(b,a)}},_onFocus:function(){this._focused=!0;this._map.fire("focus")},_onBlur:function(){this._focused=!1;this._map.fire("blur")},_setPanDelta:function(b){var d,c,a=this._panKeys={},l=this.keyCodes;d=0;for(c=l.left.length;d<c;d++)a[l.left[d]]=[-1*b,0];d=0;for(c=l.right.length;d<c;d++)a[l.right[d]]=[b,0];d=0;for(c=l.down.length;d<c;d++)a[l.down[d]]=[0,b];d=0;for(c=l.up.length;d<c;d++)a[l.up[d]]=[0,-1*b]},_setZoomDelta:function(b){var d,c,a=this._zoomKeys={},l=this.keyCodes;d=0;for(c=l.zoomIn.length;d<c;d++)a[l.zoomIn[d]]=b;d=0;for(c=l.zoomOut.length;d<c;d++)a[l.zoomOut[d]]=-b},_addHooks:function(){c(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){D(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(b){if(!(b.altKey||b.ctrlKey||b.metaKey)){var d,c=b.keyCode,a=this._map;if(c in this._panKeys)a._panAnim&&a._panAnim._inProgress||(d=this._panKeys[c],b.shiftKey&&(d=I(d).multiplyBy(3)),a.panBy(d),a.options.maxBounds&&a.panInsideBounds(a.options.maxBounds));else if(c in this._zoomKeys)a.setZoom(a.getZoom()+(b.shiftKey?3:1)*this._zoomKeys[c]);else{if(27!==c||!a._popup||!a._popup.options.closeOnEscapeKey)return;a.closePopup()}Ba(b)}}});Q.addInitHook("addHandler","keyboard",td);Q.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ud=Za.extend({addHooks:function(){c(this._map._container,"mousewheel",this._onWheelScroll,this);this._delta=0},removeHooks:function(){D(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(b){var d=cc(b),c=this._map.options.wheelDebounceTime;this._delta+=d;this._lastMousePos=this._map.mouseEventToContainerPoint(b);this._startTime||(this._startTime=+new Date);d=Math.max(c-(+new Date-this._startTime),0);clearTimeout(this._timer);this._timer=setTimeout(g(this._performZoom,this),d);Ba(b)},_performZoom:function(){var b=this._map,c=b.getZoom(),a=this._map.options.zoomSnap||0;b._stop();var l=4*Math.log(2/(1+Math.exp(-Math.abs(this._delta/(4*this._map.options.wheelPxPerZoomLevel)))))/Math.LN2,a=a?Math.ceil(l/a)*a:l,a=b._limitZoom(c+(0<this._delta?a:-a))-c;this._delta=0;this._startTime=null;a&&("center"===b.options.scrollWheelZoom?b.setZoom(c+a):b.setZoomAround(this._lastMousePos,c+a))}});Q.addInitHook("addHandler","scrollWheelZoom",ud);Q.mergeOptions({tap:!0,tapTolerance:15});var vd=Za.extend({addHooks:function(){c(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){D(this._map._container,"touchstart",this._onDown,this)},_onDown:function(b){if(b.touches){if(sa(b),this._fireClick=!0,1<b.touches.length)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var d=b.touches[0];b=d.target;this._startPos=this._newPos=new B(d.clientX,d.clientY);b.tagName&&"a"===b.tagName.toLowerCase()&&G(b,"leaflet-active");this._holdTimeout=setTimeout(g(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",d))},this),1E3);this._simulateEvent("mousedown",d);c(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(b){if(clearTimeout(this._holdTimeout),D(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&b&&b.changedTouches){b=b.changedTouches[0];var d=b.target;d&&d.tagName&&"a"===d.tagName.toLowerCase()&&X(d,"leaflet-active");this._simulateEvent("mouseup",b);this._isTapValid()&&this._simulateEvent("click",b)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(b){b=b.touches[0];this._newPos=new B(b.clientX,b.clientY);this._simulateEvent("mousemove",b)},_simulateEvent:function(b,c){var d=document.createEvent("MouseEvents");d._simulated=!0;c.target._simulatedClick=!0;d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null);c.target.dispatchEvent(d)}});Wa&&!Ka&&Q.addInitHook("addHandler","tap",vd);Q.mergeOptions({touchZoom:Wa&&!Eb,bounceAtZoomLimits:!0});var wd=Za.extend({addHooks:function(){G(this._map._container,"leaflet-touch-zoom");c(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){X(this._map._container,"leaflet-touch-zoom");D(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(b){var d=this._map;if(b.touches&&2===b.touches.length&&!d._animatingZoom&&!this._zooming){var a=d.mouseEventToContainerPoint(b.touches[0]),l=d.mouseEventToContainerPoint(b.touches[1]);this._centerPoint=d.getSize()._divideBy(2);this._startLatLng=d.containerPointToLatLng(this._centerPoint);"center"!==d.options.touchZoom&&(this._pinchStartLatLng=d.containerPointToLatLng(a.add(l)._divideBy(2)));this._startDist=a.distanceTo(l);this._startZoom=d.getZoom();this._moved=!1;this._zooming=!0;d._stop();c(document,"touchmove",this._onTouchMove,this);c(document,"touchend",this._onTouchEnd,this);sa(b)}},_onTouchMove:function(b){if(b.touches&&2===b.touches.length&&this._zooming){var d=this._map,c=d.mouseEventToContainerPoint(b.touches[0]),a=d.mouseEventToContainerPoint(b.touches[1]),l=c.distanceTo(a)/this._startDist;if(this._zoom=d.getScaleZoom(l,this._startZoom),!d.options.bounceAtZoomLimits&&(this._zoom<d.getMinZoom()&&1>l||this._zoom>d.getMaxZoom()&&1<l)&&(this._zoom=d._limitZoom(this._zoom)),"center"===d.options.touchZoom){if(this._center=this._startLatLng,1===l)return}else{c=c._add(a)._divideBy(2)._subtract(this._centerPoint);if(1===l&&0===c.x&&0===c.y)return;this._center=d.unproject(d.project(this._pinchStartLatLng,this._zoom).subtract(c),this._zoom)}this._moved||(d._moveStart(!0,!1),this._moved=!0);V(this._animRequest);d=g(d._move,d,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=P(d,this,!0);sa(b)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,V(this._animRequest),D(document,"touchmove",this._onTouchMove),D(document,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});Q.addInitHook("addHandler","touchZoom",wd);Q.BoxZoom=qd;Q.DoubleClickZoom=rd;Q.Drag=sd;Q.Keyboard=td;Q.ScrollWheelZoom=ud;Q.Tap=vd;Q.TouchZoom=wd;Object.freeze=Bc;a.version="1.3.4";a.Control=Ra;a.control=oc;a.Browser=Bd;a.Evented=Bb;a.Mixin=Ed;a.Util=qb;a.Class=ba;a.Handler=Za;a.extend=e;a.bind=g;a.stamp=f;a.setOptions=v;a.DomEvent=Dd;a.DomUtil=Cd;a.PosAnimation=fd;a.Draggable=Hb;a.LineUtil=Fd;a.PolyUtil=Gd;a.Point=B;a.point=I;a.Bounds=J;a.bounds=ka;a.Transformation=Da;a.transformation=qa;a.Projection=Hd;a.LatLng=N;a.latLng=O;a.LatLngBounds=ca;a.latLngBounds=U;a.CRS=Qa;a.GeoJSON=gb;a.geoJSON=wc;a.geoJson=wc;a.Layer=Ia;a.LayerGroup=Yb;a.layerGroup=function(b,c){return new Yb(b,c)};a.FeatureGroup=zb;a.featureGroup=function(b){return new zb(b)};a.ImageOverlay=Zc;a.imageOverlay=function(b,c,a){return new Zc(b,c,a)};a.VideoOverlay=md;a.videoOverlay=function(b,c,a){return new md(b,c,a)};a.DivOverlay=hb;a.Popup=$b;a.popup=function(b,c){return new $b(b,c)};a.Tooltip=ac;a.tooltip=function(b,c){return new ac(b,c)};a.Icon=Zb;a.icon=function(b){return new Zb(b)};a.DivIcon=nd;a.divIcon=function(b){return new nd(b)};a.Marker=fc;a.marker=function(b,c){return new fc(b,c)};a.TileLayer=Ub;a.tileLayer=xc;a.GridLayer=qc;a.gridLayer=function(b){return new qc(b)};a.SVG=gc;a.svg=zc;a.Renderer=$a;a.Canvas=cd;a.canvas=yc;a.Path=ub;a.CircleMarker=Gc;a.circleMarker=function(b,c){return new Gc(b,c)};a.Circle=Xc;a.circle=function(b,c,a){return new Xc(b,c,a)};a.Polyline=fb;a.polyline=function(b,c){return new fb(b,c)};a.Polygon=Rb;a.polygon=function(b,c){return new Rb(b,c)};a.Rectangle=pd;a.rectangle=function(b,c){return new pd(b,c)};a.Map=Q;a.map=function(b,c){return new Q(b,c)};var Ld=window.L;a.noConflict=function(){return window.L=Ld,this};window.L=a});!function(a,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("leaflet")):"function"==typeof define&&define.amd?define(["exports","leaflet"],e):e((a.L=a.L||{},a.L.esri={}),a.L)}(this,function(a,e){function g(c){var a="",f;for(f in c.f=c.f||"json",c)if(c.hasOwnProperty(f)){var e;e=c[f];var h=Object.prototype.toString.call(e);a.length&&(a+="\x26");e="[object Array]"===h?"[object Object]"===Object.prototype.toString.call(e[0])?JSON.stringify(e):e.join(","):"[object Object]"===h?JSON.stringify(e):"[object Date]"===h?e.valueOf():e;a+=encodeURIComponent(f)+"\x3d"+encodeURIComponent(e)}return a}function f(c,a){var f=new window.XMLHttpRequest;return f.onerror=function(h){f.onreadystatechange=e.Util.falseFn;c.call(a,{error:{code:500,message:"XMLHttpRequest error"}},null)},f.onreadystatechange=function(){var h,k;if(4===f.readyState){try{h=JSON.parse(f.responseText)}catch(xb){h=null,k={code:500,message:"Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."}}!k&&h.error&&(k=h.error,h=null);f.onerror=e.Util.falseFn;c.call(a,k,h)}},f.ontimeout=function(){this.onerror()},f}function m(c,a,e,h){e=f(e,h);return e.open("POST",c),void 0!==h&&null!==h&&void 0!==h.options&&(e.timeout=h.options.timeout),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset\x3dUTF-8"),e.send(g(a)),e}function k(c,a,e,h){e=f(e,h);return e.open("GET",c+"?"+g(a),!0),void 0!==h&&null!==h&&void 0!==h.options&&(e.timeout=h.options.timeout),e.send(null),e}function h(c,a,e,h){var k=g(a),m=f(e,h),D=(c+"?"+k).length;if(2E3>=D&&aa.cors?m.open("GET",c+"?"+k):2E3<D&&aa.cors&&(m.open("POST",c),m.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset\x3dUTF-8")),void 0!==h&&null!==h&&void 0!==h.options&&(m.timeout=h.options.timeout),2E3>=D&&aa.cors)m.send(null);else{if(!(2E3<D&&aa.cors))return 2E3>=D&&!aa.cors?q(c,a,e,h):void U("a request to "+c+" was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy http://esri.github.io/esri-leaflet/api-reference/request.html");m.send(k)}return m}function q(c,a,f,h){window._EsriLeafletCallbacks=window._EsriLeafletCallbacks||{};var k="c"+K;a.callback="window._EsriLeafletCallbacks."+k;window._EsriLeafletCallbacks[k]=function(c){if(!0!==window._EsriLeafletCallbacks[k]){var a,e=Object.prototype.toString.call(c);"[object Object]"!==e&&"[object Array]"!==e&&(a={error:{code:500,message:"Expected array or object as JSONP response"}},c=null);!a&&c.error&&(a=c,c=null);f.call(h,a,c);window._EsriLeafletCallbacks[k]=!0}};var m=e.DomUtil.create("script",null,document.body);return m.type="text/javascript",m.src=c+"?"+g(a),m.id=k,m.onerror=function(c){c&&!0!==window._EsriLeafletCallbacks[k]&&(f.call(h,{error:{code:500,message:"An unknown error occurred"}}),window._EsriLeafletCallbacks[k]=!0)},e.DomUtil.addClass(m,"esri-leaflet-jsonp"),K++,{id:k,url:m.src,abort:function(){window._EsriLeafletCallbacks._callback[k]({code:0,message:"Request aborted."})}}}function p(c){var a;a:{a=c[0];for(var f=0;f<a.length;f++)if(a[f]!==c[c.length-1][f]){a=!1;break a}a=!0}return a||c.push(c[0]),c}function u(c){for(var a,f=0,e=0,h=c.length,k=c[e];e<h-1;e++)f+=((a=c[e+1])[0]-k[0])*(a[1]+k[1]),k=a;return 0<=f}function v(c,a){for(var f=0;f<c.length-1;f++)for(var e=0;e<a.length-1;e++){var h;a:{var k=c[f],m=c[f+1],D=a[e],g=a[e+1],p=(g[0]-D[0])*(k[1]-D[1])-(g[1]-D[1])*(k[0]-D[0]);h=(m[0]-k[0])*(k[1]-D[1])-(m[1]-k[1])*(k[0]-D[0]);k=(g[1]-D[1])*(m[0]-k[0])-(g[0]-D[0])*(m[1]-k[1]);if(0!==k&&(p/=k,h/=k,0<=p&&1>=p&&0<=h&&1>=h)){h=!0;break a}h=!1}if(h)return!0}return!1}function z(c){var a=[];c=c.slice(0);var f=p(c.shift().slice(0));if(4<=f.length)for(u(f)||f.reverse(),a.push(f),f=0;f<c.length;f++){var e=p(c[f].slice(0));4<=e.length&&(u(e)&&e.reverse(),a.push(e))}return a}function w(c){var a={},f;for(f in c)c.hasOwnProperty(f)&&(a[f]=c[f]);return a}function F(c,a){var f={};if(c.features){f.type="FeatureCollection";f.features=[];for(var e=0;e<c.features.length;e++)f.features.push(F(c.features[e],a))}if("number"==typeof c.x&&"number"==typeof c.y&&(f.type="Point",f.coordinates=[c.x,c.y],"number"==typeof c.z&&f.coordinates.push(c.z)),c.points&&(f.type="MultiPoint",f.coordinates=c.points.slice(0)),c.paths&&(1===c.paths.length?(f.type="LineString",f.coordinates=c.paths[0].slice(0)):(f.type="MultiLineString",f.coordinates=c.paths.slice(0))),c.rings&&(f=function(c){var a,f=[],e=[];for(a=0;a<c.length;a++){var h=p(c[a].slice(0));4>h.length||(u(h)?(h=[h.slice().reverse()],f.push(h)):e.push(h.slice().reverse()))}for(h=[];e.length;){a=e.pop();var k=!1;for(c=f.length-1;0<=c;c--){for(var m=f[c][0],D=a,g=v(m,D),D=D[0],q=!1,ea=-1,Va=m.length,pa=Va-1;++ea<Va;pa=ea)(m[ea][1]<=D[1]&&D[1]<m[pa][1]||m[pa][1]<=D[1]&&D[1]<m[ea][1])&&D[0]<(m[pa][0]-m[ea][0])*(D[1]-m[ea][1])/(m[pa][1]-m[ea][1])+m[ea][0]&&(q=!q);m=q;if(!g&&m){f[c].push(a);k=!0;break}}k||h.push(a)}for(;h.length;){a=h.pop();e=!1;for(c=f.length-1;0<=c;c--)if(v(f[c][0],a)){f[c].push(a);e=!0;break}e||f.push([a.reverse()])}return 1===f.length?{type:"Polygon",coordinates:f[0]}:{type:"MultiPolygon",coordinates:f}}(c.rings.slice(0))),(c.geometry||c.attributes)&&(f.type="Feature",f.geometry=c.geometry?F(c.geometry):null,f.properties=c.attributes?w(c.attributes):null,c.attributes))try{f.id=function(c,a){for(var f=a?[a,"OBJECTID","FID"]:["OBJECTID","FID"],e=0;e<f.length;e++){var h=f[e];if(h in c&&("string"==typeof c[h]||"number"==typeof c[h]))return c[h]}throw Error("No valid id attribute found");}(c.attributes,a)}catch(pa){}return JSON.stringify(f.geometry)===JSON.stringify({})&&(f.geometry=null),c.spatialReference&&c.spatialReference.wkid&&4326!==c.spatialReference.wkid&&console.warn("Object converted in non-standard crs - "+JSON.stringify(c.spatialReference)),f}function E(c,a){a=a||"OBJECTID";var f;f={wkid:4326};var e={};switch(c.type){case "Point":e.x=c.coordinates[0];e.y=c.coordinates[1];e.spatialReference=f;break;case "MultiPoint":e.points=c.coordinates.slice(0);e.spatialReference=f;break;case "LineString":e.paths=[c.coordinates.slice(0)];e.spatialReference=f;break;case "MultiLineString":e.paths=c.coordinates.slice(0);e.spatialReference=f;break;case "Polygon":e.rings=z(c.coordinates.slice(0));e.spatialReference=f;break;case "MultiPolygon":for(var h=e,k=c.coordinates.slice(0),m=[],D=0;D<k.length;D++)for(var g=z(k[D]),p=g.length-1;0<=p;p--){var q=g[p].slice(0);m.push(q)}h.rings=m;e.spatialReference=f;break;case "Feature":c.geometry&&(e.geometry=E(c.geometry,a));e.attributes=c.properties?w(c.properties):{};c.id&&(e.attributes[a]=c.id);break;case "FeatureCollection":e=[];for(f=0;f<c.features.length;f++)e.push(E(c.features[f],a));break;case "GeometryCollection":for(e=[],f=0;f<c.geometries.length;f++)e.push(E(c.geometries[f],a))}return e}function H(c,a){return F(c,a)}function P(c){if("NaN"!==c.xmin&&"NaN"!==c.ymin&&"NaN"!==c.xmax&&"NaN"!==c.ymax){var a=e.latLng(c.ymin,c.xmin);c=e.latLng(c.ymax,c.xmax);return e.latLngBounds(a,c)}return null}function V(c){return{xmin:(c=e.latLngBounds(c)).getSouthWest().lng,ymin:c.getSouthWest().lat,xmax:c.getNorthEast().lng,ymax:c.getNorthEast().lat,spatialReference:{wkid:4326}}}function ba(c){var a;if(c.objectIdFieldName)a=c.objectIdFieldName;else if(c.fields){for(var f=0;f<=c.fields.length-1;f++)if("esriFieldTypeOID"===c.fields[f].type){a=c.fields[f].name;break}if(!a)for(f=0;f<=c.fields.length-1;f++)if(c.fields[f].name.match(M)){a=c.fields[f].name;break}}return a}function Ca(c){for(var a in c.attributes)if(a.match(M))return a}function B(c,a){var f,e=c.features||c.results,h=e.length;f=a||ba(c);var k={type:"FeatureCollection",features:[]};if(h)for(h=e.length-1;0<=h;h--){var m=H(e[h],f||Ca(e[h]));k.features.push(m)}return k}function I(c){return"/"!==(c=e.Util.trim(c))[c.length-1]&&(c+="/"),c}function J(c){if(-1!==c.url.indexOf("?")){c.requestParams=c.requestParams||{};var a=c.url.substring(c.url.indexOf("?")+1);c.url=c.url.split("?")[0];c.requestParams=JSON.parse('{"'+decodeURI(a).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')}return c.url=I(c.url.split("?")[0]),c}function ka(c){return/^(?!.*utility\.arcgis\.com).*\.arcgis\.com.*FeatureServer/i.test(c)}function ca(c){var a;switch(c){case "Point":a="esriGeometryPoint";break;case "MultiPoint":a="esriGeometryMultipoint";break;case "LineString":case "MultiLineString":a="esriGeometryPolyline";break;case "Polygon":case "MultiPolygon":a="esriGeometryPolygon"}return a}function U(){console&&console.warn&&console.warn.apply(console,arguments)}function N(c){return c.getSize().x-ya.attributionWidthOffset+"px"}function O(c){if(c.attributionControl&&!c.attributionControl._esriAttributionAdded){c.attributionControl.setPrefix('\x3ca href\x3d"http://leafletjs.com" title\x3d"A JS library for interactive maps"\x3eLeaflet\x3c/a\x3e | Powered by \x3ca href\x3d"https://www.esri.com"\x3eEsri\x3c/a\x3e');var a=document.createElement("style");a.type="text/css";a.innerHTML=".esri-truncated-attribution:hover {white-space: normal;}";document.getElementsByTagName("head")[0].appendChild(a);e.DomUtil.addClass(c.attributionControl._container,"esri-truncated-attribution:hover");var f=document.createElement("style");f.type="text/css";f.innerHTML=".esri-truncated-attribution {vertical-align: -3px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;display: inline-block;transition: 0s white-space;transition-delay: 1s;max-width: "+N(c)+";}";document.getElementsByTagName("head")[0].appendChild(f);e.DomUtil.addClass(c.attributionControl._container,"esri-truncated-attribution");c.on("resize",function(a){c.attributionControl._container.style.maxWidth=N(a.target)});c.on("unload",function(){a.parentNode.removeChild(a);f.parentNode.removeChild(f);for(var c=document.querySelectorAll(".esri-leaflet-jsonp"),e=0;e<c.length;e++)c.item(e).parentNode.removeChild(c.item(e))});c.attributionControl._esriAttributionAdded=!0}}function Da(c){var a={geometry:null,geometryType:null};return c instanceof e.LatLngBounds?(a.geometry=V(c),a.geometryType="esriGeometryEnvelope",a):(c.getLatLng&&(c=c.getLatLng()),c instanceof e.LatLng&&(c={type:"Point",coordinates:[c.lng,c.lat]}),c instanceof e.GeoJSON&&(c=c.getLayers()[0].feature.geometry,a.geometry=E(c,void 0),a.geometryType=ca(c.type)),c.toGeoJSON&&(c=c.toGeoJSON()),"Feature"===c.type&&(c=c.geometry),"Point"===c.type||"LineString"===c.type||"Polygon"===c.type||"MultiPolygon"===c.type?(a.geometry=E(c,void 0),a.geometryType=ca(c.type),a):void U("invalid geometry passed to spatial query. Should be L.LatLng, L.LatLngBounds, L.Marker or a GeoJSON Point, Line, Polygon or MultiPolygon object"))}function qa(c,a){q(c,{},e.Util.bind(function(c,f){if(!c){a._esriAttributions=[];for(var h=0;h<f.contributors.length;h++)for(var k=f.contributors[h],m=0;m<k.coverageAreas.length;m++){var g=k.coverageAreas[m],p=e.latLng(g.bbox[0],g.bbox[1]),D=e.latLng(g.bbox[2],g.bbox[3]);a._esriAttributions.push({attribution:k.attribution,score:g.score,bounds:e.latLngBounds(p,D),minZoom:g.zoomMin,maxZoom:g.zoomMax})}a._esriAttributions.sort(function(c,a){return a.score-c.score});cb({target:a})}},this))}function cb(c){c=c.target;var a=c._esriAttributions;if(c&&c.attributionControl){var f=c.attributionControl._container.querySelector(".esri-dynamic-attribution");if(f&&a){for(var h="",k=c.getBounds(),k=e.latLngBounds(k.getSouthWest().wrap(),k.getNorthEast().wrap()),m=c.getZoom(),g=0;g<a.length;g++){var p=a[g],q=p.attribution;!h.match(q)&&p.bounds.intersects(k)&&m>=p.minZoom&&m<=p.maxZoom&&(h+=", "+q)}h=h.substr(2);f.innerHTML=h;f.style.maxWidth=N(c);c.fire("attributionupdated",{attribution:h})}}}function ra(c){return new Aa(c)}function da(c){return new ta(c)}function Jb(c){return new G(c)}function jb(c){return new X(c)}function Ja(c){return new Ta(c)}function x(c){return new ga(c)}function Kb(c){return new Ua(c)}function xa(c){this.values=[].concat(c||[])}var wa=window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,y=""===document.documentElement.style.pointerEvents,aa={cors:wa,pointerEvents:y},ya={attributionWidthOffset:55},K=0,La=aa.cors?k:q;La.CORS=k;La.JSONP=q;var R={request:h,get:La,post:m},M=/^(OBJECTID|FID|OID|ID)$/i,W={warn:U,cleanUrl:I,getUrlParams:J,isArcgisOnline:ka,geojsonTypeToArcGIS:ca,responseToFeatureCollection:B,geojsonToArcGIS:function(c,a){return E(c,a)},arcgisToGeoJSON:H,boundsToExtent:V,extentToBounds:P,calcAttributionWidth:N,setEsriAttribution:O,_setGeometry:Da,_getAttributionData:qa,_updateMapAttribution:cb,_findIdAttributeFromFeature:Ca,_findIdAttributeFromResponse:ba},Ea=e.Class.extend({options:{proxy:!1,useCors:wa},generateSetter:function(c,a){return e.Util.bind(function(a){return this.params[c]=a,this},a)},initialize:function(c){if(c.request&&c.options?(this._service=c,e.Util.setOptions(this,c.options)):(e.Util.setOptions(this,c),this.options.url=I(c.url)),this.params=e.Util.extend({},this.params||{}),this.setters)for(var a in this.setters)this[a]=this.generateSetter(this.setters[a],this)},token:function(c){return this._service?this._service.authenticate(c):this.params.token=c,this},format:function(c){return this.params.returnUnformattedValues=!c,this},request:function(c,a){return this.options.requestParams&&e.Util.extend(this.params,this.options.requestParams),this._service?this._service.request(this.path,this.params,c,a):this._request("request",this.path,this.params,c,a)},_request:function(c,a,f,e,h){a=this.options.proxy?this.options.proxy+"?"+this.options.url+a:this.options.url+a;return"get"!==c&&"request"!==c||this.options.useCors?R[c](a,f,e,h):R.get.JSONP(a,f,e,h)}}),Aa=Ea.extend({setters:{offset:"resultOffset",limit:"resultRecordCount",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",returnM:"returnM",transform:"datumTransformation",token:"token"},path:"query",params:{returnGeometry:!0,where:"1\x3d1",outSr:4326,outFields:"*"},within:function(c){return this._setGeometryParams(c),this.params.spatialRel="esriSpatialRelContains",this},intersects:function(c){return this._setGeometryParams(c),this.params.spatialRel="esriSpatialRelIntersects",this},contains:function(c){return this._setGeometryParams(c),this.params.spatialRel="esriSpatialRelWithin",this},crosses:function(c){return this._setGeometryParams(c),this.params.spatialRel="esriSpatialRelCrosses",this},touches:function(c){return this._setGeometryParams(c),this.params.spatialRel="esriSpatialRelTouches",this},overlaps:function(c){return this._setGeometryParams(c),this.params.spatialRel="esriSpatialRelOverlaps",this},bboxIntersects:function(c){return this._setGeometryParams(c),this.params.spatialRel="esriSpatialRelEnvelopeIntersects",this},indexIntersects:function(c){return this._setGeometryParams(c),this.params.spatialRel="esriSpatialRelIndexIntersects",this},nearby:function(c,a){return c=e.latLng(c),this.params.geometry=[c.lng,c.lat],this.params.geometryType="esriGeometryPoint",this.params.spatialRel="esriSpatialRelIntersects",this.params.units="esriSRUnit_Meter",this.params.distance=a,this.params.inSr=4326,this},where:function(c){return this.params.where=c,this},between:function(c,a){return this.params.time=[c.valueOf(),a.valueOf()],this},simplify:function(c,a){var f=Math.abs(c.getBounds().getWest()-c.getBounds().getEast());return this.params.maxAllowableOffset=f/c.getSize().y*a,this},orderBy:function(c,a){return a=a||"ASC",this.params.orderByFields=this.params.orderByFields?this.params.orderByFields+",":"",this.params.orderByFields+=[c,a].join(" "),this},run:function(c,a){return this._cleanParams(),this.options.isModern||ka(this.options.url)?(this.params.f="geojson",this.request(function(f,e){this._trapSQLerrors(f);c.call(a,f,e,e)},this)):this.request(function(f,e){this._trapSQLerrors(f);c.call(a,f,e&&B(e),e)},this)},count:function(c,a){return this._cleanParams(),this.params.returnCountOnly=!0,this.request(function(a,f){c.call(this,a,f&&f.count,f)},a)},ids:function(c,a){return this._cleanParams(),this.params.returnIdsOnly=!0,this.request(function(a,f){c.call(this,a,f&&f.objectIds,f)},a)},bounds:function(c,a){return this._cleanParams(),this.params.returnExtentOnly=!0,this.request(function(f,e){e&&e.extent&&P(e.extent)?c.call(a,f,P(e.extent),e):(f={message:"Invalid Bounds"},c.call(a,f,null,e))},a)},distinct:function(){return this.params.returnGeometry=!1,this.params.returnDistinctValues=!0,this},pixelSize:function(c){c=e.point(c);return this.params.pixelSize=[c.x,c.y],this},layer:function(c){return this.path=c+"/query",this},_trapSQLerrors:function(c){c&&"400"===c.code&&U("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")},_cleanParams:function(){delete this.params.returnIdsOnly;delete this.params.returnExtentOnly;delete this.params.returnCountOnly},_setGeometryParams:function(c){this.params.inSr=4326;c=Da(c);this.params.geometry=c.geometry;this.params.geometryType=c.geometryType}}),ta=Ea.extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs:function(c,a){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[c,a].join(":"),this},simplify:function(c,a){var f=Math.abs(c.getBounds().getWest()-c.getBounds().getEast());return this.params.maxAllowableOffset=f/c.getSize().y*a,this},run:function(c,a){return this.request(function(f,e){c.call(a,f,e&&B(e),e)},a)}}),Sa=Ea.extend({path:"identify",between:function(c,a){return this.params.time=[c.valueOf(),a.valueOf()],this}}),G=Sa.extend({setters:{layers:"layers",precision:"geometryPrecision",tolerance:"tolerance",returnGeometry:"returnGeometry"},params:{sr:4326,layers:"all",tolerance:3,returnGeometry:!0},on:function(c){var a=V(c.getBounds());c=c.getSize();return this.params.imageDisplay=[c.x,c.y,96],this.params.mapExtent=[a.xmin,a.ymin,a.xmax,a.ymax],this},at:function(c){return 2===c.length&&(c=e.latLng(c)),this._setGeometryParams(c),this},layerDef:function(c,a){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[c,a].join(":"),this},simplify:function(c,a){var f=Math.abs(c.getBounds().getWest()-c.getBounds().getEast());return this.params.maxAllowableOffset=f/c.getSize().y*a,this},run:function(c,a){return this.request(function(f,e){if(f)c.call(a,f,void 0,e);else{var h=B(e);e.results=e.results.reverse();for(var k=0;k<h.features.length;k++)h.features[k].layerId=e.results[k].layerId;c.call(a,void 0,h,e)}})},_setGeometryParams:function(c){c=Da(c);this.params.geometry=c.geometry;this.params.geometryType=c.geometryType}}),X=Sa.extend({setters:{setMosaicRule:"mosaicRule",setRenderingRule:"renderingRule",setPixelSize:"pixelSize",returnCatalogItems:"returnCatalogItems",returnGeometry:"returnGeometry"},params:{returnGeometry:!1},at:function(c){return c=e.latLng(c),this.params.geometry=JSON.stringify({x:c.lng,y:c.lat,spatialReference:{wkid:4326}}),this.params.geometryType="esriGeometryPoint",this},getMosaicRule:function(){return this.params.mosaicRule},getRenderingRule:function(){return this.params.renderingRule},getPixelSize:function(){return this.params.pixelSize},run:function(c,a){return this.request(function(f,e){c.call(a,f,e&&this._responseToGeoJSON(e),e)},this)},_responseToGeoJSON:function(c){var a=c.location,f=c.catalogItems,e=c.catalogItemVisibilities,a={pixel:{type:"Feature",geometry:{type:"Point",coordinates:[a.x,a.y]},crs:{type:"EPSG",properties:{code:a.spatialReference.wkid}},properties:{OBJECTID:c.objectId,name:c.name,value:c.value},id:c.objectId}};if(c.properties&&c.properties.Values&&(a.pixel.properties.values=c.properties.Values),f&&f.features&&(a.catalogItems=B(f),e&&e.length===a.catalogItems.features.length))for(c=e.length-1;0<=c;c--)a.catalogItems.features[c].properties.catalogItemVisibility=e[c];return a}}),za=e.Evented.extend({options:{proxy:!1,useCors:wa,timeout:0},initialize:function(c){c=c||{};this._requestQueue=[];this._authenticating=!1;e.Util.setOptions(this,c);this.options.url=I(this.options.url)},get:function(c,a,f,e){return this._request("get",c,a,f,e)},post:function(c,a,f,e){return this._request("post",c,a,f,e)},request:function(c,a,f,e){return this._request("request",c,a,f,e)},metadata:function(c,a){return this._request("get","",{},c,a)},authenticate:function(c){return this._authenticating=!1,this.options.token=c,this._runQueue(),this},getTimeout:function(){return this.options.timeout},setTimeout:function(c){this.options.timeout=c},_request:function(c,a,f,h,k){this.fire("requeststart",{url:this.options.url+a,params:f,method:c},!0);var m=this._createServiceCallback(c,a,f,h,k);if(this.options.token&&(f.token=this.options.token),this.options.requestParams&&e.Util.extend(f,this.options.requestParams),!this._authenticating)return a=this.options.proxy?this.options.proxy+"?"+this.options.url+a:this.options.url+a,"get"!==c&&"request"!==c||this.options.useCors?R[c](a,f,m,k):R.get.JSONP(a,f,m,k);this._requestQueue.push([c,a,f,h,k])},_createServiceCallback:function(c,a,f,h,k){return e.Util.bind(function(m,g){!m||499!==m.code&&498!==m.code||(this._authenticating=!0,this._requestQueue.push([c,a,f,h,k]),this.fire("authenticationrequired",{authenticate:e.Util.bind(this.authenticate,this)},!0),m.authenticate=e.Util.bind(this.authenticate,this));h.call(k,m,g);m?this.fire("requesterror",{url:this.options.url+a,params:f,message:m.message,code:m.code,method:c},!0):this.fire("requestsuccess",{url:this.options.url+a,params:f,response:g,method:c},!0);this.fire("requestend",{url:this.options.url+a,params:f,method:c},!0)},this)},_runQueue:function(){for(var c=this._requestQueue.length-1;0<=c;c--){var a=this._requestQueue[c];this[a.shift()].apply(this,a)}this._requestQueue=[]}}),Ta=za.extend({identify:function(){return Jb(this)},find:function(){return da(this)},query:function(){return ra(this)}}),ga=za.extend({query:function(){return ra(this)},identify:function(){return jb(this)}}),Ua=za.extend({options:{idAttribute:"OBJECTID"},query:function(){return ra(this)},addFeature:function(c,a,f){this.addFeatures(c,a,f)},addFeatures:function(c,a,f){for(var e=c.features?c.features:[c],h=e.length-1;0<=h;h--)delete e[h].id;return c=E(c,void 0),c=1<e.length?c:[c],this.post("addFeatures",{features:c},function(c,e){var h=e&&e.addResults?1<e.addResults.length?e.addResults:e.addResults[0]:void 0;a&&a.call(f,c||e.addResults[0].error,h)},f)},updateFeature:function(c,a,f){this.updateFeatures(c,a,f)},updateFeatures:function(c,a,f){var e=c.features?c.features:[c];return c=E(c,this.options.idAttribute),c=1<e.length?c:[c],this.post("updateFeatures",{features:c},function(c,e){var h=e&&e.updateResults?1<e.updateResults.length?e.updateResults:e.updateResults[0]:void 0;a&&a.call(f,c||e.updateResults[0].error,h)},f)},deleteFeature:function(c,a,f){this.deleteFeatures(c,a,f)},deleteFeatures:function(c,a,f){return this.post("deleteFeatures",{objectIds:c},function(c,e){var h=e&&e.deleteResults?1<e.deleteResults.length?e.deleteResults:e.deleteResults[0]:void 0;a&&a.call(f,c||e.deleteResults[0].error,h)},f)}}),T="https:"!==window.location.protocol?"http:":"https:",Y=e.TileLayer.extend({statics:{TILES:{Streets:{urlTemplate:T+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Street_Map"}},Topographic:{urlTemplate:T+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Topo_Map"}},Oceans:{urlTemplate:T+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/Ocean_Basemap"}},OceansLabels:{urlTemplate:T+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:y?"esri-labels":"tilePane",attribution:""}},NationalGeographic:{urlTemplate:T+"//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"National Geographic, DeLorme, HERE, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, increment P Corp."}},DarkGray:{urlTemplate:T+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, \x26copy; OpenStreetMap contributors"}},DarkGrayLabels:{urlTemplate:T+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:y?"esri-labels":"tilePane",attribution:""}},Gray:{urlTemplate:T+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, \x26copy; OpenStreetMap contributors"}},GrayLabels:{urlTemplate:T+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:y?"esri-labels":"tilePane",attribution:""}},Imagery:{urlTemplate:T+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}},ImageryLabels:{urlTemplate:T+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:y?"esri-labels":"tilePane",attribution:""}},ImageryTransportation:{urlTemplate:T+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:y?"esri-labels":"tilePane",attribution:""}},ShadedRelief:{urlTemplate:T+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS"}},ShadedReliefLabels:{urlTemplate:T+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:12,subdomains:["server","services"],pane:y?"esri-labels":"tilePane",attribution:""}},Terrain:{urlTemplate:T+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS, NOAA"}},TerrainLabels:{urlTemplate:T+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],pane:y?"esri-labels":"tilePane",attribution:""}},USATopo:{urlTemplate:T+"//{s}.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:15,subdomains:["server","services"],attribution:"USGS, National Geographic Society, i-cubed"}},ImageryClarity:{urlTemplate:T+"//clarity.maptiles.arcgis.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community"}},Physical:{urlTemplate:T+"//{s}.arcgisonline.com/arcgis/rest/services/World_Physical_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:8,subdomains:["server","services"],attribution:"U.S. National Park Service"}},ImageryFirefly:{urlTemplate:T+"//fly.maptiles.arcgis.com/arcgis/rest/services/World_Imagery_Firefly/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}}}},initialize:function(c,a){var f;if("object"==typeof c&&c.urlTemplate&&c.options)f=c;else{if("string"!=typeof c||!Y.TILES[c])throw Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Physical", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ImageryClarity", "ImageryFirefly", ShadedRelief", "ShadedReliefLabels", "Terrain", "TerrainLabels" or "USATopo"');f=Y.TILES[c]}var h=e.Util.extend(f.options,a);e.Util.setOptions(this,h);this.options.token&&-1===f.urlTemplate.indexOf("token\x3d")&&(f.urlTemplate+="?token\x3d"+this.options.token);e.TileLayer.prototype.initialize.call(this,f.urlTemplate,h)},onAdd:function(c){O(c);"esri-labels"===this.options.pane&&this._initPane();this.options.attributionUrl&&qa(this.options.attributionUrl,c);c.on("moveend",cb);e.TileLayer.prototype.onAdd.call(this,c)},onRemove:function(c){c.off("moveend",cb);e.TileLayer.prototype.onRemove.call(this,c)},_initPane:function(){if(!this._map.getPane(this.options.pane)){var c=this._map.createPane(this.options.pane);c.style.pointerEvents="none";c.style.zIndex=500}},getAttribution:function(){if(this.options.attribution)var c='\x3cspan class\x3d"esri-dynamic-attribution"\x3e'+this.options.attribution+"\x3c/span\x3e";return c}}),ua=e.TileLayer.extend({options:{zoomOffsetAllowance:.1,errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAA1BMVEUzNDVszlHHAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAAAAAAAAAB6mUWpAAAADZJREFUeJztwQEBAAAAgiD/r25IQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7waBAAABw08RwAAAAABJRU5ErkJggg\x3d\x3d"},statics:{MercatorZoomLevels:{0:156543.033928,1:78271.5169639999,2:39135.7584820001,3:19567.8792409999,4:9783.93962049996,5:4891.96981024998,6:2445.98490512499,7:1222.99245256249,8:611.49622628138,9:305.748113140558,10:152.874056570411,11:76.4370282850732,12:38.2185141425366,13:19.1092570712683,14:9.55462853563415,15:4.77731426794937,16:2.38865713397468,17:1.19432856685505,18:.597164283559817,19:.298582141647617,20:.14929107082381,21:.07464553541191,22:.0373227677059525,23:.0186613838529763}},initialize:function(c){c=J(c=e.Util.setOptions(this,c));this.tileUrl=(c.proxy?c.proxy+"?":"")+c.url+"tile/{z}/{y}/{x}"+(c.requestParams&&0<Object.keys(c.requestParams).length?e.Util.getParamString(c.requestParams):"");-1!==c.url.indexOf("{s}")&&c.subdomains&&(c.url=c.url.replace("{s}",c.subdomains[0]));this.service=Ja(c);this.service.addEventParent(this);(new RegExp(/tiles.arcgis(online)?\.com/g)).test(c.url)&&(this.tileUrl=this.tileUrl.replace("://tiles","://tiles{s}"),c.subdomains=["1","2","3","4"]);this.options.token&&(this.tileUrl+="?token\x3d"+this.options.token);e.TileLayer.prototype.initialize.call(this,this.tileUrl,c)},getTileUrl:function(c){var a=this._getZoomForUrl();return e.Util.template(this.tileUrl,e.Util.extend({s:this._getSubdomain(c),x:c.x,y:c.y,z:this._lodMap&&this._lodMap[a]?this._lodMap[a]:a},this.options))},createTile:function(c,a){var f=document.createElement("img");return e.DomEvent.on(f,"load",e.Util.bind(this._tileOnLoad,this,a,f)),e.DomEvent.on(f,"error",e.Util.bind(this._tileOnError,this,a,f)),this.options.crossOrigin&&(f.crossOrigin=""),f.alt="",!this._lodMap||this._lodMap&&this._lodMap[this._getZoomForUrl()]?f.src=this.getTileUrl(c):this.once("lodmap",function(){f.src=this.getTileUrl(c)},this),f},onAdd:function(c){O(c);this._lodMap||this.metadata(function(a,f){if(!a&&f.spatialReference){var h=f.spatialReference.latestWkid||f.spatialReference.wkid;if(!this.options.attribution&&c.attributionControl&&f.copyrightText&&(this.options.attribution=f.copyrightText,c.attributionControl.addAttribution(this.getAttribution())),c.options.crs!==e.CRS.EPSG3857||102100!==h&&3857!==h)c.options.crs&&c.options.crs.code&&-1<c.options.crs.code.indexOf(h)||U("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet http://esri.github.io/esri-leaflet/examples/non-mercator-projection.html");else{this._lodMap={};for(var h=f.tileInfo.lods,k=ua.MercatorZoomLevels,m=0;m<h.length;m++){var g=h[m],p;for(p in k)if(this._withinPercentage(g.resolution,k[p],this.options.zoomOffsetAllowance)){this._lodMap[p]=g.level;break}}this.fire("lodmap")}}},this);e.TileLayer.prototype.onAdd.call(this,c)},metadata:function(c,a){return this.service.metadata(c,a),this},identify:function(){return this.service.identify()},find:function(){return this.service.find()},query:function(){return this.service.query()},authenticate:function(c){var a="?token\x3d"+c;return this.tileUrl=this.options.token?this.tileUrl.replace(/\?token=(.+)/g,a):this.tileUrl+a,this.options.token=c,this.service.authenticate(c),this},_withinPercentage:function(c,a,f){return Math.abs(c/a-1)<f}}),oa=e.ImageOverlay.extend({onAdd:function(c){this._topLeft=c.getPixelBounds().min;e.ImageOverlay.prototype.onAdd.call(this,c)},_reset:function(){this._map.options.crs===e.CRS.EPSG3857?e.ImageOverlay.prototype._reset.call(this):e.DomUtil.setPosition(this._image,this._topLeft.subtract(this._map.getPixelOrigin()))}}),wa=e.Layer.extend({options:{opacity:1,position:"front",f:"image",useCors:wa,attribution:null,interactive:!1,alt:""},onAdd:function(c){O(c);this.options.zIndex&&(this.options.position=null);this._update=e.Util.throttle(this._update,this.options.updateInterval,this);c.on("moveend",this._update,this);this._currentImage&&this._currentImage._bounds.equals(this._map.getBounds())?c.addLayer(this._currentImage):this._currentImage&&(this._map.removeLayer(this._currentImage),this._currentImage=null);this._update();this._popup&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this));this.metadata(function(a,f){!a&&!this.options.attribution&&c.attributionControl&&f.copyrightText&&(this.options.attribution=f.copyrightText,c.attributionControl.addAttribution(this.getAttribution()))},this)},onRemove:function(c){this._currentImage&&this._map.removeLayer(this._currentImage);this._popup&&(this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this));this._map.off("moveend",this._update,this)},bindPopup:function(c,a){return this._shouldRenderPopup=!1,this._lastClick=!1,this._popup=e.popup(a),this._popupFunction=c,this._map&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this},unbindPopup:function(){return this._map&&(this._map.closePopup(this._popup),this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._popup=!1,this},bringToFront:function(){return this.options.position="front",this._currentImage&&(this._currentImage.bringToFront(),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this.options.position="back",this._currentImage&&(this._currentImage.bringToBack(),this._setAutoZIndex(Math.min)),this},setZIndex:function(c){return this.options.zIndex=c,this._currentImage&&this._currentImage.setZIndex(c),this},_setAutoZIndex:function(c){if(this._currentImage){for(var a,f=this._currentImage.getPane().children,e=-c(-1/0,1/0),h=0,k=f.length;h<k;h++)a=f[h].style.zIndex,f[h]!==this._currentImage._image&&a&&(e=c(e,+a));isFinite(e)&&(this.options.zIndex=e+c(-1,1),this.setZIndex(this.options.zIndex))}},getAttribution:function(){return this.options.attribution},getOpacity:function(){return this.options.opacity},setOpacity:function(c){return this.options.opacity=c,this._currentImage&&this._currentImage.setOpacity(c),this},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(c,a){return this.options.from=c,this.options.to=a,this._update(),this},metadata:function(c,a){return this.service.metadata(c,a),this},authenticate:function(c){return this.service.authenticate(c),this},redraw:function(){this._update()},_renderImage:function(c,a,f){if(this._map&&(f&&(c="data:"+f+";base64,"+c),c)){var e=(new oa(c,a,{opacity:0,crossOrigin:this.options.useCors,alt:this.options.alt,pane:this.options.pane||this.getPane(),interactive:this.options.interactive})).addTo(this._map),h=function(c){if(e.off("error",h,this),this._map){c=c.target;var f=this._currentImage;c._bounds.equals(a)&&c._bounds.equals(this._map.getBounds())?(this._currentImage=c,"front"===this.options.position?this.bringToFront():"back"===this.options.position&&this.bringToBack(),this.options.zIndex&&this.setZIndex(this.options.zIndex),this._map&&this._currentImage._map?this._currentImage.setOpacity(this.options.opacity):this._currentImage._map.removeLayer(this._currentImage),f&&this._map&&this._map.removeLayer(f),f&&f._map&&f._map.removeLayer(f)):this._map.removeLayer(c)}this.fire("load",{bounds:a})};e.once("error",function(){this._map.removeLayer(e);this.fire("error");e.off("load",h,this)},this);e.once("load",h,this);this.fire("loading",{bounds:a})}},_update:function(){if(this._map){var c=this._map.getZoom(),a=this._map.getBounds();this._animatingZoom||this._map._panTransition&&this._map._panTransition._inProgress||(c>this.options.maxZoom||c<this.options.minZoom?this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null):(c=this._buildExportParams(),e.Util.extend(c,this.options.requestParams),c?this._requestExport(c,a):this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null)))}},_renderPopup:function(c,a,f,h){(c=e.latLng(c),this._shouldRenderPopup&&this._lastClick.equals(c))&&(a=this._popupFunction(a,f,h))&&this._popup.setLatLng(c).setContent(a).openOn(this._map)},_resetPopupState:function(c){this._shouldRenderPopup=!1;this._lastClick=c.latlng},_calculateBbox:function(){var c=this._map.getPixelBounds(),a=this._map.unproject(c.getBottomLeft()),c=this._map.unproject(c.getTopRight()),c=this._map.options.crs.project(c),a=this._map.options.crs.project(a),a=e.bounds(c,a);return[a.getBottomLeft().x,a.getBottomLeft().y,a.getTopRight().x,a.getTopRight().y].join()},_calculateImageSize:function(){var c=this._map.getPixelBounds(),a=this._map.getSize(),f=this._map.unproject(c.getBottomLeft()),c=this._map.unproject(c.getTopRight()),c=this._map.latLngToLayerPoint(c).y,f=this._map.latLngToLayerPoint(f).y;return(0<c||f<a.y)&&(a.y=f-c),a.x+","+a.y}}),C=wa.extend({options:{updateInterval:150,format:"jpgpng",transparent:!0,f:"image"},query:function(){return this.service.query()},identify:function(){return this.service.identify()},initialize:function(c){c=J(c);this.service=x(c);this.service.addEventParent(this);e.Util.setOptions(this,c)},setPixelType:function(c){return this.options.pixelType=c,this._update(),this},getPixelType:function(){return this.options.pixelType},setBandIds:function(c){return e.Util.isArray(c)?this.options.bandIds=c.join(","):this.options.bandIds=c.toString(),this._update(),this},getBandIds:function(){return this.options.bandIds},setNoData:function(c,a){return e.Util.isArray(c)?this.options.noData=c.join(","):this.options.noData=c.toString(),a&&(this.options.noDataInterpretation=a),this._update(),this},getNoData:function(){return this.options.noData},getNoDataInterpretation:function(){return this.options.noDataInterpretation},setRenderingRule:function(c){this.options.renderingRule=c;this._update()},getRenderingRule:function(){return this.options.renderingRule},setMosaicRule:function(c){this.options.mosaicRule=c;this._update()},getMosaicRule:function(){return this.options.mosaicRule},_getPopupData:function(c){var a=e.Util.bind(function(a,f,h){a||setTimeout(e.Util.bind(function(){this._renderPopup(c.latlng,a,f,h)},this),300)},this),f=this.identify().at(c.latlng);this.options.mosaicRule&&f.setMosaicRule(this.options.mosaicRule);f.run(a);this._shouldRenderPopup=!0;this._lastClick=c.latlng},_buildExportParams:function(){var c=parseInt(this._map.options.crs.code.split(":")[1],10),c={bbox:this._calculateBbox(),size:this._calculateImageSize(),format:this.options.format,transparent:this.options.transparent,bboxSR:c,imageSR:c};return this.options.from&&this.options.to&&(c.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.options.pixelType&&(c.pixelType=this.options.pixelType),this.options.interpolation&&(c.interpolation=this.options.interpolation),this.options.compressionQuality&&(c.compressionQuality=this.options.compressionQuality),this.options.bandIds&&(c.bandIds=this.options.bandIds),(0===this.options.noData||this.options.noData)&&(c.noData=this.options.noData),this.options.noDataInterpretation&&(c.noDataInterpretation=this.options.noDataInterpretation),this.service.options.token&&(c.token=this.service.options.token),this.options.renderingRule&&(c.renderingRule=JSON.stringify(this.options.renderingRule)),this.options.mosaicRule&&(c.mosaicRule=JSON.stringify(this.options.mosaicRule)),c},_requestExport:function(c,a){"json"===this.options.f?this.service.request("exportImage",c,function(c,f){c||(this.options.token&&(f.href+="?token\x3d"+this.options.token),this.options.proxy&&(f.href=this.options.proxy+"?"+f.href),this._renderImage(f.href,a))},this):(c.f="image",this._renderImage(this.options.url+"exportImage"+e.Util.getParamString(c),a))}}),ha=wa.extend({options:{updateInterval:150,layers:!1,layerDefs:!1,timeOptions:!1,format:"png24",transparent:!0,f:"json"},initialize:function(c){c=J(c);this.service=Ja(c);this.service.addEventParent(this);(c.proxy||c.token)&&"json"!==c.f&&(c.f="json");e.Util.setOptions(this,c)},getDynamicLayers:function(){return this.options.dynamicLayers},setDynamicLayers:function(c){return this.options.dynamicLayers=c,this._update(),this},getLayers:function(){return this.options.layers},setLayers:function(c){return this.options.layers=c,this._update(),this},getLayerDefs:function(){return this.options.layerDefs},setLayerDefs:function(c){return this.options.layerDefs=c,this._update(),this},getTimeOptions:function(){return this.options.timeOptions},setTimeOptions:function(c){return this.options.timeOptions=c,this._update(),this},query:function(){return this.service.query()},identify:function(){return this.service.identify()},find:function(){return this.service.find()},_getPopupData:function(c){var a,f=e.Util.bind(function(a,f,h){a||setTimeout(e.Util.bind(function(){this._renderPopup(c.latlng,a,f,h)},this),300)},this);if((a=this.options.popup?this.options.popup.on(this._map).at(c.latlng):this.identify().on(this._map).at(c.latlng)).params.maxAllowableOffset||a.simplify(this._map,.5),this.options.popup&&this.options.popup.params&&this.options.popup.params.layers||(this.options.layers?a.layers("visible:"+this.options.layers.join(",")):a.layers("visible")),this.options.layerDefs&&"string"!=typeof this.options.layerDefs&&!a.params.layerDefs)for(var h in this.options.layerDefs)this.options.layerDefs.hasOwnProperty(h)&&a.layerDef(h,this.options.layerDefs[h]);a.run(f);this._shouldRenderPopup=!0;this._lastClick=c.latlng},_buildExportParams:function(){var c=parseInt(this._map.options.crs.code.split(":")[1],10),c={bbox:this._calculateBbox(),size:this._calculateImageSize(),dpi:96,format:this.options.format,transparent:this.options.transparent,bboxSR:c,imageSR:c};if(this.options.dynamicLayers&&(c.dynamicLayers=this.options.dynamicLayers),this.options.layers){if(0===this.options.layers.length)return;c.layers="show:"+this.options.layers.join(",")}return this.options.layerDefs&&(c.layerDefs="string"==typeof this.options.layerDefs?this.options.layerDefs:JSON.stringify(this.options.layerDefs)),this.options.timeOptions&&(c.timeOptions=JSON.stringify(this.options.timeOptions)),this.options.from&&this.options.to&&(c.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.service.options.token&&(c.token=this.service.options.token),this.options.proxy&&(c.proxy=this.options.proxy),this.options.disableCache&&(c._ts=Date.now()),c},_requestExport:function(c,a){"json"===this.options.f?this.service.request("export",c,function(c,f){c||(this.options.token&&(f.href+="?token\x3d"+this.options.token),this.options.proxy&&(f.href=this.options.proxy+"?"+f.href),f.href?this._renderImage(f.href,a):this._renderImage(f.imageData,a,f.contentType))},this):(c.f="image",this._renderImage(this.options.url+"export"+e.Util.getParamString(c),a))}}),va=e.Layer.extend({options:{cellSize:512,updateInterval:150},initialize:function(c){e.setOptions(this,c);this._zooming=!1},onAdd:function(c){this._map=c;this._update=e.Util.throttle(this._update,this.options.updateInterval,this);this._reset();this._update()},onRemove:function(){this._map.removeEventListener(this.getEvents(),this);this._removeCells()},getEvents:function(){return{moveend:this._update,zoomstart:this._zoomstart,zoomend:this._reset}},addTo:function(c){return c.addLayer(this),this},removeFrom:function(c){return c.removeLayer(this),this},_zoomstart:function(){this._zooming=!0},_reset:function(){this._removeCells();this._cells={};this._activeCells={};this._cellsTotal=this._cellsToLoad=0;this._cellNumBounds=this._getCellNumBounds();this._resetWrap();this._zooming=!1},_resetWrap:function(){var c=this._map,a=c.options.crs;if(!a.infinite){var f=this._getCellSize();a.wrapLng&&(this._wrapLng=[Math.floor(c.project([0,a.wrapLng[0]]).x/f),Math.ceil(c.project([0,a.wrapLng[1]]).x/f)]);a.wrapLat&&(this._wrapLat=[Math.floor(c.project([a.wrapLat[0],0]).y/f),Math.ceil(c.project([a.wrapLat[1],0]).y/f)])}},_getCellSize:function(){return this.options.cellSize},_update:function(){if(this._map){var c=this._map.getPixelBounds(),a=this._getCellSize(),c=e.bounds(c.min.divideBy(a).floor(),c.max.divideBy(a).floor());this._removeOtherCells(c);this._addCells(c);this.fire("cellsupdated")}},_addCells:function(c){var a,f,h,k=[],m=c.getCenter(),g=this._map.getZoom();for(a=c.min.y;a<=c.max.y;a++)for(f=c.min.x;f<=c.max.x;f++)(h=e.point(f,a)).z=g,this._isValidCell(h)&&k.push(h);c=k.length;if(0!==c)for(this._cellsToLoad+=c,this._cellsTotal+=c,k.sort(function(c,a){return c.distanceTo(m)-a.distanceTo(m)}),f=0;f<c;f++)this._addCell(k[f])},_isValidCell:function(c){var a=this._map.options.crs;if(!a.infinite){var f=this._cellNumBounds;if(!a.wrapLng&&(c.x<f.min.x||c.x>f.max.x)||!a.wrapLat&&(c.y<f.min.y||c.y>f.max.y))return!1}if(!this.options.bounds)return!0;c=this._cellCoordsToBounds(c);return e.latLngBounds(this.options.bounds).intersects(c)},_cellCoordsToBounds:function(c){var a=this._map,f=this.options.cellSize,h=c.multiplyBy(f),f=h.add([f,f]),h=a.wrapLatLng(a.unproject(h,c.z));c=a.wrapLatLng(a.unproject(f,c.z));return e.latLngBounds(h,c)},_cellCoordsToKey:function(c){return c.x+":"+c.y},_keyToCellCoords:function(c){var a=c.split(":");c=parseInt(a[0],10);a=parseInt(a[1],10);return e.point(c,a)},_removeOtherCells:function(c){for(var a in this._cells)c.contains(this._keyToCellCoords(a))||this._removeCell(a)},_removeCell:function(c){var a=this._activeCells[c];a&&(delete this._activeCells[c],this.cellLeave&&this.cellLeave(a.bounds,a.coords),this.fire("cellleave",{bounds:a.bounds,coords:a.coords}))},_removeCells:function(){for(var c in this._cells){var a=this._cells[c].bounds,f=this._cells[c].coords;this.cellLeave&&this.cellLeave(a,f);this.fire("cellleave",{bounds:a,coords:f})}},_addCell:function(c){this._wrapCoords(c);var a=this._cellCoordsToKey(c),f=this._cells[a];f&&!this._activeCells[a]&&(this.cellEnter&&this.cellEnter(f.bounds,c),this.fire("cellenter",{bounds:f.bounds,coords:c}),this._activeCells[a]=f);f||(f={coords:c,bounds:this._cellCoordsToBounds(c)},this._cells[a]=f,this._activeCells[a]=f,this.createCell&&this.createCell(f.bounds,c),this.fire("cellcreate",{bounds:f.bounds,coords:c}))},_wrapCoords:function(c){c.x=this._wrapLng?e.Util.wrapNum(c.x,this._wrapLng):c.x;c.y=this._wrapLat?e.Util.wrapNum(c.y,this._wrapLat):c.y},_getCellNumBounds:function(){var c=this._map.getPixelWorldBounds(),a=this._getCellSize();return c?e.bounds(c.min.divideBy(a).floor(),c.max.divideBy(a).ceil().subtract([1,1])):null}});xa.prototype.query=function(c){c=this.getIndex(c);return this.values[c]};xa.prototype.getIndex=function(c){this.dirty&&this.sort();for(var a,f,e=0,h=this.values.length-1;e<=h;)if(a=(e+h)/2|0,+(f=this.values[Math.round(a)]).value<+c)e=a+1;else{if(!(+f.value>+c))return a;h=a-1}return Math.abs(~h)};xa.prototype.between=function(c,a){var f=this.getIndex(c),e=this.getIndex(a);if(0===f&&0===e)return[];for(;this.values[f-1]&&this.values[f-1].value===c;)f--;for(;this.values[e+1]&&this.values[e+1].value===a;)e++;return this.values[e]&&this.values[e].value===a&&this.values[e+1]&&e++,this.values.slice(f,e)};xa.prototype.insert=function(c){return this.values.splice(this.getIndex(c.value),0,c),this};xa.prototype.bulkAdd=function(c,a){return this.values=this.values.concat([].concat(c||[])),a?this.sort():this.dirty=!0,this};xa.prototype.sort=function(){return this.values.sort(function(c,a){return+a.value-+c.value}).reverse(),this.dirty=!1,this};var db=va.extend({options:{attribution:null,where:"1\x3d1",fields:["*"],from:!1,to:!1,timeField:!1,timeFilterMode:"server",simplifyFactor:0,precision:6},initialize:function(c){if(va.prototype.initialize.call(this,c),c=J(c),c=e.Util.setOptions(this,c),this.service=Kb(c),this.service.addEventParent(this),"*"!==this.options.fields[0]){c=!1;for(var a=0;a<this.options.fields.length;a++)this.options.fields[a].match(/^(OBJECTID|FID|OID|ID)$/i)&&(c=!0);!1===c&&U("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")}this.options.timeField.start&&this.options.timeField.end?(this._startTimeIndex=new xa,this._endTimeIndex=new xa):this.options.timeField&&(this._timeIndex=new xa);this._cache={};this._currentSnapshot=[];this._activeRequests=0},onAdd:function(c){return O(c),this.service.metadata(function(a,f){if(!a){var e=f.supportedQueryFormats,h=!1;!1===this.service.options.isModern&&(h=!0);!h&&e&&-1!==e.indexOf("geoJSON")&&(this.service.options.isModern=!0);f.objectIdField&&(this.service.options.idAttribute=f.objectIdField);!this.options.attribution&&c.attributionControl&&f.copyrightText&&(this.options.attribution=f.copyrightText,c.attributionControl.addAttribution(this.getAttribution()))}},this),c.on("zoomend",this._handleZoomChange,this),va.prototype.onAdd.call(this,c)},onRemove:function(c){return c.off("zoomend",this._handleZoomChange,this),va.prototype.onRemove.call(this,c)},getAttribution:function(){return this.options.attribution},createCell:function(c,a){this._visibleZoom()&&this._requestFeatures(c,a)},_requestFeatures:function(c,a,f){return this._activeRequests++,1===this._activeRequests&&this.fire("loading",{bounds:c},!0),this._buildQuery(c).run(function(h,k,m){m&&m.exceededTransferLimit&&this.fire("drawlimitexceeded");!h&&k&&k.features.length&&e.Util.requestAnimFrame(e.Util.bind(function(){this._addFeatures(k.features,a);this._postProcessFeatures(c)},this));h||!k||k.features.length||this._postProcessFeatures(c);h&&this._postProcessFeatures(c);f&&f.call(this,h,k)},this)},_postProcessFeatures:function(c){this._activeRequests--;0>=this._activeRequests&&this.fire("load",{bounds:c})},_cacheKey:function(c){return c.z+":"+c.x+":"+c.y},_addFeatures:function(c,a){var f=this._cacheKey(a);this._cache[f]=this._cache[f]||[];for(var e=c.length-1;0<=e;e--){var h=c[e].id;-1===this._currentSnapshot.indexOf(h)&&this._currentSnapshot.push(h);-1===this._cache[f].indexOf(h)&&this._cache[f].push(h)}this.options.timeField&&this._buildTimeIndexes(c);this.createLayers(c)},_buildQuery:function(c){c=this.service.query().intersects(c).where(this.options.where).fields(this.options.fields).precision(this.options.precision);return this.options.requestParams&&e.Util.extend(c.params,this.options.requestParams),this.options.simplifyFactor&&c.simplify(this._map,this.options.simplifyFactor),"server"===this.options.timeFilterMode&&this.options.from&&this.options.to&&c.between(this.options.from,this.options.to),c},setWhere:function(c,a,f){this.options.where=c&&c.length?c:"1\x3d1";var h=[],k=[],m=0,g=null;c=e.Util.bind(function(c,p){if(c&&(g=c),p)for(var q=p.features.length-1;0<=q;q--)k.push(p.features[q].id);0>=--m&&this._visibleZoom()&&(this._currentSnapshot=k,e.Util.requestAnimFrame(e.Util.bind(function(){this.removeLayers(h);this.addLayers(k);a&&a.call(f,g)},this)))},this);for(var p=this._currentSnapshot.length-1;0<=p;p--)h.push(this._currentSnapshot[p]);for(var q in this._activeCells)m++,p=this._keyToCellCoords(q),p=this._cellCoordsToBounds(p),this._requestFeatures(p,q,c);return this},getWhere:function(){return this.options.where},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(c,a,f,h){var k=this.options.from,m=this.options.to,g=0,p=null,q=e.Util.bind(function(e){e&&(p=e);this._filterExistingFeatures(k,m,c,a);g--;f&&0>=g&&f.call(h,p)},this);if(this.options.from=c,this.options.to=a,this._filterExistingFeatures(k,m,c,a),"server"===this.options.timeFilterMode)for(var u in this._activeCells){g++;var D=this._keyToCellCoords(u),D=this._cellCoordsToBounds(D);this._requestFeatures(D,u,q)}return this},refresh:function(){for(var c in this._activeCells){var a=this._keyToCellCoords(c),a=this._cellCoordsToBounds(a);this._requestFeatures(a,c)}this.redraw&&this.once("load",function(){this.eachFeature(function(c){this._redraw(c.feature.id)},this)},this)},_filterExistingFeatures:function(c,a,f,h){var k=c&&a?this._getFeaturesInTimeRange(c,a):this._currentSnapshot,m=this._getFeaturesInTimeRange(f,h);if(m.indexOf)for(c=0;c<m.length;c++)a=k.indexOf(m[c]),0<=a&&k.splice(a,1);e.Util.requestAnimFrame(e.Util.bind(function(){this.removeLayers(k);this.addLayers(m)},this))},_getFeaturesInTimeRange:function(a,f){var c,e=[];if(this.options.timeField.start&&this.options.timeField.end){c=this._startTimeIndex.between(a,f);var h=this._endTimeIndex.between(a,f);c=c.concat(h)}else c=this._timeIndex.between(a,f);for(h=c.length-1;0<=h;h--)e.push(c[h].id);return e},_buildTimeIndexes:function(a){var c,f;if(this.options.timeField.start&&this.options.timeField.end){var e=[],h=[];for(c=a.length-1;0<=c;c--)f=a[c],e.push({id:f.id,value:new Date(f.properties[this.options.timeField.start])}),h.push({id:f.id,value:new Date(f.properties[this.options.timeField.end])});this._startTimeIndex.bulkAdd(e);this._endTimeIndex.bulkAdd(h)}else{e=[];for(c=a.length-1;0<=c;c--)f=a[c],e.push({id:f.id,value:new Date(f.properties[this.options.timeField])});this._timeIndex.bulkAdd(e)}},_featureWithinTimeRange:function(a){if(!this.options.from||!this.options.to)return!0;var c=+this.options.from.valueOf(),f=+this.options.to.valueOf();if("string"==typeof this.options.timeField){var e=+a.properties[this.options.timeField];return e>=c&&e<=f}if(this.options.timeField.start&&this.options.timeField.end)return e=+a.properties[this.options.timeField.start],a=+a.properties[this.options.timeField.end],e>=c&&e<=f||a>=c&&a<=f},_visibleZoom:function(){if(!this._map)return!1;var a=this._map.getZoom();return!(a>this.options.maxZoom||a<this.options.minZoom)},_handleZoomChange:function(){if(this._visibleZoom())for(var a in this._activeCells){var f=this._cacheKey(this._activeCells[a].coords);this._cache[f]&&this.addLayers(this._cache[f])}else this.removeLayers(this._currentSnapshot),this._currentSnapshot=[]},authenticate:function(a){return this.service.authenticate(a),this},metadata:function(a,f){return this.service.metadata(a,f),this},query:function(){return this.service.query()},_getMetadata:function(a){this._metadata?a(void 0,this._metadata):this.metadata(e.Util.bind(function(c,f){this._metadata=f;a(c,this._metadata)},this))},addFeature:function(a,f,e){this.addFeatures(a,f,e)},addFeatures:function(a,f,h){this._getMetadata(e.Util.bind(function(c,k){if(c)f&&f.call(this,c,null);else{var m=a.features?a.features:[a];this.service.addFeatures(a,e.Util.bind(function(a,c){if(!a){for(var e=m.length-1;0<=e;e--)m[e].properties[k.objectIdField]=1<m.length?c[e].objectId:c.objectId,m[e].id=1<m.length?c[e].objectId:c.objectId;this.createLayers(m)}f&&f.call(h,a,c)},this))}},this))},updateFeature:function(a,f,e){this.updateFeatures(a,f,e)},updateFeatures:function(a,f,e){var c=a.features?a.features:[a];this.service.updateFeatures(a,function(a,h){if(!a){for(var k=c.length-1;0<=k;k--)this.removeLayers([c[k].id],!0);this.createLayers(c)}f&&f.call(e,a,h)},this)},deleteFeature:function(a,f,e){this.deleteFeatures(a,f,e)},deleteFeatures:function(a,f,e){return this.service.deleteFeatures(a,function(a,c){var h=c.length?c:[c];if(!a&&0<h.length)for(var k=h.length-1;0<=k;k--)this.removeLayers([h[k].objectId],!0);f&&f.call(e,a,c)},this)}}),Ma=db.extend({options:{cacheLayers:!0},initialize:function(a){db.prototype.initialize.call(this,a);this._originalStyle=this.options.style;this._layers={}},onRemove:function(a){for(var c in this._layers)a.removeLayer(this._layers[c]),this.fire("removefeature",{feature:this._layers[c].feature,permanent:!1},!0);return db.prototype.onRemove.call(this,a)},createNewLayer:function(a){a=e.GeoJSON.geometryToLayer(a,this.options);return a&&(a.defaultOptions=a.options),a},_updateLayer:function(a,f){var c;c=this.options.coordsToLatLng||e.GeoJSON.coordsToLatLng;switch(f.properties&&(a.feature.properties=f.properties),f.geometry.type){case "Point":c=e.GeoJSON.coordsToLatLng(f.geometry.coordinates);a.setLatLng(c);break;case "LineString":c=e.GeoJSON.coordsToLatLngs(f.geometry.coordinates,0,c);a.setLatLngs(c);break;case "MultiLineString":case "Polygon":c=e.GeoJSON.coordsToLatLngs(f.geometry.coordinates,1,c);a.setLatLngs(c);break;case "MultiPolygon":c=e.GeoJSON.coordsToLatLngs(f.geometry.coordinates,2,c),a.setLatLngs(c)}},createLayers:function(a){for(var c=a.length-1;0<=c;c--){var f,e=a[c],h=this._layers[e.id];this._visibleZoom()&&h&&!this._map.hasLayer(h)&&(this._map.addLayer(h),this.fire("addfeature",{feature:h.feature},!0));h&&0<this.options.simplifyFactor&&(h.setLatLngs||h.setLatLng)&&this._updateLayer(h,e);h||((f=this.createNewLayer(e))?(f.feature=e,f.addEventParent(this),this.options.onEachFeature&&this.options.onEachFeature(f.feature,f),this._layers[f.feature.id]=f,this.setFeatureStyle(f.feature.id,this.options.style),this.fire("createfeature",{feature:f.feature},!0),this._visibleZoom()&&(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(e))&&this._map.addLayer(f)):U("invalid GeoJSON encountered"))}},addLayers:function(a){for(var c=a.length-1;0<=c;c--){var f=this._layers[a[c]];f&&this._map.addLayer(f)}},removeLayers:function(a,f){for(var c=a.length-1;0<=c;c--){var e=a[c],h=this._layers[e];h&&(this.fire("removefeature",{feature:h.feature,permanent:f},!0),this._map.removeLayer(h));h&&f&&delete this._layers[e]}},cellEnter:function(a,f){this._visibleZoom()&&!this._zooming&&this._map&&e.Util.requestAnimFrame(e.Util.bind(function(){var a=this._cacheKey(f),c=this._cellCoordsToKey(f),a=this._cache[a];this._activeCells[c]&&a&&this.addLayers(a)},this))},cellLeave:function(a,f){this._zooming||e.Util.requestAnimFrame(e.Util.bind(function(){if(this._map){var a=this._cacheKey(f),c=this._cellCoordsToKey(f),e=this._cache[a],h=this._map.getBounds();if(!this._activeCells[c]&&e){for(var k=!0,m=0;m<e.length;m++){var g=this._layers[e[m]];g&&g.getBounds&&h.intersects(g.getBounds())&&(k=!1)}k&&this.removeLayers(e,!this.options.cacheLayers);!this.options.cacheLayers&&k&&(delete this._cache[a],delete this._cells[c],delete this._activeCells[c])}}},this))},resetStyle:function(){return this.options.style=this._originalStyle,this.eachFeature(function(a){this.resetFeatureStyle(a.feature.id)},this),this},setStyle:function(a){return this.options.style=a,this.eachFeature(function(c){this.setFeatureStyle(c.feature.id,a)},this),this},resetFeatureStyle:function(a){var c=this._layers[a],f=this._originalStyle||e.Path.prototype.options;return c&&(e.Util.extend(c.options,c.defaultOptions),this.setFeatureStyle(a,f)),this},setFeatureStyle:function(a,f){var c=this._layers[a];return"function"==typeof f&&(f=f(c.feature)),c.setStyle&&c.setStyle(f),this},eachActiveFeature:function(a,f){if(this._map){var c=this._map.getBounds(),e;for(e in this._layers)-1!==this._currentSnapshot.indexOf(this._layers[e].feature.id)&&("function"==typeof this._layers[e].getLatLng&&c.contains(this._layers[e].getLatLng())?a.call(f,this._layers[e]):"function"==typeof this._layers[e].getBounds&&c.intersects(this._layers[e].getBounds())&&a.call(f,this._layers[e]))}return this},eachFeature:function(a,f){for(var c in this._layers)a.call(f,this._layers[c]);return this},getFeature:function(a){return this._layers[a]},bringToBack:function(){this.eachFeature(function(a){a.bringToBack&&a.bringToBack()})},bringToFront:function(){this.eachFeature(function(a){a.bringToFront&&a.bringToFront()})},redraw:function(a){return a&&this._redraw(a),this},_redraw:function(a){a=this._layers[a];var c=a.feature;if(a&&a.setIcon&&this.options.pointToLayer&&this.options.pointToLayer){var f=this.options.pointToLayer(c,e.latLng(c.geometry.coordinates[1],c.geometry.coordinates[0])).options.icon;a.setIcon(f)}a&&a.setStyle&&this.options.pointToLayer&&(f=this.options.pointToLayer(c,e.latLng(c.geometry.coordinates[1],c.geometry.coordinates[0])).options,this.setFeatureStyle(c.id,f));a&&a.setStyle&&this.options.style&&this.resetStyle(c.id)}});a.VERSION="2.2.3";a.Support=aa;a.options=ya;a.Util=W;a.get=La;a.post=m;a.request=h;a.Task=Ea;a.task=function(a){return a=J(a),new Ea(a)};a.Query=Aa;a.query=ra;a.Find=ta;a.find=da;a.Identify=Sa;a.identify=function(a){return new Sa(a)};a.IdentifyFeatures=G;a.identifyFeatures=Jb;a.IdentifyImage=X;a.identifyImage=jb;a.Service=za;a.service=function(a){return a=J(a),new za(a)};a.MapService=Ta;a.mapService=Ja;a.ImageService=ga;a.imageService=x;a.FeatureLayerService=Ua;a.featureLayerService=Kb;a.BasemapLayer=Y;a.basemapLayer=function(a,f){return new Y(a,f)};a.TiledMapLayer=ua;a.tiledMapLayer=function(a,f){return new ua(a,f)};a.RasterLayer=wa;a.ImageMapLayer=C;a.imageMapLayer=function(a,f){return new C(a,f)};a.DynamicMapLayer=ha;a.dynamicMapLayer=function(a,f){return new ha(a,f)};a.FeatureManager=db;a.FeatureLayer=Ma;a.featureLayer=function(a){return new Ma(a)};Object.defineProperty(a,"__esModule",{value:!0})});!function(a,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((a.Leaflet=a.Leaflet||{},a.Leaflet.markercluster=a.Leaflet.markercluster||{}))}(this,function(a){var e=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(a){L.Util.setOptions(this,a);this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction);this._featureGroup=L.featureGroup();this._featureGroup.addEventParent(this);this._nonPointGroup=L.featureGroup();this._nonPointGroup.addEventParent(this);this._inZoomAnimation=0;this._needsClustering=[];this._needsRemoving=[];this._currentShownBounds=null;this._queue=[];this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};a=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,a?this._withAnimation:this._noAnimation);this._markerCluster=a?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(a){if(a instanceof L.LayerGroup)return this.addLayers([a]);if(!a.getLatLng)return this._nonPointGroup.addLayer(a),this.fire("layeradd",{layer:a}),this;if(!this._map)return this._needsClustering.push(a),this.fire("layeradd",{layer:a}),this;if(this.hasLayer(a))return this;this._unspiderfy&&this._unspiderfy();this._addLayer(a,this._maxZoom);this.fire("layeradd",{layer:a});this._topClusterLevel._recalculateBounds();this._refreshClustersIcons();var f=a,e=this._zoom;if(a.__parent)for(;f.__parent._zoom>=e;)f=f.__parent;return this._currentShownBounds.contains(f.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(a,f):this._animationAddLayerNonAnimated(a,f)),this},removeLayer:function(a){return a instanceof L.LayerGroup?this.removeLayers([a]):a.getLatLng?this._map?a.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(a)),this._removeLayer(a,!0),this.fire("layerremove",{layer:a}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),a.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(a)&&(this._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,a)&&this.hasLayer(a)&&this._needsRemoving.push({layer:a,latlng:a._latlng}),this.fire("layerremove",{layer:a}),this):(this._nonPointGroup.removeLayer(a),this.fire("layerremove",{layer:a}),this)},addLayers:function(a,e){if(!L.Util.isArray(a))return this.addLayer(a);var f,h=this._featureGroup,m=this._nonPointGroup,g=this.options.chunkedLoading,u=this.options.chunkInterval,v=this.options.chunkProgress,z=a.length,w=0,F=!0;if(this._map){var E=(new Date).getTime(),H=L.bind(function(){for(var k=(new Date).getTime();z>w&&!(g&&0===w%200&&(new Date).getTime()-k>u);w++)if(f=a[w],f instanceof L.LayerGroup)F&&(a=a.slice(),F=!1),this._extractNonGroupLayers(f,a),z=a.length;else if(f.getLatLng){if(!this.hasLayer(f)&&(this._addLayer(f,this._maxZoom),e||this.fire("layeradd",{layer:f}),f.__parent&&2===f.__parent.getChildCount())){var p=f.__parent.getAllChildMarkers();h.removeLayer(p[0]===f?p[1]:p[0])}}else m.addLayer(f),e||this.fire("layeradd",{layer:f});v&&v(w,z,(new Date).getTime()-E);w===z?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(H,this.options.chunkDelay)},this);H()}else for(var P=this._needsClustering;z>w;w++)f=a[w],f instanceof L.LayerGroup?(F&&(a=a.slice(),F=!1),this._extractNonGroupLayers(f,a),z=a.length):f.getLatLng?this.hasLayer(f)||P.push(f):m.addLayer(f);return this},removeLayers:function(a){var f,e,h=a.length,g=this._featureGroup,p=this._nonPointGroup,u=!0;if(!this._map){for(f=0;h>f;f++)e=a[f],e instanceof L.LayerGroup?(u&&(a=a.slice(),u=!1),this._extractNonGroupLayers(e,a),h=a.length):(this._arraySplice(this._needsClustering,e),p.removeLayer(e),this.hasLayer(e)&&this._needsRemoving.push({layer:e,latlng:e._latlng}),this.fire("layerremove",{layer:e}));return this}if(this._unspiderfy){this._unspiderfy();var v=a.slice(),z=h;for(f=0;z>f;f++)e=v[f],e instanceof L.LayerGroup?(this._extractNonGroupLayers(e,v),z=v.length):this._unspiderfyLayer(e)}for(f=0;h>f;f++)e=a[f],e instanceof L.LayerGroup?(u&&(a=a.slice(),u=!1),this._extractNonGroupLayers(e,a),h=a.length):e.__parent?(this._removeLayer(e,!0,!0),this.fire("layerremove",{layer:e}),g.hasLayer(e)&&(g.removeLayer(e),e.clusterShow&&e.clusterShow())):(p.removeLayer(e),this.fire("layerremove",{layer:e}));return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(a){a.off(this._childMarkerEventHandlers,this);delete a.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var a=new L.LatLngBounds;this._topClusterLevel&&a.extend(this._topClusterLevel._bounds);for(var e=this._needsClustering.length-1;0<=e;e--)a.extend(this._needsClustering[e].getLatLng());return a.extend(this._nonPointGroup.getBounds()),a},eachLayer:function(a,e){var f,h,m,g=this._needsClustering.slice(),u=this._needsRemoving;this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(g);for(h=g.length-1;0<=h;h--){f=!0;for(m=u.length-1;0<=m;m--)if(u[m].layer===g[h]){f=!1;break}f&&a.call(e,g[h])}this._nonPointGroup.eachLayer(a,e)},getLayers:function(){var a=[];return this.eachLayer(function(f){a.push(f)}),a},getLayer:function(a){var f=null;return a=parseInt(a,10),this.eachLayer(function(e){L.stamp(e)===a&&(f=e)}),f},hasLayer:function(a){if(!a)return!1;var f,e=this._needsClustering;for(f=e.length-1;0<=f;f--)if(e[f]===a)return!0;e=this._needsRemoving;for(f=e.length-1;0<=f;f--)if(e[f].layer===a)return!1;return!(!a.__parent||a.__parent._group!==this)||this._nonPointGroup.hasLayer(a)},zoomToShowLayer:function(a,e){"function"!=typeof e&&(e=function(){});var f=function(){!a._icon&&!a.__parent._icon||this._inZoomAnimation||(this._map.off("moveend",f,this),this.off("animationend",f,this),a._icon?e():a.__parent._icon&&(this.once("spiderfied",e,this),a.__parent.spiderfy()))};a._icon&&this._map.getBounds().contains(a.getLatLng())?e():a.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",f,this),this._map.panTo(a.getLatLng())):(this._map.on("moveend",f,this),this.on("animationend",f,this),a.__parent.zoomToBounds())},onAdd:function(a){this._map=a;var f,e;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";this._featureGroup.addTo(a);this._nonPointGroup.addTo(a);this._gridClusters||this._generateInitialClusters();this._maxLat=a.options.crs.projection.MAX_LATITUDE;a=0;for(f=this._needsRemoving.length;f>a;a++)e=this._needsRemoving[a],e.newlatlng=e.layer._latlng,e.layer._latlng=e.latlng;a=0;for(f=this._needsRemoving.length;f>a;a++)e=this._needsRemoving[a],this._removeLayer(e.layer,!0),e.layer._latlng=e.newlatlng;this._needsRemoving=[];this._zoom=Math.round(this._map._zoom);this._currentShownBounds=this._getExpandedVisibleBounds();this._map.on("zoomend",this._zoomEnd,this);this._map.on("moveend",this._moveEnd,this);this._spiderfierOnAdd&&this._spiderfierOnAdd();this._bindEvents();f=this._needsClustering;this._needsClustering=[];this.addLayers(f,!0)},onRemove:function(a){a.off("zoomend",this._zoomEnd,this);a.off("moveend",this._moveEnd,this);this._unbindEvents();this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","");this._spiderfierOnRemove&&this._spiderfierOnRemove();delete this._maxLat;this._hideCoverage();this._featureGroup.remove();this._nonPointGroup.remove();this._featureGroup.clearLayers();this._map=null},getVisibleParent:function(a){for(;a&&!a._icon;)a=a.__parent;return a||null},_arraySplice:function(a,e){for(var f=a.length-1;0<=f;f--)if(a[f]===e)return a.splice(f,1),!0},_removeFromGridUnclustered:function(a,e){for(var f=this._map,h=this._gridUnclustered,m=Math.floor(this._map.getMinZoom());e>=m&&h[e].removeObject(a,f.project(a.getLatLng(),e));e--);},_childMarkerDragStart:function(a){a.target.__dragStart=a.target._latlng},_childMarkerMoved:function(a){if(!this._ignoreMove&&!a.target.__dragStart){var f=a.target._popup&&a.target._popup.isOpen();this._moveChild(a.target,a.oldLatLng,a.latlng);f&&a.target.openPopup()}},_moveChild:function(a,e,k){a._latlng=e;this.removeLayer(a);a._latlng=k;this.addLayer(a)},_childMarkerDragEnd:function(a){var f=a.target.__dragStart;delete a.target.__dragStart;f&&this._moveChild(a.target,f,a.target._latlng)},_removeLayer:function(a,e,k){var f=this._gridClusters,m=this._gridUnclustered,g=this._featureGroup,u=this._map,v=Math.floor(this._map.getMinZoom());e&&this._removeFromGridUnclustered(a,this._maxZoom);var z,w=a.__parent;for(this._arraySplice(w._markers,a);w&&(w._childCount--,w._boundsNeedUpdate=!0,!(w._zoom<v));)e&&1>=w._childCount?(z=w._markers[0]===a?w._markers[1]:w._markers[0],f[w._zoom].removeObject(w,u.project(w._cLatLng,w._zoom)),m[w._zoom].addObject(z,u.project(z.getLatLng(),w._zoom)),this._arraySplice(w.__parent._childClusters,w),w.__parent._markers.push(z),z.__parent=w.__parent,w._icon&&(g.removeLayer(w),k||g.addLayer(z))):w._iconNeedsUpdate=!0,w=w.__parent;delete a.__parent},_isOrIsParent:function(a,e){for(;e;){if(a===e)return!0;e=e.parentNode}return!1},fire:function(a,e,k){if(e&&e.layer instanceof L.MarkerCluster){if(e.originalEvent&&this._isOrIsParent(e.layer._icon,e.originalEvent.relatedTarget))return;a="cluster"+a}L.FeatureGroup.prototype.fire.call(this,a,e,k)},listens:function(a,e){return L.FeatureGroup.prototype.listens.call(this,a,e)||L.FeatureGroup.prototype.listens.call(this,"cluster"+a,e)},_defaultIconCreateFunction:function(a){a=a.getChildCount();var f=" marker-cluster-";return f+=10>a?"small":100>a?"medium":"large",new L.DivIcon({html:"\x3cdiv\x3e\x3cspan\x3e"+a+"\x3c/span\x3e\x3c/div\x3e",className:"marker-cluster"+f,iconSize:new L.Point(40,40)})},_bindEvents:function(){var a=this._map,e=this.options.showCoverageOnHover,k=this.options.zoomToBoundsOnClick;(this.options.spiderfyOnMaxZoom||k)&&this.on("clusterclick",this._zoomOrSpiderfy,this);e&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),a.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(a){for(var f=a.layer,e=f;1===e._childClusters.length;)e=e._childClusters[0];e._zoom===this._maxZoom&&e._childCount===f._childCount&&this.options.spiderfyOnMaxZoom?f.spiderfy():this.options.zoomToBoundsOnClick&&f.zoomToBounds();a.originalEvent&&13===a.originalEvent.keyCode&&this._map._container.focus()},_showCoverage:function(a){var f=this._map;this._inZoomAnimation||(this._shownPolygon&&f.removeLayer(this._shownPolygon),2<a.layer.getChildCount()&&a.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(a.layer.getConvexHull(),this.options.polygonOptions),f.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var a=this.options.showCoverageOnHover,e=this.options.zoomToBoundsOnClick,k=this._map;(this.options.spiderfyOnMaxZoom||e)&&this.off("clusterclick",this._zoomOrSpiderfy,this);a&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),k.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var a=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,a);this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),a);this._currentShownBounds=a}},_generateInitialClusters:function(){var a=Math.ceil(this._map.getMaxZoom()),e=Math.floor(this._map.getMinZoom()),k=this.options.maxClusterRadius,h=k;"function"!=typeof k&&(h=function(){return k});null!==this.options.disableClusteringAtZoom&&(a=this.options.disableClusteringAtZoom-1);this._maxZoom=a;this._gridClusters={};for(this._gridUnclustered={};a>=e;a--)this._gridClusters[a]=new L.DistanceGrid(h(a)),this._gridUnclustered[a]=new L.DistanceGrid(h(a));this._topClusterLevel=new this._markerCluster(this,e-1)},_addLayer:function(a,e){var f,h,m=this._gridClusters;h=this._gridUnclustered;var g=Math.floor(this._map.getMinZoom());this.options.singleMarkerMode&&this._overrideMarkerIcon(a);for(a.on(this._childMarkerEventHandlers,this);e>=g;e--){f=this._map.project(a.getLatLng(),e);var u=m[e].getNearObject(f);if(u)return u._addChild(a),a.__parent=u,void 0;if(u=h[e].getNearObject(f)){(f=u.__parent)&&this._removeLayer(u,!1);h=new this._markerCluster(this,e,u,a);m[e].addObject(h,this._map.project(h._cLatLng,e));u.__parent=h;g=a.__parent=h;for(h=e-1;h>f._zoom;h--)g=new this._markerCluster(this,h,g),m[h].addObject(g,this._map.project(u.getLatLng(),h));return f._addChild(g),this._removeFromGridUnclustered(u,e),void 0}h[e].addObject(a,f)}this._topClusterLevel._addChild(a);a.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(a){a instanceof L.MarkerCluster&&a._iconNeedsUpdate&&a._updateIcon()})},_enqueue:function(a){this._queue.push(a);this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var a=0;a<this._queue.length;a++)this._queue[a].call(this);this._queue.length=0;clearTimeout(this._queueTimeout);this._queueTimeout=null},_mergeSplitClusters:function(){var a=Math.round(this._map._zoom);this._processQueue();this._zoom<a&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,a)):this._zoom>a?(this._animationStart(),this._animationZoomOut(this._zoom,a)):this._moveEnd()},_getExpandedVisibleBounds:function(){return this.options.removeOutsideVisibleBounds?L.Browser.mobile?this._checkBoundsMaxLat(this._map.getBounds()):this._checkBoundsMaxLat(this._map.getBounds().pad(1)):this._mapBoundsInfinite},_checkBoundsMaxLat:function(a){var f=this._maxLat;return void 0!==f&&(a.getNorth()>=f&&(a._northEast.lat=1/0),a.getSouth()<=-f&&(a._southWest.lat=-1/0)),a},_animationAddLayerNonAnimated:function(a,e){if(e===a)this._featureGroup.addLayer(a);else if(2===e._childCount){e._addToMap();var f=e.getAllChildMarkers();this._featureGroup.removeLayer(f[0]);this._featureGroup.removeLayer(f[1])}else e._updateIcon()},_extractNonGroupLayers:function(a,e){var f,h=a.getLayers(),g=0;for(e=e||[];g<h.length;g++)f=h[g],f instanceof L.LayerGroup?this._extractNonGroupLayers(f,e):e.push(f);return e},_overrideMarkerIcon:function(a){return a.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[a]}})}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))});L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(a,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),a);this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds());this.fire("animationend")},_animationZoomOut:function(a,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),a);this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds());this.fire("animationend")},_animationAddLayer:function(a,e){this._animationAddLayerNonAnimated(a,e)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim";this._inZoomAnimation++},_animationZoomIn:function(a,e){var f,h=this._getExpandedVisibleBounds(),g=this._featureGroup,m=Math.floor(this._map.getMinZoom());this._ignoreMove=!0;this._topClusterLevel._recursively(h,a,m,function(k){var m=k._latlng,p=k._markers;h.contains(m)||(m=null);k._isSingleParent()&&a+1===e?(g.removeLayer(k),k._recursivelyAddChildrenToMap(null,e,h)):(k.clusterHide(),k._recursivelyAddChildrenToMap(m,e,h));for(f=p.length-1;0<=f;f--)k=p[f],h.contains(k._latlng)||g.removeLayer(k)});this._forceLayout();this._topClusterLevel._recursivelyBecomeVisible(h,e);g.eachLayer(function(a){a instanceof L.MarkerCluster||!a._icon||a.clusterShow()});this._topClusterLevel._recursively(h,a,e,function(a){a._recursivelyRestoreChildPositions(e)});this._ignoreMove=!1;this._enqueue(function(){this._topClusterLevel._recursively(h,a,m,function(a){g.removeLayer(a);a.clusterShow()});this._animationEnd()})},_animationZoomOut:function(a,e){this._animationZoomOutSingle(this._topClusterLevel,a-1,e);this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds());this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),a,this._getExpandedVisibleBounds())},_animationAddLayer:function(a,e){var f=this,h=this._featureGroup;h.addLayer(a);e!==a&&(2<e._childCount?(e._updateIcon(),this._forceLayout(),this._animationStart(),a._setPos(this._map.latLngToLayerPoint(e.getLatLng())),a.clusterHide(),this._enqueue(function(){h.removeLayer(a);a.clusterShow();f._animationEnd()})):(this._forceLayout(),f._animationStart(),f._animationZoomOutSingle(e,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(a,e,k){var f=this._getExpandedVisibleBounds(),g=Math.floor(this._map.getMinZoom());a._recursivelyAnimateChildrenInAndAddSelfToMap(f,g,e+1,k);var m=this;this._forceLayout();a._recursivelyBecomeVisible(f,k);this._enqueue(function(){if(1===a._childCount){var h=a._markers[0];this._ignoreMove=!0;h.setLatLng(h.getLatLng());this._ignoreMove=!1;h.clusterShow&&h.clusterShow()}else a._recursively(f,k,g,function(a){a._recursivelyRemoveChildrenFromMap(f,g,e+1)});m._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""));this._inZoomAnimation--;this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}});L.markerClusterGroup=function(a){return new L.MarkerClusterGroup(a)};var g=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(a,e,k,h){L.Marker.prototype.initialize.call(this,k?k._cLatLng||k.getLatLng():new L.LatLng(0,0),{icon:this,pane:a.options.clusterPane});this._group=a;this._zoom=e;this._markers=[];this._childClusters=[];this._childCount=0;this._boundsNeedUpdate=this._iconNeedsUpdate=!0;this._bounds=new L.LatLngBounds;k&&this._addChild(k);h&&this._addChild(h)},getAllChildMarkers:function(a,e){a=a||[];for(var f=this._childClusters.length-1;0<=f;f--)this._childClusters[f].getAllChildMarkers(a);for(f=this._markers.length-1;0<=f;f--)e&&this._markers[f].__dragStart||a.push(this._markers[f]);return a},getChildCount:function(){return this._childCount},zoomToBounds:function(a){var f,e=this._childClusters.slice();f=this._group._map;for(var h=f.getBoundsZoom(this._bounds),g=this._zoom+1,p=f.getZoom();0<e.length&&h>g;){g++;var u=[];for(f=0;f<e.length;f++)u=u.concat(e[f]._childClusters);e=u}h>g?this._group._map.setView(this._latlng,g):p>=h?this._group._map.setView(this._latlng,p+1):this._group._map.fitBounds(this._bounds,a)},getBounds:function(){var a=new L.LatLngBounds;return a.extend(this._bounds),a},_updateIcon:function(){this._iconNeedsUpdate=!0;this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(a,e){this._boundsNeedUpdate=this._iconNeedsUpdate=!0;this._setClusterCenter(a);a instanceof L.MarkerCluster?(e||(this._childClusters.push(a),a.__parent=this),this._childCount+=a._childCount):(e||this._markers.push(a),this._childCount++);this.__parent&&this.__parent._addChild(a,!0)},_setClusterCenter:function(a){this._cLatLng||(this._cLatLng=a._cLatLng||a._latlng)},_resetBounds:function(){var a=this._bounds;a._southWest&&(a._southWest.lat=1/0,a._southWest.lng=1/0);a._northEast&&(a._northEast.lat=-1/0,a._northEast.lng=-1/0)},_recalculateBounds:function(){var a,e,k;e=this._markers;var h=this._childClusters,g=0,p=0,u=this._childCount;if(0!==u){this._resetBounds();for(a=0;a<e.length;a++)k=e[a]._latlng,this._bounds.extend(k),g+=k.lat,p+=k.lng;for(a=0;a<h.length;a++)e=h[a],e._boundsNeedUpdate&&e._recalculateBounds(),this._bounds.extend(e._bounds),k=e._wLatLng,e=e._childCount,g+=k.lat*e,p+=k.lng*e;this._latlng=this._wLatLng=new L.LatLng(g/u,p/u);this._boundsNeedUpdate=!1}},_addToMap:function(a){a&&(this._backupLatlng=this._latlng,this.setLatLng(a));this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(a,e,k){this._recursively(a,this._group._map.getMinZoom(),k-1,function(a){var f,h=a._markers;for(a=h.length-1;0<=a;a--)f=h[a],f._icon&&(f._setPos(e),f.clusterHide())},function(a){var f,h=a._childClusters;for(a=h.length-1;0<=a;a--)f=h[a],f._icon&&(f._setPos(e),f.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(a,e,k,h){this._recursively(a,h,e,function(f){f._recursivelyAnimateChildrenIn(a,f._group._map.latLngToLayerPoint(f.getLatLng()).round(),k);f._isSingleParent()&&k-1===h?(f.clusterShow(),f._recursivelyRemoveChildrenFromMap(a,e,k)):f.clusterHide();f._addToMap()})},_recursivelyBecomeVisible:function(a,e){this._recursively(a,this._group._map.getMinZoom(),e,null,function(a){a.clusterShow()})},_recursivelyAddChildrenToMap:function(a,e,k){this._recursively(k,this._group._map.getMinZoom()-1,e,function(f){if(e!==f._zoom)for(var h=f._markers.length-1;0<=h;h--){var g=f._markers[h];k.contains(g._latlng)&&(a&&(g._backupLatlng=g.getLatLng(),g.setLatLng(a),g.clusterHide&&g.clusterHide()),f._group._featureGroup.addLayer(g))}},function(e){e._addToMap(a)})},_recursivelyRestoreChildPositions:function(a){for(var e=this._markers.length-1;0<=e;e--){var f=this._markers[e];f._backupLatlng&&(f.setLatLng(f._backupLatlng),delete f._backupLatlng)}if(a-1===this._zoom)for(a=this._childClusters.length-1;0<=a;a--)this._childClusters[a]._restorePosition();else for(e=this._childClusters.length-1;0<=e;e--)this._childClusters[e]._recursivelyRestoreChildPositions(a)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(a,e,k,h){var f,g;this._recursively(a,e-1,k-1,function(a){for(g=a._markers.length-1;0<=g;g--)f=a._markers[g],h&&h.contains(f._latlng)||(a._group._featureGroup.removeLayer(f),f.clusterShow&&f.clusterShow())},function(a){for(g=a._childClusters.length-1;0<=g;g--)f=a._childClusters[g],h&&h.contains(f._latlng)||(a._group._featureGroup.removeLayer(f),f.clusterShow&&f.clusterShow())})},_recursively:function(a,e,g,h,q){var f,k,m=this._childClusters;f=this._zoom;if(f>=e&&(h&&h(this),q&&f===g&&q(this)),e>f||g>f)for(f=m.length-1;0<=f;f--)k=m[f],k._boundsNeedUpdate&&k._recalculateBounds(),a.intersects(k._bounds)&&k._recursively(a,e,g,h,q)},_isSingleParent:function(){return 0<this._childClusters.length&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var a=this.options.opacity;return this.setOpacity(0),this.options.opacity=a,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}});L.DistanceGrid=function(a){this._cellSize=a;this._sqCellSize=a*a;this._grid={};this._objectPoint={}};L.DistanceGrid.prototype={addObject:function(a,e){var f=this._getCoord(e.x),h=this._getCoord(e.y),g=this._grid,h=g[h]=g[h]||{},f=h[f]=h[f]||[],h=L.Util.stamp(a);this._objectPoint[h]=e;f.push(a)},updateObject:function(a,e){this.removeObject(a);this.addObject(a,e)},removeObject:function(a,e){var f,h,g=this._getCoord(e.x);f=this._getCoord(e.y);h=this._grid;var m=h[f]=h[f]||{},u=m[g]=m[g]||[];delete this._objectPoint[L.Util.stamp(a)];f=0;for(h=u.length;h>f;f++)if(u[f]===a)return u.splice(f,1),1===h&&delete m[g],!0},eachObject:function(a,e){var f,h,g,m,u,v,z,w=this._grid;for(f in w)for(h in u=w[f],u)for(v=u[h],g=0,m=v.length;m>g;g++)(z=a.call(e,v[g]))&&(g--,m--)},getNearObject:function(a){var e,f,h,g,p,u,v,z,w=this._getCoord(a.x),F=this._getCoord(a.y),E=this._objectPoint,H=this._sqCellSize,P=null;for(e=F-1;F+1>=e;e++)if(g=this._grid[e])for(f=w-1;w+1>=f;f++)if(p=g[f])for(h=0,u=p.length;u>h;h++)v=p[h],z=this._sqDist(E[L.Util.stamp(v)],a),(H>z||H>=z&&null===P)&&(H=z,P=v);return P},_getCoord:function(a){var e=Math.floor(a/this._cellSize);return isFinite(e)?e:a},_sqDist:function(a,e){var f=e.x-a.x,h=e.y-a.y;return f*f+h*h}};(function(){L.QuickHull={getDistant:function(a,e){return(e[0].lng-e[1].lng)*(a.lat-e[0].lat)+(e[1].lat-e[0].lat)*(a.lng-e[0].lng)},findMostDistantPointFromBaseLine:function(a,e){var f,h,g,m=0,u=null,v=[];for(f=e.length-1;0<=f;f--)h=e[f],g=this.getDistant(h,a),0<g&&(v.push(h),g>m&&(m=g,u=h));return{maxPoint:u,newPoints:v}},buildConvexHull:function(a,e){var f=[],h=this.findMostDistantPointFromBaseLine(a,e);return h.maxPoint?(f=f.concat(this.buildConvexHull([a[0],h.maxPoint],h.newPoints)),f.concat(this.buildConvexHull([h.maxPoint,a[1]],h.newPoints))):[a[0]]},getConvexHull:function(a){var e,f=!1,h=!1,g=!1,p=!1,u=null,v=null,z=null,w=null,F=null,E=null;for(e=a.length-1;0<=e;e--){var H=a[e];(!1===f||H.lat>f)&&(u=H,f=H.lat);(!1===h||H.lat<h)&&(v=H,h=H.lat);(!1===g||H.lng>g)&&(z=H,g=H.lng);(!1===p||H.lng<p)&&(w=H,p=H.lng)}h!==f?(E=v,F=u):(E=w,F=z);return[].concat(this.buildConvexHull([E,F],a),this.buildConvexHull([F,E],a))}}})();L.MarkerCluster.include({getConvexHull:function(){var a,e,g=this.getAllChildMarkers(),h=[];for(e=g.length-1;0<=e;e--)a=g[e].getLatLng(),h.push(a);return L.QuickHull.getConvexHull(h)}});L.MarkerCluster.include({_2PI:2*Math.PI,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(this._group._spiderfied!==this&&!this._group._inZoomAnimation){var a,e=this.getAllChildMarkers(null,!0),g=this._group._map.latLngToLayerPoint(this._latlng);this._group._unspiderfy();this._group._spiderfied=this;e.length>=this._circleSpiralSwitchover?a=this._generatePointsSpiral(e.length,g):(g.y+=10,a=this._generatePointsCircle(e.length,g));this._animationSpiderfy(e,a)}},unspiderfy:function(a){this._group._inZoomAnimation||(this._animationUnspiderfy(a),this._group._spiderfied=null)},_generatePointsCircle:function(a,e){var f,h,g=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+a)/this._2PI,p=this._2PI/a,m=[],g=Math.max(g,35);m.length=a;for(f=0;a>f;f++)h=this._circleStartAngle+f*p,m[f]=(new L.Point(e.x+g*Math.cos(h),e.y+g*Math.sin(h)))._round();return m},_generatePointsSpiral:function(a,e){var f;f=this._group.options.spiderfyDistanceMultiplier;var h=f*this._spiralLengthStart,g=f*this._spiralFootSeparation,p=f*this._spiralLengthFactor*this._2PI,m=0,v=[];for(f=v.length=a;0<=f;f--)a>f&&(v[f]=(new L.Point(e.x+h*Math.cos(m),e.y+h*Math.sin(m)))._round()),m+=g/h+5E-4*f,h+=p/m;return v},_noanimationUnspiderfy:function(){var a,e,g=this._group,h=g._map,q=g._featureGroup,p=this.getAllChildMarkers(null,!0);g._ignoreMove=!0;this.setOpacity(1);for(e=p.length-1;0<=e;e--)a=p[e],q.removeLayer(a),a._preSpiderfyLatlng&&(a.setLatLng(a._preSpiderfyLatlng),delete a._preSpiderfyLatlng),a.setZIndexOffset&&a.setZIndexOffset(0),a._spiderLeg&&(h.removeLayer(a._spiderLeg),delete a._spiderLeg);g.fire("unspiderfied",{cluster:this,markers:p});g._ignoreMove=!1;g._spiderfied=null}});L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(a,e){var f,h,g,p,m=this._group,v=m._map,z=m._featureGroup,w=this._group.options.spiderLegPolylineOptions;m._ignoreMove=!0;for(f=0;f<a.length;f++)p=v.layerPointToLatLng(e[f]),h=a[f],g=new L.Polyline([this._latlng,p],w),v.addLayer(g),h._spiderLeg=g,h._preSpiderfyLatlng=h._latlng,h.setLatLng(p),h.setZIndexOffset&&h.setZIndexOffset(1E6),z.addLayer(h);this.setOpacity(.3);m._ignoreMove=!1;m.fire("spiderfied",{cluster:this,markers:a})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}});L.MarkerCluster.include({_animationSpiderfy:function(a,e){var f,h,g,p,m,v,z=this,w=this._group,F=w._map,E=w._featureGroup,H=this._latlng,P=F.latLngToLayerPoint(H),V=L.Path.SVG,ba=L.extend({},this._group.options.spiderLegPolylineOptions),Ca=ba.opacity;void 0===Ca&&(Ca=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity);V?(ba.opacity=0,ba.className=(ba.className||"")+" leaflet-cluster-spider-leg"):ba.opacity=Ca;w._ignoreMove=!0;for(f=0;f<a.length;f++)h=a[f],v=F.layerPointToLatLng(e[f]),g=new L.Polyline([H,v],ba),F.addLayer(g),h._spiderLeg=g,V&&(p=g._path,m=p.getTotalLength()+.1,p.style.strokeDasharray=m,p.style.strokeDashoffset=m),h.setZIndexOffset&&h.setZIndexOffset(1E6),h.clusterHide&&h.clusterHide(),E.addLayer(h),h._setPos&&h._setPos(P);w._forceLayout();w._animationStart();for(f=a.length-1;0<=f;f--)v=F.layerPointToLatLng(e[f]),h=a[f],h._preSpiderfyLatlng=h._latlng,h.setLatLng(v),h.clusterShow&&h.clusterShow(),V&&(g=h._spiderLeg,p=g._path,p.style.strokeDashoffset=0,g.setStyle({opacity:Ca}));this.setOpacity(.3);w._ignoreMove=!1;setTimeout(function(){w._animationEnd();w.fire("spiderfied",{cluster:z,markers:a})},200)},_animationUnspiderfy:function(a){var e,f,h,g,p,u,v=this,z=this._group,w=z._map,F=z._featureGroup;a=a?w._latLngToNewLayerPoint(this._latlng,a.zoom,a.center):w.latLngToLayerPoint(this._latlng);var E=this.getAllChildMarkers(null,!0),H=L.Path.SVG;z._ignoreMove=!0;z._animationStart();this.setOpacity(1);for(f=E.length-1;0<=f;f--)e=E[f],e._preSpiderfyLatlng&&(e.closePopup(),e.setLatLng(e._preSpiderfyLatlng),delete e._preSpiderfyLatlng,u=!0,e._setPos&&(e._setPos(a),u=!1),e.clusterHide&&(e.clusterHide(),u=!1),u&&F.removeLayer(e),H&&(h=e._spiderLeg,g=h._path,p=g.getTotalLength()+.1,g.style.strokeDashoffset=p,h.setStyle({opacity:0})));z._ignoreMove=!1;setTimeout(function(){var a=0;for(f=E.length-1;0<=f;f--)e=E[f],e._spiderLeg&&a++;for(f=E.length-1;0<=f;f--)e=E[f],e._spiderLeg&&(e.clusterShow&&e.clusterShow(),e.setZIndexOffset&&e.setZIndexOffset(0),1<a&&F.removeLayer(e),w.removeLayer(e._spiderLeg),delete e._spiderLeg);z._animationEnd();z.fire("unspiderfied",{cluster:v,markers:E})},200)}});L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this);this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this);this._map.on("zoomend",this._noanimationUnspiderfy,this);L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this);this._map.off("zoomstart",this._unspiderfyZoomStart,this);this._map.off("zoomanim",this._unspiderfyZoomAnim,this);this._map.off("zoomend",this._noanimationUnspiderfy,this);this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(a){null!=this._map&&(L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(a)))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(a){this._spiderfied&&this._spiderfied.unspiderfy(a)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(a){a._spiderLeg&&(this._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow(),a.setZIndexOffset&&a.setZIndexOffset(0),this._map.removeLayer(a._spiderLeg),delete a._spiderLeg)}});L.MarkerClusterGroup.include({refreshClusters:function(a){return a?a instanceof L.MarkerClusterGroup?a=a._topClusterLevel.getAllChildMarkers():a instanceof L.LayerGroup?a=a._layers:a instanceof L.MarkerCluster?a=a.getAllChildMarkers():a instanceof L.Marker&&(a=[a]):a=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(a),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(a),this},_flagParentsIconsNeedUpdate:function(a){var e,f;for(e in a)for(f=a[e].__parent;f;)f._iconNeedsUpdate=!0,f=f.__parent},_refreshSingleMarkerModeMarkers:function(a){var e,f;for(e in a)f=a[e],this.hasLayer(f)&&f.setIcon(this._overrideMarkerIcon(f))}});L.Marker.include({refreshIconOptions:function(a,e){var f=this.options.icon;return L.setOptions(f,a),this.setIcon(f),e&&this.__parent&&this.__parent._group.refreshClusters(this),this}});a.MarkerClusterGroup=e;a.MarkerCluster=g});"use strict";function __$strToBlobUri(a,e,g){try{return window.URL.createObjectURL(new Blob([Uint8Array.from(a.split("").map(function(a){return a.charCodeAt(0)}))],{type:e}))}catch(f){return"data:"+e+(g?";base64,":",")+a}}L.SVG.Tile=L.SVG.extend({initialize:function(a,e,g){L.SVG.prototype.initialize.call(this,g);this._tileCoord=a;this._size=e;this._initContainer();this._container.setAttribute("width",this._size.x);this._container.setAttribute("height",this._size.y);this._container.setAttribute("viewBox",[0,0,this._size.x,this._size.y].join(" "));this._layers={}},getCoord:function(){return this._tileCoord},getContainer:function(){return this._container},onAdd:L.Util.falseFn,addTo:function(a){this._map=a;if(this.options.interactive)for(var e in this._layers)a=this._layers[e],a._path.style.pointerEvents="auto",this._map._targets[L.stamp(a._path)]=a},removeFrom:function(a){if(this.options.interactive)for(var e in this._layers)delete this._map._targets[L.stamp(this._layers[e]._path)];delete this._map},_initContainer:function(){L.SVG.prototype._initContainer.call(this);L.SVG.create("rect")},_addPath:function(a){this._rootGroup.appendChild(a._path);this._layers[L.stamp(a)]=a},_updateIcon:function(a){var e=a._path=L.SVG.create("image"),g=a.options.icon.options,f=L.point(g.iconSize),m=g.iconAnchor||f&&f.divideBy(2,!0);a=a._point.subtract(m);e.setAttribute("x",a.x);e.setAttribute("y",a.y);e.setAttribute("width",f.x+"px");e.setAttribute("height",f.y+"px");e.setAttribute("href",g.iconUrl)}});L.svg.tile=function(a,e,g){return new L.SVG.Tile(a,e,g)};var Symbolizer=L.Class.extend({render:function(a,e){this._renderer=a;this.options=e;a._initPath(this);a._updateStyle(this)},updateStyle:function(a,e){this.options=e;a._updateStyle(this)},_getPixelBounds:function(){for(var a=this._parts,e=L.bounds([]),g=0;g<a.length;g++)for(var f=a[g],m=0;m<f.length;m++)e.extend(f[m]);a=this._clickTolerance();a=new L.Point(a,a);e.min._subtract(a);e.max._add(a);return e},_clickTolerance:L.Path.prototype._clickTolerance}),PolyBase={_makeFeatureParts:function(a,e){var g=a.geometry,f;this._parts=[];for(var m=0;m<g.length;m++){for(var k=g[m],h=[],q=0;q<k.length;q++)f=k[q],h.push(L.point(f).scaleBy(e));this._parts.push(h)}},makeInteractive:function(){this._pxBounds=this._getPixelBounds()}},PointSymbolizer=L.CircleMarker.extend({includes:Symbolizer.prototype,statics:{iconCache:{}},initialize:function(a,e){this.properties=a.properties;this._makeFeatureParts(a,e)},render:function(a,e){Symbolizer.prototype.render.call(this,a,e);this._radius=e.radius||L.CircleMarker.prototype.options.radius;this._updatePath()},_makeFeatureParts:function(a,e){var g=a.geometry[0];this._point="object"===typeof g[0]&&"x"in g[0]?L.point(g[0]).scaleBy(e):L.point(g).scaleBy(e);this._empty=L.Util.falseFn},makeInteractive:function(){this._updateBounds()},updateStyle:function(a,e){this._radius=e.radius||this._radius;this._updateBounds();return Symbolizer.prototype.updateStyle.call(this,a,e)},_updateBounds:function(){var a=this.options.icon;if(a){var e=L.point(a.options.iconSize),e=a.options.iconAnchor||e&&e.divideBy(2,!0),e=this._point.subtract(e);this._pxBounds=new L.Bounds(e,e.add(a.options.iconSize))}else L.CircleMarker.prototype._updateBounds.call(this)},_updatePath:function(){this.options.icon?this._renderer._updateIcon(this):L.CircleMarker.prototype._updatePath.call(this)},_getImage:function(){if(this.options.icon){var a=this.options.icon.options.iconUrl,e=PointSymbolizer.iconCache[a];e||(e=PointSymbolizer.iconCache[a]=this.options.icon.createIcon());return e}return null},_containsPoint:function(a){return this.options.icon?this._pxBounds.contains(a):L.CircleMarker.prototype._containsPoint.call(this,a)}}),LineSymbolizer=L.Polyline.extend({includes:[Symbolizer.prototype,PolyBase],initialize:function(a,e){this.properties=a.properties;this._makeFeatureParts(a,e)},render:function(a,e){e.fill=!1;Symbolizer.prototype.render.call(this,a,e);this._updatePath()},updateStyle:function(a,e){e.fill=!1;Symbolizer.prototype.updateStyle.call(this,a,e)}}),FillSymbolizer=L.Polygon.extend({includes:[Symbolizer.prototype,PolyBase],initialize:function(a,e){this.properties=a.properties;this._makeFeatureParts(a,e)},render:function(a,e){Symbolizer.prototype.render.call(this,a,e);this._updatePath()}});L.VectorGrid=L.GridLayer.extend({options:{rendererFactory:L.svg.tile,vectorTileLayerStyles:{},interactive:!1},initialize:function(a){L.setOptions(this,a);L.GridLayer.prototype.initialize.apply(this,arguments);this.options.getFeatureId&&(this._vectorTiles={},this._overriddenStyles={},this.on("tileunload",function(a){a=this._tileCoordsToKey(a.coords);var e=this._vectorTiles[a];e&&this._map&&e.removeFrom(this._map);delete this._vectorTiles[a]},this));this._dataLayerNames={}},createTile:function(a,e){var g=this.options.getFeatureId,f=this.getTileSize(),m=this.options.rendererFactory(a,f,this.options),f=this._getVectorTilePromise(a);g&&(this._vectorTiles[this._tileCoordsToKey(a)]=m,m._features={});f.then(function(f){for(var h in f.layers){this._dataLayerNames[h]=!0;for(var k=f.layers[h],p=this.getTileSize().divideBy(k.extent),u=this.options.vectorTileLayerStyles[h]||L.Path.prototype.options,v=0;v<k.features.length;v++){var z=k.features[v],w,F=u;if(g){w=this.options.getFeatureId(z);var E=this._overriddenStyles[w];E&&(F=E[h]?E[h]:E)}F instanceof Function&&(F=F(z.properties,a.z));F instanceof Array||(F=[F]);if(F.length){z=this._createLayer(z,p);for(E=0;E<F.length;E++){var H=L.extend({},L.Path.prototype.options,F[E]);z.render(m,H);m._addPath(z)}this.options.interactive&&z.makeInteractive();g&&(m._features[w]={layerName:h,feature:z})}}}null!=this._map&&m.addTo(this._map);L.Util.requestAnimFrame(e.bind(a,null,null))}.bind(this));return m.getContainer()},setFeatureStyle:function(a,e){this._overriddenStyles[a]=e;for(var g in this._vectorTiles){var f=this._vectorTiles[g],m=f._features[a];if(m){var k=m.feature,h=e;e[m.layerName]&&(h=e[m.layerName]);this._updateStyles(k,f,h)}}return this},resetFeatureStyle:function(a){delete this._overriddenStyles[a];for(var e in this._vectorTiles){var g=this._vectorTiles[e],f=g._features[a];f&&this._updateStyles(f.feature,g,this.options.vectorTileLayerStyles[f.layerName]||L.Path.prototype.options)}return this},getDataLayerNames:function(){return Object.keys(this._dataLayerNames)},_updateStyles:function(a,e,g){g=g instanceof Function?g(a.properties,e.getCoord().z):g;g instanceof Array||(g=[g]);for(var f=0;f<g.length;f++){var m=L.extend({},L.Path.prototype.options,g[f]);a.updateStyle(e,m)}},_createLayer:function(a,e,g){var f;switch(a.type){case 1:f=new PointSymbolizer(a,e);break;case 2:f=new LineSymbolizer(a,e);break;case 3:f=new FillSymbolizer(a,e)}this.options.interactive&&f.addEventParent(this);return f}});L.vectorGrid=function(a){return new L.VectorGrid(a)};var read=function(a,e,g,f,m){var k;k=8*m-f-1;var h=(1<<k)-1,q=h>>1,p=-7;m=g?m-1:0;var u=g?-1:1,v=a[e+m];m+=u;g=v&(1<<-p)-1;v>>=-p;for(p+=k;0<p;g=256*g+a[e+m],m+=u,p-=8);k=g&(1<<-p)-1;g>>=-p;for(p+=f;0<p;k=256*k+a[e+m],m+=u,p-=8);if(0===g)g=1-q;else{if(g===h)return k?NaN:Infinity*(v?-1:1);k+=Math.pow(2,f);g-=q}return(v?-1:1)*k*Math.pow(2,g-f)},write=function(a,e,g,f,m,k){var h,q=8*k-m-1,p=(1<<q)-1,u=p>>1,v=23===m?Math.pow(2,-24)-Math.pow(2,-77):0;k=f?0:k-1;var z=f?1:-1,w=0>e||0===e&&0>1/e?1:0;e=Math.abs(e);isNaN(e)||Infinity===e?(e=isNaN(e)?1:0,f=p):(f=Math.floor(Math.log(e)/Math.LN2),1>e*(h=Math.pow(2,-f))&&(f--,h*=2),e=1<=f+u?e+v/h:e+v*Math.pow(2,1-u),2<=e*h&&(f++,h/=2),f+u>=p?(e=0,f=p):1<=f+u?(e=(e*h-1)*Math.pow(2,m),f+=u):(e=e*Math.pow(2,u-1)*Math.pow(2,m),f=0));for(;8<=m;a[g+k]=e&255,k+=z,e/=256,m-=8);f=f<<m|e;for(q+=m;0<q;a[g+k]=f&255,k+=z,f/=256,q-=8);a[g+k-z]|=128*w},index$1={read:read,write:write},index=Pbf,ieee754=index$1;function Pbf(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0);this.type=this.pos=0;this.length=this.buf.length}Pbf.Varint=0;Pbf.Fixed64=1;Pbf.Bytes=2;Pbf.Fixed32=5;var SHIFT_LEFT_32=4294967296,SHIFT_RIGHT_32=1/SHIFT_LEFT_32;Pbf.prototype={destroy:function(){this.buf=null},readFields:function(a,e,g){for(g=g||this.length;this.pos<g;){var f=this.readVarint(),m=f>>3,k=this.pos;this.type=f&7;a(m,e,this);this.pos===k&&this.skip(f)}return e},readMessage:function(a,e){return this.readFields(a,e,this.readVarint()+this.pos)},readFixed32:function(){var a=readUInt32(this.buf,this.pos);this.pos+=4;return a},readSFixed32:function(){var a=readInt32(this.buf,this.pos);this.pos+=4;return a},readFixed64:function(){var a=readUInt32(this.buf,this.pos)+readUInt32(this.buf,this.pos+4)*SHIFT_LEFT_32;this.pos+=8;return a},readSFixed64:function(){var a=readUInt32(this.buf,this.pos)+readInt32(this.buf,this.pos+4)*SHIFT_LEFT_32;this.pos+=8;return a},readFloat:function(){var a=ieee754.read(this.buf,this.pos,!0,23,4);this.pos+=4;return a},readDouble:function(){var a=ieee754.read(this.buf,this.pos,!0,52,8);this.pos+=8;return a},readVarint:function(a){var e=this.buf,g,f;f=e[this.pos++];g=f&127;if(128>f)return g;f=e[this.pos++];g|=(f&127)<<7;if(128>f)return g;f=e[this.pos++];g|=(f&127)<<14;if(128>f)return g;f=e[this.pos++];g|=(f&127)<<21;if(128>f)return g;f=e[this.pos];return readVarintRemainder(g|(f&15)<<28,a,this)},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return 1===a%2?(a+1)/-2:a/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,e=readUtf8(this.buf,this.pos,a);this.pos=a;return e},readBytes:function(){var a=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,a);this.pos=a;return e},readPackedVarint:function(a,e){var g=readPackedEnd(this);for(a=a||[];this.pos<g;)a.push(this.readVarint(e));return a},readPackedSVarint:function(a){var e=readPackedEnd(this);for(a=a||[];this.pos<e;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){var e=readPackedEnd(this);for(a=a||[];this.pos<e;)a.push(this.readBoolean());return a},readPackedFloat:function(a){var e=readPackedEnd(this);for(a=a||[];this.pos<e;)a.push(this.readFloat());return a},readPackedDouble:function(a){var e=readPackedEnd(this);for(a=a||[];this.pos<e;)a.push(this.readDouble());return a},readPackedFixed32:function(a){var e=readPackedEnd(this);for(a=a||[];this.pos<e;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){var e=readPackedEnd(this);for(a=a||[];this.pos<e;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){var e=readPackedEnd(this);for(a=a||[];this.pos<e;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){var e=readPackedEnd(this);for(a=a||[];this.pos<e;)a.push(this.readSFixed64());return a},skip:function(a){a&=7;if(a===Pbf.Varint)for(;127<this.buf[this.pos++];);else if(a===Pbf.Bytes)this.pos=this.readVarint()+this.pos;else if(a===Pbf.Fixed32)this.pos+=4;else if(a===Pbf.Fixed64)this.pos+=8;else throw Error("Unimplemented type: "+a);},writeTag:function(a,e){this.writeVarint(a<<3|e)},realloc:function(a){for(var e=this.length||16;e<this.pos+a;)e*=2;e!==this.length&&(a=new Uint8Array(e),a.set(this.buf),this.buf=a,this.length=e)},finish:function(){this.length=this.pos;this.pos=0;return this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4);writeInt32(this.buf,a,this.pos);this.pos+=4},writeSFixed32:function(a){this.realloc(4);writeInt32(this.buf,a,this.pos);this.pos+=4},writeFixed64:function(a){this.realloc(8);writeInt32(this.buf,a&-1,this.pos);writeInt32(this.buf,Math.floor(a*SHIFT_RIGHT_32),this.pos+4);this.pos+=8},writeSFixed64:function(a){this.realloc(8);writeInt32(this.buf,a&-1,this.pos);writeInt32(this.buf,Math.floor(a*SHIFT_RIGHT_32),this.pos+4);this.pos+=8},writeVarint:function(a){a=+a||0;268435455<a||0>a?writeBigVarint(a,this):(this.realloc(4),this.buf[this.pos++]=a&127|(127<a?128:0),127>=a||(this.buf[this.pos++]=(a>>>=7)&127|(127<a?128:0),127>=a||(this.buf[this.pos++]=(a>>>=7)&127|(127<a?128:0),127>=a||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(0>a?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(!!a)},writeString:function(a){a=String(a);this.realloc(4*a.length);this.pos++;var e=this.pos;this.pos=writeUtf8(this.buf,a,this.pos);a=this.pos-e;128<=a&&makeRoomForExtraLength(e,a,this);this.pos=e-1;this.writeVarint(a);this.pos+=a},writeFloat:function(a){this.realloc(4);ieee754.write(this.buf,a,this.pos,!0,23,4);this.pos+=4},writeDouble:function(a){this.realloc(8);ieee754.write(this.buf,a,this.pos,!0,52,8);this.pos+=8},writeBytes:function(a){var e=a.length;this.writeVarint(e);this.realloc(e);for(var g=0;g<e;g++)this.buf[this.pos++]=a[g]},writeRawMessage:function(a,e){this.pos++;var g=this.pos;a(e,this);var f=this.pos-g;128<=f&&makeRoomForExtraLength(g,f,this);this.pos=g-1;this.writeVarint(f);this.pos+=f},writeMessage:function(a,e,g){this.writeTag(a,Pbf.Bytes);this.writeRawMessage(e,g)},writePackedVarint:function(a,e){this.writeMessage(a,writePackedVarint,e)},writePackedSVarint:function(a,e){this.writeMessage(a,writePackedSVarint,e)},writePackedBoolean:function(a,e){this.writeMessage(a,writePackedBoolean,e)},writePackedFloat:function(a,e){this.writeMessage(a,writePackedFloat,e)},writePackedDouble:function(a,e){this.writeMessage(a,writePackedDouble,e)},writePackedFixed32:function(a,e){this.writeMessage(a,writePackedFixed32,e)},writePackedSFixed32:function(a,e){this.writeMessage(a,writePackedSFixed32,e)},writePackedFixed64:function(a,e){this.writeMessage(a,writePackedFixed64,e)},writePackedSFixed64:function(a,e){this.writeMessage(a,writePackedSFixed64,e)},writeBytesField:function(a,e){this.writeTag(a,Pbf.Bytes);this.writeBytes(e)},writeFixed32Field:function(a,e){this.writeTag(a,Pbf.Fixed32);this.writeFixed32(e)},writeSFixed32Field:function(a,e){this.writeTag(a,Pbf.Fixed32);this.writeSFixed32(e)},writeFixed64Field:function(a,e){this.writeTag(a,Pbf.Fixed64);this.writeFixed64(e)},writeSFixed64Field:function(a,e){this.writeTag(a,Pbf.Fixed64);this.writeSFixed64(e)},writeVarintField:function(a,e){this.writeTag(a,Pbf.Varint);this.writeVarint(e)},writeSVarintField:function(a,e){this.writeTag(a,Pbf.Varint);this.writeSVarint(e)},writeStringField:function(a,e){this.writeTag(a,Pbf.Bytes);this.writeString(e)},writeFloatField:function(a,e){this.writeTag(a,Pbf.Fixed32);this.writeFloat(e)},writeDoubleField:function(a,e){this.writeTag(a,Pbf.Fixed64);this.writeDouble(e)},writeBooleanField:function(a,e){this.writeVarintField(a,!!e)}};function readVarintRemainder(a,e,g){var f=g.buf,m,k;k=f[g.pos++];m=(k&112)>>4;if(128>k)return toNum(a,m,e);k=f[g.pos++];m|=(k&127)<<3;if(128>k)return toNum(a,m,e);k=f[g.pos++];m|=(k&127)<<10;if(128>k)return toNum(a,m,e);k=f[g.pos++];m|=(k&127)<<17;if(128>k)return toNum(a,m,e);k=f[g.pos++];m|=(k&127)<<24;if(128>k)return toNum(a,m,e);k=f[g.pos++];if(128>k)return toNum(a,m|(k&1)<<31,e);throw Error("Expected varint not more than 10 bytes");}function readPackedEnd(a){return a.type===Pbf.Bytes?a.readVarint()+a.pos:a.pos+1}function toNum(a,e,g){return g?4294967296*e+(a>>>0):4294967296*(e>>>0)+(a>>>0)}function writeBigVarint(a,e){var g,f;0<=a?(g=a%4294967296|0,f=a/4294967296|0):(g=~(-a%4294967296),f=~(-a/4294967296),g^4294967295?g=g+1|0:(g=0,f=f+1|0));if(1.8446744073709552E19<=a||-1.8446744073709552E19>a)throw Error("Given varint doesn't fit into 10 bytes");e.realloc(10);writeBigVarintLow(g,f,e);writeBigVarintHigh(f,e)}function writeBigVarintLow(a,e,g){g.buf[g.pos++]=a&127|128;a>>>=7;g.buf[g.pos++]=a&127|128;a>>>=7;g.buf[g.pos++]=a&127|128;a>>>=7;g.buf[g.pos++]=a&127|128;g.buf[g.pos]=a>>>7&127}function writeBigVarintHigh(a,e){e.buf[e.pos++]|=(a&7)<<4|((a>>>=3)?128:0);a&&(e.buf[e.pos++]=a&127|((a>>>=7)?128:0),a&&(e.buf[e.pos++]=a&127|((a>>>=7)?128:0),a&&(e.buf[e.pos++]=a&127|((a>>>=7)?128:0),a&&(e.buf[e.pos++]=a&127|((a>>>=7)?128:0),a&&(e.buf[e.pos++]=a&127)))))}function makeRoomForExtraLength(a,e,g){e=16383>=e?1:2097151>=e?2:268435455>=e?3:Math.ceil(Math.log(e)/(7*Math.LN2));g.realloc(e);for(var f=g.pos-1;f>=a;f--)g.buf[f+e]=g.buf[f]}function writePackedVarint(a,e){for(var g=0;g<a.length;g++)e.writeVarint(a[g])}function writePackedSVarint(a,e){for(var g=0;g<a.length;g++)e.writeSVarint(a[g])}function writePackedFloat(a,e){for(var g=0;g<a.length;g++)e.writeFloat(a[g])}function writePackedDouble(a,e){for(var g=0;g<a.length;g++)e.writeDouble(a[g])}function writePackedBoolean(a,e){for(var g=0;g<a.length;g++)e.writeBoolean(a[g])}function writePackedFixed32(a,e){for(var g=0;g<a.length;g++)e.writeFixed32(a[g])}function writePackedSFixed32(a,e){for(var g=0;g<a.length;g++)e.writeSFixed32(a[g])}function writePackedFixed64(a,e){for(var g=0;g<a.length;g++)e.writeFixed64(a[g])}function writePackedSFixed64(a,e){for(var g=0;g<a.length;g++)e.writeSFixed64(a[g])}function readUInt32(a,e){return(a[e]|a[e+1]<<8|a[e+2]<<16)+16777216*a[e+3]}function writeInt32(a,e,g){a[g]=e;a[g+1]=e>>>8;a[g+2]=e>>>16;a[g+3]=e>>>24}function readInt32(a,e){return(a[e]|a[e+1]<<8|a[e+2]<<16)+(a[e+3]<<24)}function readUtf8(a,e,g){for(var f="";e<g;){var m=a[e],k=null,h=239<m?4:223<m?3:191<m?2:1;if(e+h>g)break;var q,p,u;if(1===h)128>m&&(k=m);else if(2===h)q=a[e+1],128===(q&192)&&(k=(m&31)<<6|q&63,127>=k&&(k=null));else if(3===h){if(q=a[e+1],p=a[e+2],128===(q&192)&&128===(p&192)&&(k=(m&15)<<12|(q&63)<<6|p&63,2047>=k||55296<=k&&57343>=k))k=null}else 4===h&&(q=a[e+1],p=a[e+2],u=a[e+3],128===(q&192)&&128===(p&192)&&128===(u&192)&&(k=(m&15)<<18|(q&63)<<12|(p&63)<<6|u&63,65535>=k||1114112<=k))&&(k=null);null===k?(k=65533,h=1):65535<k&&(k-=65536,f+=String.fromCharCode(k>>>10&1023|55296),k=56320|k&1023);f+=String.fromCharCode(k);e+=h}return f}function writeUtf8(a,e,g){for(var f=0,m,k;f<e.length;f++){m=e.charCodeAt(f);if(55295<m&&57344>m)if(k)if(56320>m){a[g++]=239;a[g++]=191;a[g++]=189;k=m;continue}else m=k-55296<<10|m-56320|65536,k=null;else{56319<m||f+1===e.length?(a[g++]=239,a[g++]=191,a[g++]=189):k=m;continue}else k&&(a[g++]=239,a[g++]=191,a[g++]=189,k=null);128>m?a[g++]=m:(2048>m?a[g++]=m>>6|192:(65536>m?a[g++]=m>>12|224:(a[g++]=m>>18|240,a[g++]=m>>12&63|128),a[g++]=m>>6&63|128),a[g++]=m&63|128)}return g}var index$5=Point$1;function Point$1(a,e){this.x=a;this.y=e}Point$1.prototype={clone:function(){return new Point$1(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var e=a.x-this.x;a=a.y-this.y;return e*e+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,e){return Math.atan2(this.x*e-this.y*a,this.x*a+this.y*e)},_matMult:function(a){var e=a[2]*this.x+a[3]*this.y;this.x=a[0]*this.x+a[1]*this.y;this.y=e;return this},_add:function(a){this.x+=a.x;this.y+=a.y;return this},_sub:function(a){this.x-=a.x;this.y-=a.y;return this},_mult:function(a){this.x*=a;this.y*=a;return this},_div:function(a){this.x/=a;this.y/=a;return this},_unit:function(){this._div(this.mag());return this},_perp:function(){var a=this.y;this.y=this.x;this.x=-a;return this},_rotate:function(a){var e=Math.cos(a);a=Math.sin(a);var g=a*this.x+e*this.y;this.x=e*this.x-a*this.y;this.y=g;return this},_round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this}};Point$1.convert=function(a){return a instanceof Point$1?a:Array.isArray(a)?new Point$1(a[0],a[1]):a};var Point=index$5,vectortilefeature=VectorTileFeature$2;function VectorTileFeature$2(a,e,g,f,m){this.properties={};this.extent=g;this.type=0;this._pbf=a;this._geometry=-1;this._keys=f;this._values=m;a.readFields(readFeature,this,e)}function readFeature(a,e,g){1==a?e.id=g.readVarint():2==a?readTag(g,e):3==a?e.type=g.readVarint():4==a&&(e._geometry=g.pos)}function readTag(a,e){for(var g=a.readVarint()+a.pos;a.pos<g;){var f=e._keys[a.readVarint()],m=e._values[a.readVarint()];e.properties[f]=m}}VectorTileFeature$2.types=["Unknown","Point","LineString","Polygon"];VectorTileFeature$2.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var e=a.readVarint()+a.pos,g=1,f=0,m=0,k=0,h=[],q;a.pos<e;)if(f||(f=a.readVarint(),g=f&7,f>>=3),f--,1===g||2===g)m+=a.readSVarint(),k+=a.readSVarint(),1===g&&(q&&h.push(q),q=[]),q.push(new Point(m,k));else if(7===g)q&&q.push(q[0].clone());else throw Error("unknown command "+g);q&&h.push(q);return h};VectorTileFeature$2.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var e=a.readVarint()+a.pos,g=1,f=0,m=0,k=0,h=Infinity,q=-Infinity,p=Infinity,u=-Infinity;a.pos<e;)if(f||(f=a.readVarint(),g=f&7,f>>=3),f--,1===g||2===g)m+=a.readSVarint(),k+=a.readSVarint(),m<h&&(h=m),m>q&&(q=m),k<p&&(p=k),k>u&&(u=k);else if(7!==g)throw Error("unknown command "+g);return[h,p,q,u]};VectorTileFeature$2.prototype.toGeoJSON=function(a,e,g){function f(a){for(var e=0;e<a.length;e++){var f=a[e];a[e]=[360*(f.x+k)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(f.y+h)/m)*Math.PI/180))-90]}}var m=this.extent*Math.pow(2,g),k=this.extent*a,h=this.extent*e;a=this.loadGeometry();e=VectorTileFeature$2.types[this.type];var q;switch(this.type){case 1:q=[];for(g=0;g<a.length;g++)q[g]=a[g][0];a=q;f(a);break;case 2:for(g=0;g<a.length;g++)f(a[g]);break;case 3:for(a=classifyRings(a),g=0;g<a.length;g++)for(q=0;q<a[g].length;q++)f(a[g][q])}1===a.length?a=a[0]:e="Multi"+e;a={type:"Feature",geometry:{type:e,coordinates:a},properties:this.properties};"id"in this&&(a.id=this.id);return a};function classifyRings(a){var e=a.length;if(1>=e)return[a];for(var g=[],f,m,k=0;k<e;k++){var h=signedArea(a[k]);0!==h&&(void 0===m&&(m=0>h),m===0>h?(f&&g.push(f),f=[a[k]]):f.push(a[k]))}f&&g.push(f);return g}function signedArea(a){for(var e=0,g=0,f=a.length,m=f-1,k;g<f;m=g++)k=a[g],m=a[m],e+=(m.x-k.x)*(k.y+m.y);return e}var VectorTileFeature$1=vectortilefeature,vectortilelayer=VectorTileLayer$2;function VectorTileLayer$2(a,e){this.version=1;this.name=null;this.extent=4096;this.length=0;this._pbf=a;this._keys=[];this._values=[];this._features=[];a.readFields(readLayer,this,e);this.length=this._features.length}function readLayer(a,e,g){15===a?e.version=g.readVarint():1===a?e.name=g.readString():5===a?e.extent=g.readVarint():2===a?e._features.push(g.pos):3===a?e._keys.push(g.readString()):4===a&&e._values.push(readValueMessage(g))}function readValueMessage(a){for(var e=null,g=a.readVarint()+a.pos;a.pos<g;)e=a.readVarint()>>3,e=1===e?a.readString():2===e?a.readFloat():3===e?a.readDouble():4===e?a.readVarint64():5===e?a.readVarint():6===e?a.readSVarint():7===e?a.readBoolean():null;return e}VectorTileLayer$2.prototype.feature=function(a){if(0>a||a>=this._features.length)throw Error("feature index out of bounds");this._pbf.pos=this._features[a];a=this._pbf.readVarint()+this._pbf.pos;return new VectorTileFeature$1(this._pbf,a,this.extent,this._keys,this._values)};var VectorTileLayer$1=vectortilelayer,vectortile=VectorTile$1;function VectorTile$1(a,e){this.layers=a.readFields(readTile,{},e)}function readTile(a,e,g){3===a&&(a=new VectorTileLayer$1(g,g.readVarint()+g.pos),a.length&&(e[a.name]=a))}var VectorTile=vectortile;L.VectorGrid.Protobuf=L.VectorGrid.extend({options:{subdomains:"abc",fetchOptions:{}},initialize:function(a,e){this._url=a;L.VectorGrid.prototype.initialize.call(this,e)},setUrl:function(a,e){this._url=a;e||this.redraw();return this},_getSubdomain:L.TileLayer.prototype._getSubdomain,_getVectorTilePromise:function(a){var e={s:this._getSubdomain(a),x:a.x,y:a.y,z:a.z};this._map&&!this._map.options.crs.infinite&&(a=this._globalTileRange.max.y-a.y,this.options.tms&&(e.y=a),e["-y"]=a);e=L.Util.template(this._url,L.extend(e,this.options));return fetch(e,this.options.fetchOptions).then(function(a){return a.ok?a.blob().then(function(a){var e=new FileReader;return new Promise(function(f){e.addEventListener("loadend",function(){var a=new index(e.result);return f(new VectorTile(a))});e.readAsArrayBuffer(a)})}):{layers:[]}}).then(function(a){for(var e in a.layers){for(var g=[],k=0;k<a.layers[e].length;k++){var h=a.layers[e].feature(k);h.geometry=h.loadGeometry();g.push(h)}a.layers[e].features=g}return a})}});L.vectorGrid.protobuf=function(a,e){return new L.VectorGrid.Protobuf(a,e)};var workerCode=__$strToBlobUri("'use strict';\n\nvar simplify_1 \x3d simplify$1;\n\n// calculate simplification data using optimized Douglas-Peucker algorithm\n\nfunction simplify$1(points, tolerance) {\n\n    var sqTolerance \x3d tolerance * tolerance,\n        len \x3d points.length,\n        first \x3d 0,\n        last \x3d len - 1,\n        stack \x3d [],\n        i, maxSqDist, sqDist, index;\n\n    // always retain the endpoints (1 is the max value)\n    points[first][2] \x3d 1;\n    points[last][2] \x3d 1;\n\n    // avoid recursion by using a stack\n    while (last) {\n\n        maxSqDist \x3d 0;\n\n        for (i \x3d first + 1; i \x3c last; i++) {\n            sqDist \x3d getSqSegDist(points[i], points[first], points[last]);\n\n            if (sqDist \x3e maxSqDist) {\n                index \x3d i;\n                maxSqDist \x3d sqDist;\n            }\n        }\n\n        if (maxSqDist \x3e sqTolerance) {\n            points[index][2] \x3d maxSqDist; // save the point importance in squared pixels as a z coordinate\n            stack.push(first);\n            stack.push(index);\n            first \x3d index;\n\n        } else {\n            last \x3d stack.pop();\n            first \x3d stack.pop();\n        }\n    }\n}\n\n// square distance from a point to a segment\nfunction getSqSegDist(p, a, b) {\n\n    var x \x3d a[0], y \x3d a[1],\n        bx \x3d b[0], by \x3d b[1],\n        px \x3d p[0], py \x3d p[1],\n        dx \x3d bx - x,\n        dy \x3d by - y;\n\n    if (dx !\x3d\x3d 0 || dy !\x3d\x3d 0) {\n\n        var t \x3d ((px - x) * dx + (py - y) * dy) / (dx * dx + dy * dy);\n\n        if (t \x3e 1) {\n            x \x3d bx;\n            y \x3d by;\n\n        } else if (t \x3e 0) {\n            x +\x3d dx * t;\n            y +\x3d dy * t;\n        }\n    }\n\n    dx \x3d px - x;\n    dy \x3d py - y;\n\n    return dx * dx + dy * dy;\n}\n\nvar convert_1 \x3d convert$1;\n\nvar simplify \x3d simplify_1;\n\n// converts GeoJSON feature into an intermediate projected JSON vector format with simplification data\n\nfunction convert$1(data, tolerance) {\n    var features \x3d [];\n\n    if (data.type \x3d\x3d\x3d 'FeatureCollection') {\n        for (var i \x3d 0; i \x3c data.features.length; i++) {\n            convertFeature(features, data.features[i], tolerance);\n        }\n    } else if (data.type \x3d\x3d\x3d 'Feature') {\n        convertFeature(features, data, tolerance);\n\n    } else {\n        // single geometry or a geometry collection\n        convertFeature(features, {geometry: data}, tolerance);\n    }\n    return features;\n}\n\nfunction convertFeature(features, feature, tolerance) {\n    if (feature.geometry \x3d\x3d\x3d null) {\n        // ignore features with null geometry\n        return;\n    }\n\n    var geom \x3d feature.geometry,\n        type \x3d geom.type,\n        coords \x3d geom.coordinates,\n        tags \x3d feature.properties,\n        i, j, rings, projectedRing;\n\n    if (type \x3d\x3d\x3d 'Point') {\n        features.push(create(tags, 1, [projectPoint(coords)]));\n\n    } else if (type \x3d\x3d\x3d 'MultiPoint') {\n        features.push(create(tags, 1, project(coords)));\n\n    } else if (type \x3d\x3d\x3d 'LineString') {\n        features.push(create(tags, 2, [project(coords, tolerance)]));\n\n    } else if (type \x3d\x3d\x3d 'MultiLineString' || type \x3d\x3d\x3d 'Polygon') {\n        rings \x3d [];\n        for (i \x3d 0; i \x3c coords.length; i++) {\n            projectedRing \x3d project(coords[i], tolerance);\n            if (type \x3d\x3d\x3d 'Polygon') { projectedRing.outer \x3d (i \x3d\x3d\x3d 0); }\n            rings.push(projectedRing);\n        }\n        features.push(create(tags, type \x3d\x3d\x3d 'Polygon' ? 3 : 2, rings));\n\n    } else if (type \x3d\x3d\x3d 'MultiPolygon') {\n        rings \x3d [];\n        for (i \x3d 0; i \x3c coords.length; i++) {\n            for (j \x3d 0; j \x3c coords[i].length; j++) {\n                projectedRing \x3d project(coords[i][j], tolerance);\n                projectedRing.outer \x3d (j \x3d\x3d\x3d 0);\n                rings.push(projectedRing);\n            }\n        }\n        features.push(create(tags, 3, rings));\n\n    } else if (type \x3d\x3d\x3d 'GeometryCollection') {\n        for (i \x3d 0; i \x3c geom.geometries.length; i++) {\n            convertFeature(features, {\n                geometry: geom.geometries[i],\n                properties: tags\n            }, tolerance);\n        }\n\n    } else {\n        throw new Error('Input data is not a valid GeoJSON object.');\n    }\n}\n\nfunction create(tags, type, geometry) {\n    var feature \x3d {\n        geometry: geometry,\n        type: type,\n        tags: tags || null,\n        min: [2, 1], // initial bbox values;\n        max: [-1, 0]  // note that coords are usually in [0..1] range\n    };\n    calcBBox(feature);\n    return feature;\n}\n\nfunction project(lonlats, tolerance) {\n    var projected \x3d [];\n    for (var i \x3d 0; i \x3c lonlats.length; i++) {\n        projected.push(projectPoint(lonlats[i]));\n    }\n    if (tolerance) {\n        simplify(projected, tolerance);\n        calcSize(projected);\n    }\n    return projected;\n}\n\nfunction projectPoint(p) {\n    var sin \x3d Math.sin(p[1] * Math.PI / 180),\n        x \x3d (p[0] / 360 + 0.5),\n        y \x3d (0.5 - 0.25 * Math.log((1 + sin) / (1 - sin)) / Math.PI);\n\n    y \x3d y \x3c 0 ? 0 :\n        y \x3e 1 ? 1 : y;\n\n    return [x, y, 0];\n}\n\n// calculate area and length of the poly\nfunction calcSize(points) {\n    var area \x3d 0,\n        dist \x3d 0;\n\n    for (var i \x3d 0, a, b; i \x3c points.length - 1; i++) {\n        a \x3d b || points[i];\n        b \x3d points[i + 1];\n\n        area +\x3d a[0] * b[1] - b[0] * a[1];\n\n        // use Manhattan distance instead of Euclidian one to avoid expensive square root computation\n        dist +\x3d Math.abs(b[0] - a[0]) + Math.abs(b[1] - a[1]);\n    }\n    points.area \x3d Math.abs(area / 2);\n    points.dist \x3d dist;\n}\n\n// calculate the feature bounding box for faster clipping later\nfunction calcBBox(feature) {\n    var geometry \x3d feature.geometry,\n        min \x3d feature.min,\n        max \x3d feature.max;\n\n    if (feature.type \x3d\x3d\x3d 1) { calcRingBBox(min, max, geometry); }\n    else { for (var i \x3d 0; i \x3c geometry.length; i++) { calcRingBBox(min, max, geometry[i]); } }\n\n    return feature;\n}\n\nfunction calcRingBBox(min, max, points) {\n    for (var i \x3d 0, p; i \x3c points.length; i++) {\n        p \x3d points[i];\n        min[0] \x3d Math.min(p[0], min[0]);\n        max[0] \x3d Math.max(p[0], max[0]);\n        min[1] \x3d Math.min(p[1], min[1]);\n        max[1] \x3d Math.max(p[1], max[1]);\n    }\n}\n\nvar tile \x3d transformTile;\nvar point \x3d transformPoint;\n\n// Transforms the coordinates of each feature in the given tile from\n// mercator-projected space into (extent x extent) tile space.\nfunction transformTile(tile, extent) {\n    if (tile.transformed) { return tile; }\n\n    var z2 \x3d tile.z2,\n        tx \x3d tile.x,\n        ty \x3d tile.y,\n        i, j, k;\n\n    for (i \x3d 0; i \x3c tile.features.length; i++) {\n        var feature \x3d tile.features[i],\n            geom \x3d feature.geometry,\n            type \x3d feature.type;\n\n        if (type \x3d\x3d\x3d 1) {\n            for (j \x3d 0; j \x3c geom.length; j++) { geom[j] \x3d transformPoint(geom[j], extent, z2, tx, ty); }\n\n        } else {\n            for (j \x3d 0; j \x3c geom.length; j++) {\n                var ring \x3d geom[j];\n                for (k \x3d 0; k \x3c ring.length; k++) { ring[k] \x3d transformPoint(ring[k], extent, z2, tx, ty); }\n            }\n        }\n    }\n\n    tile.transformed \x3d true;\n\n    return tile;\n}\n\nfunction transformPoint(p, extent, z2, tx, ty) {\n    var x \x3d Math.round(extent * (p[0] * z2 - tx)),\n        y \x3d Math.round(extent * (p[1] * z2 - ty));\n    return [x, y];\n}\n\nvar transform$1 \x3d {\n\ttile: tile,\n\tpoint: point\n};\n\nvar clip_1 \x3d clip$1;\n\n/* clip features between two axis-parallel lines:\n *     |        |\n *  ___|___     |     /\n * /   |   ____|____/\n *     |        |\n */\n\nfunction clip$1(features, scale, k1, k2, axis, intersect, minAll, maxAll) {\n\n    k1 /\x3d scale;\n    k2 /\x3d scale;\n\n    if (minAll \x3e\x3d k1 \x26\x26 maxAll \x3c\x3d k2) { return features; } // trivial accept\n    else if (minAll \x3e k2 || maxAll \x3c k1) { return null; } // trivial reject\n\n    var clipped \x3d [];\n\n    for (var i \x3d 0; i \x3c features.length; i++) {\n\n        var feature \x3d features[i],\n            geometry \x3d feature.geometry,\n            type \x3d feature.type,\n            min, max;\n\n        min \x3d feature.min[axis];\n        max \x3d feature.max[axis];\n\n        if (min \x3e\x3d k1 \x26\x26 max \x3c\x3d k2) { // trivial accept\n            clipped.push(feature);\n            continue;\n        } else if (min \x3e k2 || max \x3c k1) { continue; } // trivial reject\n\n        var slices \x3d type \x3d\x3d\x3d 1 ?\n                clipPoints(geometry, k1, k2, axis) :\n                clipGeometry(geometry, k1, k2, axis, intersect, type \x3d\x3d\x3d 3);\n\n        if (slices.length) {\n            // if a feature got clipped, it will likely get clipped on the next zoom level as well,\n            // so there's no need to recalculate bboxes\n            clipped.push({\n                geometry: slices,\n                type: type,\n                tags: features[i].tags || null,\n                min: feature.min,\n                max: feature.max\n            });\n        }\n    }\n\n    return clipped.length ? clipped : null;\n}\n\nfunction clipPoints(geometry, k1, k2, axis) {\n    var slice \x3d [];\n\n    for (var i \x3d 0; i \x3c geometry.length; i++) {\n        var a \x3d geometry[i],\n            ak \x3d a[axis];\n\n        if (ak \x3e\x3d k1 \x26\x26 ak \x3c\x3d k2) { slice.push(a); }\n    }\n    return slice;\n}\n\nfunction clipGeometry(geometry, k1, k2, axis, intersect, closed) {\n\n    var slices \x3d [];\n\n    for (var i \x3d 0; i \x3c geometry.length; i++) {\n\n        var ak \x3d 0,\n            bk \x3d 0,\n            b \x3d null,\n            points \x3d geometry[i],\n            area \x3d points.area,\n            dist \x3d points.dist,\n            outer \x3d points.outer,\n            len \x3d points.length,\n            a, j, last;\n\n        var slice \x3d [];\n\n        for (j \x3d 0; j \x3c len - 1; j++) {\n            a \x3d b || points[j];\n            b \x3d points[j + 1];\n            ak \x3d bk || a[axis];\n            bk \x3d b[axis];\n\n            if (ak \x3c k1) {\n\n                if ((bk \x3e k2)) { // ---|-----|--\x3e\n                    slice.push(intersect(a, b, k1), intersect(a, b, k2));\n                    if (!closed) { slice \x3d newSlice(slices, slice, area, dist, outer); }\n\n                } else if (bk \x3e\x3d k1) { slice.push(intersect(a, b, k1)); } // ---|--\x3e  |\n\n            } else if (ak \x3e k2) {\n\n                if ((bk \x3c k1)) { // \x3c--|-----|---\n                    slice.push(intersect(a, b, k2), intersect(a, b, k1));\n                    if (!closed) { slice \x3d newSlice(slices, slice, area, dist, outer); }\n\n                } else if (bk \x3c\x3d k2) { slice.push(intersect(a, b, k2)); } // |  \x3c--|---\n\n            } else {\n\n                slice.push(a);\n\n                if (bk \x3c k1) { // \x3c--|---  |\n                    slice.push(intersect(a, b, k1));\n                    if (!closed) { slice \x3d newSlice(slices, slice, area, dist, outer); }\n\n                } else if (bk \x3e k2) { // |  ---|--\x3e\n                    slice.push(intersect(a, b, k2));\n                    if (!closed) { slice \x3d newSlice(slices, slice, area, dist, outer); }\n                }\n                // | --\x3e |\n            }\n        }\n\n        // add the last point\n        a \x3d points[len - 1];\n        ak \x3d a[axis];\n        if (ak \x3e\x3d k1 \x26\x26 ak \x3c\x3d k2) { slice.push(a); }\n\n        // close the polygon if its endpoints are not the same after clipping\n\n        last \x3d slice[slice.length - 1];\n        if (closed \x26\x26 last \x26\x26 (slice[0][0] !\x3d\x3d last[0] || slice[0][1] !\x3d\x3d last[1])) { slice.push(slice[0]); }\n\n        // add the final slice\n        newSlice(slices, slice, area, dist, outer);\n    }\n\n    return slices;\n}\n\nfunction newSlice(slices, slice, area, dist, outer) {\n    if (slice.length) {\n        // we don't recalculate the area/length of the unclipped geometry because the case where it goes\n        // below the visibility threshold as a result of clipping is rare, so we avoid doing unnecessary work\n        slice.area \x3d area;\n        slice.dist \x3d dist;\n        if (outer !\x3d\x3d undefined) { slice.outer \x3d outer; }\n\n        slices.push(slice);\n    }\n    return [];\n}\n\nvar clip$2 \x3d clip_1;\n\nvar wrap_1 \x3d wrap$1;\n\nfunction wrap$1(features, buffer, intersectX) {\n    var merged \x3d features,\n        left  \x3d clip$2(features, 1, -1 - buffer, buffer,     0, intersectX, -1, 2), // left world copy\n        right \x3d clip$2(features, 1,  1 - buffer, 2 + buffer, 0, intersectX, -1, 2); // right world copy\n\n    if (left || right) {\n        merged \x3d clip$2(features, 1, -buffer, 1 + buffer, 0, intersectX, -1, 2); // center world copy\n\n        if (left) { merged \x3d shiftFeatureCoords(left, 1).concat(merged); } // merge left into center\n        if (right) { merged \x3d merged.concat(shiftFeatureCoords(right, -1)); } // merge right into center\n    }\n\n    return merged;\n}\n\nfunction shiftFeatureCoords(features, offset) {\n    var newFeatures \x3d [];\n\n    for (var i \x3d 0; i \x3c features.length; i++) {\n        var feature \x3d features[i],\n            type \x3d feature.type;\n\n        var newGeometry;\n\n        if (type \x3d\x3d\x3d 1) {\n            newGeometry \x3d shiftCoords(feature.geometry, offset);\n        } else {\n            newGeometry \x3d [];\n            for (var j \x3d 0; j \x3c feature.geometry.length; j++) {\n                newGeometry.push(shiftCoords(feature.geometry[j], offset));\n            }\n        }\n\n        newFeatures.push({\n            geometry: newGeometry,\n            type: type,\n            tags: feature.tags,\n            min: [feature.min[0] + offset, feature.min[1]],\n            max: [feature.max[0] + offset, feature.max[1]]\n        });\n    }\n\n    return newFeatures;\n}\n\nfunction shiftCoords(points, offset) {\n    var newPoints \x3d [];\n    newPoints.area \x3d points.area;\n    newPoints.dist \x3d points.dist;\n\n    for (var i \x3d 0; i \x3c points.length; i++) {\n        newPoints.push([points[i][0] + offset, points[i][1], points[i][2]]);\n    }\n    return newPoints;\n}\n\nvar tile$1 \x3d createTile$1;\n\nfunction createTile$1(features, z2, tx, ty, tolerance, noSimplify) {\n    var tile \x3d {\n        features: [],\n        numPoints: 0,\n        numSimplified: 0,\n        numFeatures: 0,\n        source: null,\n        x: tx,\n        y: ty,\n        z2: z2,\n        transformed: false,\n        min: [2, 1],\n        max: [-1, 0]\n    };\n    for (var i \x3d 0; i \x3c features.length; i++) {\n        tile.numFeatures++;\n        addFeature(tile, features[i], tolerance, noSimplify);\n\n        var min \x3d features[i].min,\n            max \x3d features[i].max;\n\n        if (min[0] \x3c tile.min[0]) { tile.min[0] \x3d min[0]; }\n        if (min[1] \x3c tile.min[1]) { tile.min[1] \x3d min[1]; }\n        if (max[0] \x3e tile.max[0]) { tile.max[0] \x3d max[0]; }\n        if (max[1] \x3e tile.max[1]) { tile.max[1] \x3d max[1]; }\n    }\n    return tile;\n}\n\nfunction addFeature(tile, feature, tolerance, noSimplify) {\n\n    var geom \x3d feature.geometry,\n        type \x3d feature.type,\n        simplified \x3d [],\n        sqTolerance \x3d tolerance * tolerance,\n        i, j, ring, p;\n\n    if (type \x3d\x3d\x3d 1) {\n        for (i \x3d 0; i \x3c geom.length; i++) {\n            simplified.push(geom[i]);\n            tile.numPoints++;\n            tile.numSimplified++;\n        }\n\n    } else {\n\n        // simplify and transform projected coordinates for tile geometry\n        for (i \x3d 0; i \x3c geom.length; i++) {\n            ring \x3d geom[i];\n\n            // filter out tiny polylines \x26 polygons\n            if (!noSimplify \x26\x26 ((type \x3d\x3d\x3d 2 \x26\x26 ring.dist \x3c tolerance) ||\n                                (type \x3d\x3d\x3d 3 \x26\x26 ring.area \x3c sqTolerance))) {\n                tile.numPoints +\x3d ring.length;\n                continue;\n            }\n\n            var simplifiedRing \x3d [];\n\n            for (j \x3d 0; j \x3c ring.length; j++) {\n                p \x3d ring[j];\n                // keep points with importance \x3e tolerance\n                if (noSimplify || p[2] \x3e sqTolerance) {\n                    simplifiedRing.push(p);\n                    tile.numSimplified++;\n                }\n                tile.numPoints++;\n            }\n\n            if (type \x3d\x3d\x3d 3) { rewind(simplifiedRing, ring.outer); }\n\n            simplified.push(simplifiedRing);\n        }\n    }\n\n    if (simplified.length) {\n        tile.features.push({\n            geometry: simplified,\n            type: type,\n            tags: feature.tags || null\n        });\n    }\n}\n\nfunction rewind(ring, clockwise) {\n    var area \x3d signedArea(ring);\n    if (area \x3c 0 \x3d\x3d\x3d clockwise) { ring.reverse(); }\n}\n\nfunction signedArea(ring) {\n    var sum \x3d 0;\n    for (var i \x3d 0, len \x3d ring.length, j \x3d len - 1, p1, p2; i \x3c len; j \x3d i++) {\n        p1 \x3d ring[i];\n        p2 \x3d ring[j];\n        sum +\x3d (p2[0] - p1[0]) * (p1[1] + p2[1]);\n    }\n    return sum;\n}\n\nvar index \x3d geojsonvt;\n\nvar convert \x3d convert_1;\nvar transform \x3d transform$1;\nvar clip \x3d clip_1;\nvar wrap \x3d wrap_1;\nvar createTile \x3d tile$1;     // final simplified tile generation\n\n\nfunction geojsonvt(data, options) {\n    return new GeoJSONVT(data, options);\n}\n\nfunction GeoJSONVT(data, options) {\n    options \x3d this.options \x3d extend(Object.create(this.options), options);\n\n    var debug \x3d options.debug;\n\n    if (debug) { console.time('preprocess data'); }\n\n    var z2 \x3d 1 \x3c\x3c options.maxZoom, // 2^z\n        features \x3d convert(data, options.tolerance / (z2 * options.extent));\n\n    this.tiles \x3d {};\n    this.tileCoords \x3d [];\n\n    if (debug) {\n        console.timeEnd('preprocess data');\n        console.log('index: maxZoom: %d, maxPoints: %d', options.indexMaxZoom, options.indexMaxPoints);\n        console.time('generate tiles');\n        this.stats \x3d {};\n        this.total \x3d 0;\n    }\n\n    features \x3d wrap(features, options.buffer / options.extent, intersectX);\n\n    // start slicing from the top tile down\n    if (features.length) { this.splitTile(features, 0, 0, 0); }\n\n    if (debug) {\n        if (features.length) { console.log('features: %d, points: %d', this.tiles[0].numFeatures, this.tiles[0].numPoints); }\n        console.timeEnd('generate tiles');\n        console.log('tiles generated:', this.total, JSON.stringify(this.stats));\n    }\n}\n\nGeoJSONVT.prototype.options \x3d {\n    maxZoom: 14,            // max zoom to preserve detail on\n    indexMaxZoom: 5,        // max zoom in the tile index\n    indexMaxPoints: 100000, // max number of points per tile in the tile index\n    solidChildren: false,   // whether to tile solid square tiles further\n    tolerance: 3,           // simplification tolerance (higher means simpler)\n    extent: 4096,           // tile extent\n    buffer: 64,             // tile buffer on each side\n    debug: 0                // logging level (0, 1 or 2)\n};\n\nGeoJSONVT.prototype.splitTile \x3d function (features, z, x, y, cz, cx, cy) {\n    var this$1 \x3d this;\n\n\n    var stack \x3d [features, z, x, y],\n        options \x3d this.options,\n        debug \x3d options.debug,\n        solid \x3d null;\n\n    // avoid recursion by using a processing queue\n    while (stack.length) {\n        y \x3d stack.pop();\n        x \x3d stack.pop();\n        z \x3d stack.pop();\n        features \x3d stack.pop();\n\n        var z2 \x3d 1 \x3c\x3c z,\n            id \x3d toID(z, x, y),\n            tile \x3d this$1.tiles[id],\n            tileTolerance \x3d z \x3d\x3d\x3d options.maxZoom ? 0 : options.tolerance / (z2 * options.extent);\n\n        if (!tile) {\n            if (debug \x3e 1) { console.time('creation'); }\n\n            tile \x3d this$1.tiles[id] \x3d createTile(features, z2, x, y, tileTolerance, z \x3d\x3d\x3d options.maxZoom);\n            this$1.tileCoords.push({z: z, x: x, y: y});\n\n            if (debug) {\n                if (debug \x3e 1) {\n                    console.log('tile z%d-%d-%d (features: %d, points: %d, simplified: %d)',\n                        z, x, y, tile.numFeatures, tile.numPoints, tile.numSimplified);\n                    console.timeEnd('creation');\n                }\n                var key \x3d 'z' + z;\n                this$1.stats[key] \x3d (this$1.stats[key] || 0) + 1;\n                this$1.total++;\n            }\n        }\n\n        // save reference to original geometry in tile so that we can drill down later if we stop now\n        tile.source \x3d features;\n\n        // if it's the first-pass tiling\n        if (!cz) {\n            // stop tiling if we reached max zoom, or if the tile is too simple\n            if (z \x3d\x3d\x3d options.indexMaxZoom || tile.numPoints \x3c\x3d options.indexMaxPoints) { continue; }\n\n        // if a drilldown to a specific tile\n        } else {\n            // stop tiling if we reached base zoom or our target tile zoom\n            if (z \x3d\x3d\x3d options.maxZoom || z \x3d\x3d\x3d cz) { continue; }\n\n            // stop tiling if it's not an ancestor of the target tile\n            var m \x3d 1 \x3c\x3c (cz - z);\n            if (x !\x3d\x3d Math.floor(cx / m) || y !\x3d\x3d Math.floor(cy / m)) { continue; }\n        }\n\n        // stop tiling if the tile is solid clipped square\n        if (!options.solidChildren \x26\x26 isClippedSquare(tile, options.extent, options.buffer)) {\n            if (cz) { solid \x3d z; } // and remember the zoom if we're drilling down\n            continue;\n        }\n\n        // if we slice further down, no need to keep source geometry\n        tile.source \x3d null;\n\n        if (debug \x3e 1) { console.time('clipping'); }\n\n        // values we'll use for clipping\n        var k1 \x3d 0.5 * options.buffer / options.extent,\n            k2 \x3d 0.5 - k1,\n            k3 \x3d 0.5 + k1,\n            k4 \x3d 1 + k1,\n            tl, bl, tr, br, left, right;\n\n        tl \x3d bl \x3d tr \x3d br \x3d null;\n\n        left  \x3d clip(features, z2, x - k1, x + k3, 0, intersectX, tile.min[0], tile.max[0]);\n        right \x3d clip(features, z2, x + k2, x + k4, 0, intersectX, tile.min[0], tile.max[0]);\n\n        if (left) {\n            tl \x3d clip(left, z2, y - k1, y + k3, 1, intersectY, tile.min[1], tile.max[1]);\n            bl \x3d clip(left, z2, y + k2, y + k4, 1, intersectY, tile.min[1], tile.max[1]);\n        }\n\n        if (right) {\n            tr \x3d clip(right, z2, y - k1, y + k3, 1, intersectY, tile.min[1], tile.max[1]);\n            br \x3d clip(right, z2, y + k2, y + k4, 1, intersectY, tile.min[1], tile.max[1]);\n        }\n\n        if (debug \x3e 1) { console.timeEnd('clipping'); }\n\n        if (tl) { stack.push(tl, z + 1, x * 2,     y * 2); }\n        if (bl) { stack.push(bl, z + 1, x * 2,     y * 2 + 1); }\n        if (tr) { stack.push(tr, z + 1, x * 2 + 1, y * 2); }\n        if (br) { stack.push(br, z + 1, x * 2 + 1, y * 2 + 1); }\n    }\n\n    return solid;\n};\n\nGeoJSONVT.prototype.getTile \x3d function (z, x, y) {\n    var this$1 \x3d this;\n\n    var options \x3d this.options,\n        extent \x3d options.extent,\n        debug \x3d options.debug;\n\n    var z2 \x3d 1 \x3c\x3c z;\n    x \x3d ((x % z2) + z2) % z2; // wrap tile x coordinate\n\n    var id \x3d toID(z, x, y);\n    if (this.tiles[id]) { return transform.tile(this.tiles[id], extent); }\n\n    if (debug \x3e 1) { console.log('drilling down to z%d-%d-%d', z, x, y); }\n\n    var z0 \x3d z,\n        x0 \x3d x,\n        y0 \x3d y,\n        parent;\n\n    while (!parent \x26\x26 z0 \x3e 0) {\n        z0--;\n        x0 \x3d Math.floor(x0 / 2);\n        y0 \x3d Math.floor(y0 / 2);\n        parent \x3d this$1.tiles[toID(z0, x0, y0)];\n    }\n\n    if (!parent || !parent.source) { return null; }\n\n    // if we found a parent tile containing the original geometry, we can drill down from it\n    if (debug \x3e 1) { console.log('found parent tile z%d-%d-%d', z0, x0, y0); }\n\n    // it parent tile is a solid clipped square, return it instead since it's identical\n    if (isClippedSquare(parent, extent, options.buffer)) { return transform.tile(parent, extent); }\n\n    if (debug \x3e 1) { console.time('drilling down'); }\n    var solid \x3d this.splitTile(parent.source, z0, x0, y0, z, x, y);\n    if (debug \x3e 1) { console.timeEnd('drilling down'); }\n\n    // one of the parent tiles was a solid clipped square\n    if (solid !\x3d\x3d null) {\n        var m \x3d 1 \x3c\x3c (z - solid);\n        id \x3d toID(solid, Math.floor(x / m), Math.floor(y / m));\n    }\n\n    return this.tiles[id] ? transform.tile(this.tiles[id], extent) : null;\n};\n\nfunction toID(z, x, y) {\n    return (((1 \x3c\x3c z) * y + x) * 32) + z;\n}\n\nfunction intersectX(a, b, x) {\n    return [x, (x - a[0]) * (b[1] - a[1]) / (b[0] - a[0]) + a[1], 1];\n}\nfunction intersectY(a, b, y) {\n    return [(y - a[1]) * (b[0] - a[0]) / (b[1] - a[1]) + a[0], y, 1];\n}\n\nfunction extend(dest, src) {\n    for (var i in src) { dest[i] \x3d src[i]; }\n    return dest;\n}\n\n// checks whether a tile is a whole-area fill after clipping; if it is, there's no sense slicing it further\nfunction isClippedSquare(tile, extent, buffer) {\n\n    var features \x3d tile.source;\n    if (features.length !\x3d\x3d 1) { return false; }\n\n    var feature \x3d features[0];\n    if (feature.type !\x3d\x3d 3 || feature.geometry.length \x3e 1) { return false; }\n\n    var len \x3d feature.geometry[0].length;\n    if (len !\x3d\x3d 5) { return false; }\n\n    for (var i \x3d 0; i \x3c len; i++) {\n        var p \x3d transform.point(feature.geometry[0][i], extent, tile.z2, tile.x, tile.y);\n        if ((p[0] !\x3d\x3d -buffer \x26\x26 p[0] !\x3d\x3d extent + buffer) ||\n            (p[1] !\x3d\x3d -buffer \x26\x26 p[1] !\x3d\x3d extent + buffer)) { return false; }\n    }\n\n    return true;\n}\n\nvar identity \x3d function(x) {\n  return x;\n};\n\nvar transform$3 \x3d function(topology) {\n  if ((transform \x3d topology.transform) \x3d\x3d null) { return identity; }\n  var transform,\n      x0,\n      y0,\n      kx \x3d transform.scale[0],\n      ky \x3d transform.scale[1],\n      dx \x3d transform.translate[0],\n      dy \x3d transform.translate[1];\n  return function(point, i) {\n    if (!i) { x0 \x3d y0 \x3d 0; }\n    point[0] \x3d (x0 +\x3d point[0]) * kx + dx;\n    point[1] \x3d (y0 +\x3d point[1]) * ky + dy;\n    return point;\n  };\n};\n\nvar bbox \x3d function(topology) {\n  var bbox \x3d topology.bbox;\n\n  function bboxPoint(p0) {\n    p1[0] \x3d p0[0], p1[1] \x3d p0[1], t(p1);\n    if (p1[0] \x3c x0) { x0 \x3d p1[0]; }\n    if (p1[0] \x3e x1) { x1 \x3d p1[0]; }\n    if (p1[1] \x3c y0) { y0 \x3d p1[1]; }\n    if (p1[1] \x3e y1) { y1 \x3d p1[1]; }\n  }\n\n  function bboxGeometry(o) {\n    switch (o.type) {\n      case \"GeometryCollection\": o.geometries.forEach(bboxGeometry); break;\n      case \"Point\": bboxPoint(o.coordinates); break;\n      case \"MultiPoint\": o.coordinates.forEach(bboxPoint); break;\n    }\n  }\n\n  if (!bbox) {\n    var t \x3d transform$3(topology), p0, p1 \x3d new Array(2), name,\n        x0 \x3d Infinity, y0 \x3d x0, x1 \x3d -x0, y1 \x3d -x0;\n\n    topology.arcs.forEach(function(arc) {\n      var i \x3d -1, n \x3d arc.length;\n      while (++i \x3c n) {\n        p0 \x3d arc[i], p1[0] \x3d p0[0], p1[1] \x3d p0[1], t(p1, i);\n        if (p1[0] \x3c x0) { x0 \x3d p1[0]; }\n        if (p1[0] \x3e x1) { x1 \x3d p1[0]; }\n        if (p1[1] \x3c y0) { y0 \x3d p1[1]; }\n        if (p1[1] \x3e y1) { y1 \x3d p1[1]; }\n      }\n    });\n\n    for (name in topology.objects) {\n      bboxGeometry(topology.objects[name]);\n    }\n\n    bbox \x3d topology.bbox \x3d [x0, y0, x1, y1];\n  }\n\n  return bbox;\n};\n\nvar reverse \x3d function(array, n) {\n  var t, j \x3d array.length, i \x3d j - n;\n  while (i \x3c --j) { t \x3d array[i], array[i++] \x3d array[j], array[j] \x3d t; }\n};\n\nvar feature \x3d function(topology, o) {\n  return o.type \x3d\x3d\x3d \"GeometryCollection\"\n      ? {type: \"FeatureCollection\", features: o.geometries.map(function(o) { return feature$1(topology, o); })}\n      : feature$1(topology, o);\n};\n\nfunction feature$1(topology, o) {\n  var id \x3d o.id,\n      bbox \x3d o.bbox,\n      properties \x3d o.properties \x3d\x3d null ? {} : o.properties,\n      geometry \x3d object(topology, o);\n  return id \x3d\x3d null \x26\x26 bbox \x3d\x3d null ? {type: \"Feature\", properties: properties, geometry: geometry}\n      : bbox \x3d\x3d null ? {type: \"Feature\", id: id, properties: properties, geometry: geometry}\n      : {type: \"Feature\", id: id, bbox: bbox, properties: properties, geometry: geometry};\n}\n\nfunction object(topology, o) {\n  var transformPoint \x3d transform$3(topology),\n      arcs \x3d topology.arcs;\n\n  function arc(i, points) {\n    if (points.length) { points.pop(); }\n    for (var a \x3d arcs[i \x3c 0 ? ~i : i], k \x3d 0, n \x3d a.length; k \x3c n; ++k) {\n      points.push(transformPoint(a[k].slice(), k));\n    }\n    if (i \x3c 0) { reverse(points, n); }\n  }\n\n  function point(p) {\n    return transformPoint(p.slice());\n  }\n\n  function line(arcs) {\n    var points \x3d [];\n    for (var i \x3d 0, n \x3d arcs.length; i \x3c n; ++i) { arc(arcs[i], points); }\n    if (points.length \x3c 2) { points.push(points[0].slice()); }\n    return points;\n  }\n\n  function ring(arcs) {\n    var points \x3d line(arcs);\n    while (points.length \x3c 4) { points.push(points[0].slice()); }\n    return points;\n  }\n\n  function polygon(arcs) {\n    return arcs.map(ring);\n  }\n\n  function geometry(o) {\n    var type \x3d o.type, coordinates;\n    switch (type) {\n      case \"GeometryCollection\": return {type: type, geometries: o.geometries.map(geometry)};\n      case \"Point\": coordinates \x3d point(o.coordinates); break;\n      case \"MultiPoint\": coordinates \x3d o.coordinates.map(point); break;\n      case \"LineString\": coordinates \x3d line(o.arcs); break;\n      case \"MultiLineString\": coordinates \x3d o.arcs.map(line); break;\n      case \"Polygon\": coordinates \x3d polygon(o.arcs); break;\n      case \"MultiPolygon\": coordinates \x3d o.arcs.map(polygon); break;\n      default: return null;\n    }\n    return {type: type, coordinates: coordinates};\n  }\n\n  return geometry(o);\n}\n\nvar stitch \x3d function(topology, arcs) {\n  var stitchedArcs \x3d {},\n      fragmentByStart \x3d {},\n      fragmentByEnd \x3d {},\n      fragments \x3d [],\n      emptyIndex \x3d -1;\n\n  // Stitch empty arcs first, since they may be subsumed by other arcs.\n  arcs.forEach(function(i, j) {\n    var arc \x3d topology.arcs[i \x3c 0 ? ~i : i], t;\n    if (arc.length \x3c 3 \x26\x26 !arc[1][0] \x26\x26 !arc[1][1]) {\n      t \x3d arcs[++emptyIndex], arcs[emptyIndex] \x3d i, arcs[j] \x3d t;\n    }\n  });\n\n  arcs.forEach(function(i) {\n    var e \x3d ends(i),\n        start \x3d e[0],\n        end \x3d e[1],\n        f, g;\n\n    if (f \x3d fragmentByEnd[start]) {\n      delete fragmentByEnd[f.end];\n      f.push(i);\n      f.end \x3d end;\n      if (g \x3d fragmentByStart[end]) {\n        delete fragmentByStart[g.start];\n        var fg \x3d g \x3d\x3d\x3d f ? f : f.concat(g);\n        fragmentByStart[fg.start \x3d f.start] \x3d fragmentByEnd[fg.end \x3d g.end] \x3d fg;\n      } else {\n        fragmentByStart[f.start] \x3d fragmentByEnd[f.end] \x3d f;\n      }\n    } else if (f \x3d fragmentByStart[end]) {\n      delete fragmentByStart[f.start];\n      f.unshift(i);\n      f.start \x3d start;\n      if (g \x3d fragmentByEnd[start]) {\n        delete fragmentByEnd[g.end];\n        var gf \x3d g \x3d\x3d\x3d f ? f : g.concat(f);\n        fragmentByStart[gf.start \x3d g.start] \x3d fragmentByEnd[gf.end \x3d f.end] \x3d gf;\n      } else {\n        fragmentByStart[f.start] \x3d fragmentByEnd[f.end] \x3d f;\n      }\n    } else {\n      f \x3d [i];\n      fragmentByStart[f.start \x3d start] \x3d fragmentByEnd[f.end \x3d end] \x3d f;\n    }\n  });\n\n  function ends(i) {\n    var arc \x3d topology.arcs[i \x3c 0 ? ~i : i], p0 \x3d arc[0], p1;\n    if (topology.transform) { p1 \x3d [0, 0], arc.forEach(function(dp) { p1[0] +\x3d dp[0], p1[1] +\x3d dp[1]; }); }\n    else { p1 \x3d arc[arc.length - 1]; }\n    return i \x3c 0 ? [p1, p0] : [p0, p1];\n  }\n\n  function flush(fragmentByEnd, fragmentByStart) {\n    for (var k in fragmentByEnd) {\n      var f \x3d fragmentByEnd[k];\n      delete fragmentByStart[f.start];\n      delete f.start;\n      delete f.end;\n      f.forEach(function(i) { stitchedArcs[i \x3c 0 ? ~i : i] \x3d 1; });\n      fragments.push(f);\n    }\n  }\n\n  flush(fragmentByEnd, fragmentByStart);\n  flush(fragmentByStart, fragmentByEnd);\n  arcs.forEach(function(i) { if (!stitchedArcs[i \x3c 0 ? ~i : i]) { fragments.push([i]); } });\n\n  return fragments;\n};\n\nfunction extractArcs(topology, object$$1, filter) {\n  var arcs \x3d [],\n      geomsByArc \x3d [],\n      geom;\n\n  function extract0(i) {\n    var j \x3d i \x3c 0 ? ~i : i;\n    (geomsByArc[j] || (geomsByArc[j] \x3d [])).push({i: i, g: geom});\n  }\n\n  function extract1(arcs) {\n    arcs.forEach(extract0);\n  }\n\n  function extract2(arcs) {\n    arcs.forEach(extract1);\n  }\n\n  function extract3(arcs) {\n    arcs.forEach(extract2);\n  }\n\n  function geometry(o) {\n    switch (geom \x3d o, o.type) {\n      case \"GeometryCollection\": o.geometries.forEach(geometry); break;\n      case \"LineString\": extract1(o.arcs); break;\n      case \"MultiLineString\": case \"Polygon\": extract2(o.arcs); break;\n      case \"MultiPolygon\": extract3(o.arcs); break;\n    }\n  }\n\n  geometry(object$$1);\n\n  geomsByArc.forEach(filter \x3d\x3d null\n      ? function(geoms) { arcs.push(geoms[0].i); }\n      : function(geoms) { if (filter(geoms[0].g, geoms[geoms.length - 1].g)) { arcs.push(geoms[0].i); } });\n\n  return arcs;\n}\n\nfunction planarRingArea(ring) {\n  var i \x3d -1, n \x3d ring.length, a, b \x3d ring[n - 1], area \x3d 0;\n  while (++i \x3c n) { a \x3d b, b \x3d ring[i], area +\x3d a[0] * b[1] - a[1] * b[0]; }\n  return Math.abs(area); // Note: doubled area!\n}\n\nvar bisect \x3d function(a, x) {\n  var lo \x3d 0, hi \x3d a.length;\n  while (lo \x3c hi) {\n    var mid \x3d lo + hi \x3e\x3e\x3e 1;\n    if (a[mid] \x3c x) { lo \x3d mid + 1; }\n    else { hi \x3d mid; }\n  }\n  return lo;\n};\n\nvar slicers \x3d {};\nvar options;\n\nonmessage \x3d function (e) {\n\tif (e.data[0] \x3d\x3d\x3d 'slice') {\n\t\t// Given a blob of GeoJSON and some topojson/geojson-vt options, do the slicing.\n\t\tvar geojson \x3d e.data[1];\n\t\toptions     \x3d e.data[2];\n\n\t\tif (geojson.type \x26\x26 geojson.type \x3d\x3d\x3d 'Topology') {\n\t\t\tfor (var layerName in geojson.objects) {\n\t\t\t\tslicers[layerName] \x3d index(\n\t\t\t\t\tfeature(geojson, geojson.objects[layerName])\n\t\t\t\t, options);\n\t\t\t}\n\t\t} else {\n\t\t\tslicers[options.vectorTileLayerName] \x3d index(geojson, options);\n\t\t}\n\n\t} else if (e.data[0] \x3d\x3d\x3d 'get') {\n\t\t// Gets the vector tile for the given coordinates, sends it back as a message\n\t\tvar coords \x3d e.data[1];\n\n\t\tvar tileLayers \x3d {};\n\t\tfor (var layerName in slicers) {\n\t\t\tvar slicedTileLayer \x3d slicers[layerName].getTile(coords.z, coords.x, coords.y);\n\n\t\t\tif (slicedTileLayer) {\n\t\t\t\tvar vectorTileLayer \x3d {\n\t\t\t\t\tfeatures: [],\n\t\t\t\t\textent: options.extent,\n\t\t\t\t\tname: options.vectorTileLayerName,\n\t\t\t\t\tlength: slicedTileLayer.features.length\n\t\t\t\t};\n\n\t\t\t\tfor (var i in slicedTileLayer.features) {\n\t\t\t\t\tvar feat \x3d {\n\t\t\t\t\t\tgeometry: slicedTileLayer.features[i].geometry,\n\t\t\t\t\t\tproperties: slicedTileLayer.features[i].tags,\n\t\t\t\t\t\ttype: slicedTileLayer.features[i].type\t// 1 \x3d point, 2 \x3d line, 3 \x3d polygon\n\t\t\t\t\t};\n\t\t\t\t\tvectorTileLayer.features.push(feat);\n\t\t\t\t}\n\t\t\t\ttileLayers[layerName] \x3d vectorTileLayer;\n\t\t\t}\n\t\t}\n\t\tpostMessage({ layers: tileLayers, coords: coords });\n\t}\n};\n//# sourceMappingURL\x3dslicerWebWorker.js.worker.map\n","text/plain; charset\x3dus-ascii",!1);L.VectorGrid.Slicer=L.VectorGrid.extend({options:{vectorTileLayerName:"sliced",extent:4096,maxZoom:14},initialize:function(a,e){L.VectorGrid.prototype.initialize.call(this,e);e={};for(var g in this.options)"rendererFactory"!==g&&"vectorTileLayerStyles"!==g&&"function"!==typeof this.options[g]&&(e[g]=this.options[g]);this._worker=new Worker(workerCode);this._worker.postMessage(["slice",a,e])},_getVectorTilePromise:function(a){var e=this,g=new Promise(function(f){e._worker.addEventListener("message",function k(h){h.data.coords&&h.data.coords.x===a.x&&h.data.coords.y===a.y&&h.data.coords.z===a.z&&(f(h.data),e._worker.removeEventListener("message",k))})});this._worker.postMessage(["get",a]);return g}});L.vectorGrid.slicer=function(a,e){return new L.VectorGrid.Slicer(a,e)};L.Canvas.Tile=L.Canvas.extend({initialize:function(a,e,g){L.Canvas.prototype.initialize.call(this,g);this._tileCoord=a;this._size=e;this._initContainer();this._container.setAttribute("width",this._size.x);this._container.setAttribute("height",this._size.y);this._layers={};this._drawnLayers={};this._drawing=!0;g.interactive&&(this._container.style.pointerEvents="auto")},getCoord:function(){return this._tileCoord},getContainer:function(){return this._container},getOffset:function(){return this._tileCoord.scaleBy(this._size).subtract(this._map.getPixelOrigin())},onAdd:L.Util.falseFn,addTo:function(a){this._map=a},removeFrom:function(a){delete this._map},_onClick:function(a){var e=this._map.mouseEventToLayerPoint(a).subtract(this.getOffset()),g,f,m;for(m in this._layers)g=this._layers[m],g.options.interactive&&g._containsPoint(e)&&!this._map._draggableMoved(g)&&(f=g);f&&(L.DomEvent.fakeStop(a),this._fireEvent([f],a))},_onMouseMove:function(a){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(a).subtract(this.getOffset());this._handleMouseHover(a,e)}},_updateIcon:function(a){if(this._drawing){var e=a.options.icon.options,g=L.point(e.iconSize),e=e.iconAnchor||g&&g.divideBy(2,!0),f=a._point.subtract(e),m=this._ctx,k=a._getImage();if(k.complete)m.drawImage(k,f.x,f.y,g.x,g.y);else L.DomEvent.on(k,"load",function(){m.drawImage(k,f.x,f.y,g.x,g.y)});this._drawnLayers[a._leaflet_id]=a}}});L.canvas.tile=function(a,e,g){return new L.Canvas.Tile(a,e,g)};!function(){function a(e){return this instanceof a?(this._canvas=e="string"==typeof e?document.getElementById(e):e,this._ctx=e.getContext("2d"),this._width=e.width,this._height=e.height,this._max=1,void this.clear()):new a(e)}a.prototype={defaultRadius:25,defaultGradient:{"0.4":"blue","0.6":"cyan","0.7":"lime","0.8":"yellow",1:"red"},data:function(a,g){return this._data=a,this},max:function(a){return this._max=a,this},add:function(a){return this._data.push(a),this},clear:function(){return this._data=[],this},radius:function(a,g){g=g||15;var e=this._circle=document.createElement("canvas"),m=e.getContext("2d"),k=this._r=a+g;return e.width=e.height=2*k,m.shadowOffsetX=m.shadowOffsetY=200,m.shadowBlur=g,m.shadowColor="black",m.beginPath(),m.arc(k-200,k-200,a,0,2*Math.PI,!0),m.closePath(),m.fill(),this},gradient:function(a){var e=document.createElement("canvas"),f=e.getContext("2d"),m=f.createLinearGradient(0,0,0,256);e.width=1;e.height=256;for(var k in a)m.addColorStop(k,a[k]);return f.fillStyle=m,f.fillRect(0,0,1,256),this._grad=f.getImageData(0,0,1,256).data,this},draw:function(a){this._circle||this.radius(this.defaultRadius);this._grad||this.gradient(this.defaultGradient);var e=this._ctx;e.clearRect(0,0,this._width,this._height);for(var f,m=0,k=this._data.length;k>m;m++)f=this._data[m],e.globalAlpha=Math.max(f[2]/this._max,a||.05),e.drawImage(this._circle,f[0]-this._r,f[1]-this._r);a=e.getImageData(0,0,this._width,this._height);return this._colorize(a.data,this._grad),e.putImageData(a,0,0),this},_colorize:function(a,g){for(var e,m=3,k=a.length;k>m;m+=4)(e=4*a[m])&&(a[m-3]=g[e],a[m-2]=g[e+1],a[m-1]=g[e+2])}};window.simpleheat=a}();L.HeatLayer=(L.Layer?L.Layer:L.Class).extend({initialize:function(a,e){this._latlngs=a;L.setOptions(this,e);var g=e||{};this._minZoom=void 0!=g.minZoom?g.minZoom:0;this._maxZoom=void 0!=g.maxZoom?g.maxZoom:22;this._isShow=!0},setLatLngs:function(a){return this._latlngs=a,this.redraw()},addLatLng:function(a){return this._latlngs.push(a),this.redraw()},setOptions:function(a){return L.setOptions(this,a),this._heat&&this._updateOptions(),this.redraw()},redraw:function(){return!this._heat||this._frame||this._map._animating||(this._frame=L.Util.requestAnimFrame(this._redraw,this)),this},onAdd:function(a){this._map=a;this._canvas||this._initCanvas();this._isShow&&a._panes.overlayPane.appendChild(this._canvas);a.on("moveend",this._reset,this);a.options.zoomAnimation&&L.Browser.any3d&&a.on("zoomanim",this._animateZoom,this);this._reset()},onRemove:function(a){this._isShow&&a.getPanes().overlayPane.removeChild(this._canvas);a.off("moveend",this._reset,this);a.options.zoomAnimation&&a.off("zoomanim",this._animateZoom,this)},removeCanvas:function(a){a.getPanes().overlayPane.removeChild(this._canvas);this._isShow=!1},removeEvent:function(){t.on("moveend",this._reset,this);t.options.zoomAnimation&&L.Browser.any3d&&t.on("zoomanim",this._animateZoom,this);this._reset()},addEvent:function(){t.off("moveend",this._reset,this);t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this)},addCanvas:function(a){this._map=a;this._canvas||this._initCanvas();a._panes.overlayPane.appendChild(this._canvas);this._reset();this._isShow=!0},getShowState:function(){return this._isShow},addTo:function(a){return a.addLayer(this),this},_initCanvas:function(){var a=this._canvas=L.DomUtil.create("canvas","leaflet-heatmap-layer leaflet-layer"),e=L.DomUtil.testProp(["transformOrigin","WebkitTransformOrigin","msTransformOrigin"]);a.style[e]="50% 50%";e=this._map.getSize();a.width=e.x;a.height=e.y;L.DomUtil.addClass(a,"leaflet-zoom-"+(this._map.options.zoomAnimation&&L.Browser.any3d?"animated":"hide"));this._heat=simpleheat(a);this._updateOptions()},_updateOptions:function(){this._heat.radius(this.options.radius||this._heat.defaultRadius,this.options.blur);this.options.gradient&&this._heat.gradient(this.options.gradient);this.options.max&&this._heat.max(this.options.max)},_reset:function(){var a=this._map.getZoom();a>=this._minZoom&&a<=this._maxZoom&&(a=this._map.containerPointToLayerPoint([0,0]),L.DomUtil.setPosition(this._canvas,a),a=this._map.getSize(),this._heat._width!==a.x&&(this._canvas.width=this._heat._width=a.x),this._heat._height!==a.y&&(this._canvas.height=this._heat._height=a.y),this._redraw())},_redraw:function(){var a,e,g,f,m,k,h,q,p=[],u=this._heat._r,v=this._map.getSize();h=new L.Bounds(L.point([-u,-u]),v.add([u,u]));v=void 0===this.options.max?1:this.options.max;a=void 0===this.options.maxZoom?this._map.getMaxZoom():this.options.maxZoom;var z=1/Math.pow(2,Math.max(0,Math.min(a-this._map.getZoom(),12))),w=u/2,u=[];a=this._map._getMapPanePos();var F=a.x%w,E=a.y%w;a=0;for(e=this._latlngs.length;e>a;a++)if(g=this._map.latLngToContainerPoint(this._latlngs[a]),h.contains(g))m=Math.floor((g.x-F)/w)+2,k=Math.floor((g.y-E)/w)+2,q=(void 0!==this._latlngs[a].alt?this._latlngs[a].alt:void 0!==this._latlngs[a][2]?+this._latlngs[a][2]:1)*z,u[k]=u[k]||[],(f=u[k][m])?(f[0]=(f[0]*f[2]+g.x*q)/(f[2]+q),f[1]=(f[1]*f[2]+g.y*q)/(f[2]+q),f[2]+=q):u[k][m]=[g.x,g.y,q];a=0;for(e=u.length;e>a;a++)if(u[a])for(g=0,h=u[a].length;h>g;g++)(f=u[a][g])&&p.push([Math.round(f[0]),Math.round(f[1]),Math.min(f[2],v)]);this._heat.data(p).draw(this.options.minOpacity);this._frame=null},_animateZoom:function(a){var e=this._map.getZoomScale(a.zoom);a=this._map._getCenterOffset(a.center)._multiplyBy(-e).subtract(this._map._getMapPanePos());L.DomUtil.setTransform?L.DomUtil.setTransform(this._canvas,a,e):this._canvas.style[L.DomUtil.TRANSFORM]=L.DomUtil.getTranslateString(a)+" scale("+e+")"}});L.heatLayer=function(a,e){return new L.HeatLayer(a,e)};L.TileLayer.WMTS=L.TileLayer.extend({defaultWmtsParams:{service:"WMTS",request:"GetTile",version:"1.0.0",layers:"",styles:"",tilematrixSet:"",format:"image/jpeg"},initialize:function(a,e){this._url=a;var g=L.extend({},this.defaultWmtsParams),f=e.tileSize||this.options.tileSize;g.width=e.detectRetina&&L.Browser.retina?g.height=2*f:g.height=f;for(var m in e)this.options.hasOwnProperty(m)||"matrixIds"==m||(g[m]=e[m]);this.wmtsParams=g;this.matrixIds=e.matrixIds||this.getDefaultMatrix();L.setOptions(this,e)},onAdd:function(a){this._crs=this.options.crs||a.options.crs;L.TileLayer.prototype.onAdd.call(this,a)},getTileUrl:function(a){var e=this.options.tileSize,g=a.multiplyBy(e);g.x+=1;--g.y;var f=g.add(new L.Point(e,e)),e=this._tileZoom,m=this._crs.project(this._map.unproject(g,e)),k=this._crs.project(this._map.unproject(f,e)).x-m.x,g=this.matrixIds[e].identifier,f=Math.floor((m.x-this.matrixIds[e].topLeftCorner.lng)/k),e=-Math.floor((m.y-this.matrixIds[e].topLeftCorner.lat)/k);a=L.Util.template(this._url,{s:this._getSubdomain(a)});return a+L.Util.getParamString(this.wmtsParams,a)+"\x26tilematrix\x3d"+g+"\x26tilerow\x3d"+e+"\x26tilecol\x3d"+f},setParams:function(a,e){L.extend(this.wmtsParams,a);e||this.redraw();return this},getDefaultMatrix:function(){for(var a=Array(22),e=0;22>e;e++)a[e]={identifier:""+e,topLeftCorner:new L.LatLng(2.00375083428E7,-2.00375083428E7)};return a}});L.tileLayer.wmts=function(a,e){return new L.TileLayer.WMTS(a,e)};!function(a,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):a.proj4=e()}(this,function(){function a(b,a){if(b[a])return b[a];for(var c,e=Object.keys(b),l=a.toLowerCase().replace(Ea,""),f=-1;++f<e.length;)if(c=e[f],c.toLowerCase().replace(Ea,"")===l)return b[c]}function e(b){if("string"!=typeof b)throw Error("not a string");this.text=b.trim();this.place=this.level=0;this.root=null;this.stack=[];this.currentObject=null;this.state=ta}function g(b,a,c){Array.isArray(a)&&(c.unshift(a),a=null);c=c.reduce(function(b,a){return f(a,b),b},a?{}:b);a&&(b[a]=c)}function f(b,a){if(Array.isArray(b)){var c=b.shift();if("PARAMETER"===c&&(c=b.shift()),1===b.length)return Array.isArray(b[0])?(a[c]={},void f(b[0],a[c])):void(a[c]=b[0]);if(b.length)if("TOWGS84"!==c){Array.isArray(c)||(a[c]={});var e;switch(c){case "UNIT":case "PRIMEM":case "VERT_DATUM":return a[c]={name:b[0].toLowerCase(),convert:b[1]},void(3===b.length&&f(b[2],a[c]));case "SPHEROID":case "ELLIPSOID":return a[c]={name:b[0],a:b[1],rf:b[2]},void(4===b.length&&f(b[3],a[c]));case "PROJECTEDCRS":case "PROJCRS":case "GEOGCS":case "GEOCCS":case "PROJCS":case "LOCAL_CS":case "GEODCRS":case "GEODETICCRS":case "GEODETICDATUM":case "EDATUM":case "ENGINEERINGDATUM":case "VERT_CS":case "VERTCRS":case "VERTICALCRS":case "COMPD_CS":case "COMPOUNDCRS":case "ENGINEERINGCRS":case "ENGCRS":case "FITTED_CS":case "LOCAL_DATUM":case "DATUM":return b[0]=["name",b[0]],void g(a,c,b);default:for(e=-1;++e<b.length;)if(!Array.isArray(b[e]))return f(b,a[c]);return g(a,c,b)}}else a[c]=b;else a[c]=!0}else a[b]=!0}function m(b){return b*ga}function k(b){function a(a){return a*(b.to_meter||1)}"GEOGCS"===b.type?b.projName="longlat":"LOCAL_CS"===b.type?(b.projName="identity",b.local=!0):"object"==typeof b.PROJECTION?b.projName=Object.keys(b.PROJECTION)[0]:b.projName=b.PROJECTION;b.UNIT&&(b.units=b.UNIT.name.toLowerCase(),"metre"===b.units&&(b.units="meter"),b.UNIT.convert&&("GEOGCS"===b.type?b.DATUM&&b.DATUM.SPHEROID&&(b.to_meter=b.UNIT.convert*b.DATUM.SPHEROID.a):b.to_meter=b.UNIT.convert));var c=b.GEOGCS;"GEOGCS"===b.type&&(c=b);c&&(c.DATUM?b.datumCode=c.DATUM.name.toLowerCase():b.datumCode=c.name.toLowerCase(),"d_"===b.datumCode.slice(0,2)&&(b.datumCode=b.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==b.datumCode&&"new_zealand_1949"!==b.datumCode||(b.datumCode="nzgd49"),"wgs_1984"===b.datumCode&&("Mercator_Auxiliary_Sphere"===b.PROJECTION&&(b.sphere=!0),b.datumCode="wgs84"),"_ferro"===b.datumCode.slice(-6)&&(b.datumCode=b.datumCode.slice(0,-6)),"_jakarta"===b.datumCode.slice(-8)&&(b.datumCode=b.datumCode.slice(0,-8)),~b.datumCode.indexOf("belge")&&(b.datumCode="rnb72"),c.DATUM&&c.DATUM.SPHEROID&&(b.ellps=c.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===b.ellps.toLowerCase().slice(0,13)&&(b.ellps="intl"),b.a=c.DATUM.SPHEROID.a,b.rf=parseFloat(c.DATUM.SPHEROID.rf,10)),c.DATUM&&c.DATUM.TOWGS84&&(b.datum_params=c.DATUM.TOWGS84),~b.datumCode.indexOf("osgb_1936")&&(b.datumCode="osgb36"),~b.datumCode.indexOf("osni_1952")&&(b.datumCode="osni52"),(~b.datumCode.indexOf("tm65")||~b.datumCode.indexOf("geodetic_datum_of_1965"))&&(b.datumCode="ire65"),"ch1903+"===b.datumCode&&(b.datumCode="ch1903"),~b.datumCode.indexOf("israel")&&(b.datumCode="isr93"));b.b&&!isFinite(b.b)&&(b.b=b.a);[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",m],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",m],["x0","false_easting",a],["y0","false_northing",a],["long0","central_meridian",m],["lat0","latitude_of_origin",m],["lat0","standard_parallel_1",m],["lat1","standard_parallel_1",m],["lat2","standard_parallel_2",m],["azimuth","Azimuth"],["alpha","azimuth",m],["srsCode","name"]].forEach(function(a){var c=a[0],e=a[1];!(c in b)&&e in b&&(b[c]=b[e],3===a.length&&(b[c]=a[2](b[c])))});b.long0||!b.longc||"Albers_Conic_Equal_Area"!==b.projName&&"Lambert_Azimuthal_Equal_Area"!==b.projName||(b.long0=b.longc);b.lat_ts||!b.lat1||"Stereographic_South_Pole"!==b.projName&&"Polar Stereographic (variant B)"!==b.projName||(b.lat0=(0<b.lat1?90:-90)*ga,b.lat_ts=b.lat1)}function h(b){var a=this;if(2===arguments.length){var c=arguments[1];"string"==typeof c?"+"===c.charAt(0)?h[b]=Aa(arguments[1]):h[b]=Ua(arguments[1]):h[b]=c}else if(1===arguments.length){if(Array.isArray(b))return b.map(function(b){Array.isArray(b)?h.apply(a,b):h(b)});if("string"==typeof b){if(b in h)return h[b]}else"EPSG"in b?h["EPSG:"+b.EPSG]=b:"ESRI"in b?h["ESRI:"+b.ESRI]=b:"IAU2000"in b?h["IAU2000:"+b.IAU2000]=b:console.log(b)}}function q(b){return T.some(function(a){return-1<b.indexOf(a)})}function p(b){if("string"!=typeof b)return b;if(b in h)return h[b];if(q(b)){b=Ua(b);var c;c=(c=a(b,"authority"))?(c=a(c,"epsg"))&&-1<Y.indexOf(c):void 0;if(c)return h["EPSG:3857"];c=(c=a(b,"extension"))?a(c,"proj4"):void 0;return c?Aa(c):b}return"+"===b[0]?Aa(b):void 0}function u(b){return b}function v(b,a){var e=c.length;return b.names?(c[e]=b,b.names.forEach(function(b){Ma[b.toLowerCase()]=e}),this):(console.log(a),!0)}function z(b,a,c,e){c=b*b;a*=a;var l=(c-a)/c,f=0;return e?(c=(b*=1-l*(Kb+l*(xa+l*wa)))*b,l=0):f=Math.sqrt(l),{es:l,e:f,ep2:(c-a)/a}}function w(b,c,e,f,h){b||((e=a(ea,f))||(e=Va),b=e.a,c=e.b,e=e.rf);return e&&!c&&(c=(1-1/e)*b),(0===e||Math.abs(b-c)<y)&&(h=!0,c=b),{a:b,b:c,rf:e,sphere:h}}function F(b,a,c,e,f,h){var l={};return l.datum_type=void 0===b||"none"===b?jb:Jb,a&&(l.datum_params=a.map(parseFloat),0===l.datum_params[0]&&0===l.datum_params[1]&&0===l.datum_params[2]||(l.datum_type=ra),3<l.datum_params.length&&(0===l.datum_params[3]&&0===l.datum_params[4]&&0===l.datum_params[5]&&0===l.datum_params[6]||(l.datum_type=da,l.datum_params[3]*=Ja,l.datum_params[4]*=Ja,l.datum_params[5]*=Ja,l.datum_params[6]=l.datum_params[6]/1E6+1))),l.a=c,l.b=e,l.es=f,l.ep2=h,l}function E(b,c){if(!(this instanceof E))return new E(b);c=c||function(b){if(b)throw b;};var e=p(b);if("object"==typeof e){var l=E.projections.get(e.projName);if(l){if(e.datumCode&&"none"!==e.datumCode){var f=a(pa,e.datumCode);f&&(e.datum_params=f.towgs84?f.towgs84.split(","):null,e.ellps=f.ellipse,e.datumName=f.datumName?f.datumName:e.datumCode)}e.k0=e.k0||1;e.axis=e.axis||"enu";e.ellps=e.ellps||"wgs84";var f=w(e.a,e.b,e.rf,e.ellps,e.sphere),h=z(f.a,f.b,f.rf,e.R_A),g=e.datum||F(e.datumCode,e.datum_params,f.a,f.b,h.es,h.ep2);ua(this,e);ua(this,l);this.a=f.a;this.b=f.b;this.rf=f.rf;this.sphere=f.sphere;this.es=h.es;this.e=h.e;this.ep2=h.ep2;this.datum=g;this.init();c(null,this)}else c(b)}else c(b)}function H(b){return b===ra||b===da}function P(b){if("function"==typeof Number.isFinite){if(Number.isFinite(b))return;throw new TypeError("coordinates must be finite numbers");}if("number"!=typeof b||b!==b||!isFinite(b))throw new TypeError("coordinates must be finite numbers");}function V(b,a,c){var e;Array.isArray(c)&&(c=lb(c));var l=c;P(l.x);P(l.y);b.datum&&a.datum&&((b.datum.datum_type===ra||b.datum.datum_type===da)&&"WGS84"!==a.datumCode||(a.datum.datum_type===ra||a.datum.datum_type===da)&&"WGS84"!==b.datumCode)&&(c=V(b,e=new E("WGS84"),c),b=e);"enu"!==b.axis&&(c=xb(b,!1,c));"longlat"===b.projName?c={x:c.x*aa,y:c.y*aa}:(b.to_meter&&(c={x:c.x*b.to_meter,y:c.y*b.to_meter}),c=b.inverse(c));b.from_greenwich&&(c.x+=b.from_greenwich);l=b.datum;e=a.datum;b=c;var f;if(l.datum_type!==e.datum_type||l.a!==e.a||5E-11<Math.abs(l.es-e.es)||(l.datum_type===ra?l.datum_params[0]!==e.datum_params[0]||l.datum_params[1]!==e.datum_params[1]||l.datum_params[2]!==e.datum_params[2]:l.datum_type===da&&(l.datum_params[0]!==e.datum_params[0]||l.datum_params[1]!==e.datum_params[1]||l.datum_params[2]!==e.datum_params[2]||l.datum_params[3]!==e.datum_params[3]||l.datum_params[4]!==e.datum_params[4]||l.datum_params[5]!==e.datum_params[5]||l.datum_params[6]!==e.datum_params[6])))if(l.datum_type===jb||e.datum_type===jb)f=b;else if(l.es!==e.es||l.a!==e.a||H(l.datum_type)||H(e.datum_type)){a:{var h=l.es,r,g,k,p,m=b.x,q=b.y,u=b.z?b.z:0;if(q<-x&&q>-1.001*x)q=-x;else if(q>x&&q<1.001*x)q=x;else{if(q<-x){b={x:-1/0,y:-1/0,z:b.z};break a}if(q>x){b={x:1/0,y:1/0,z:b.z};break a}}b=(m>Math.PI&&(m-=2*Math.PI),g=Math.sin(q),p=Math.cos(q),k=g*g,r=l.a/Math.sqrt(1-h*k),{x:(r+u)*p*Math.cos(m),y:(r+u)*p*Math.sin(m),z:(r*(1-h)+u)*g})}H(l.datum_type)&&(g=l.datum_type,r=l.datum_params,g===ra?b={x:b.x+r[0],y:b.y+r[1],z:b.z+r[2]}:g===da?(g=r[3],k=r[4],p=r[5],l=r[6],b={x:l*(b.x-p*b.y+k*b.z)+r[0],y:l*(p*b.x+b.y-g*b.z)+r[1],z:l*(-k*b.x+g*b.y+b.z)+r[2]}):b=void 0);H(e.datum_type)&&(g=e.datum_type,r=e.datum_params,g===ra?b={x:b.x-r[0],y:b.y-r[1],z:b.z-r[2]}:g===da?(g=r[3],k=r[4],p=r[5],h=r[6],l=(b.x-r[0])/h,m=(b.y-r[1])/h,b=(b.z-r[2])/h,b={x:l+p*m-k*b,y:-p*l+m+g*b,z:k*l-g*m+b}):b=void 0);var v;a:{r=e.es;e=e.a;var w,z,F,y;k=b.x;l=b.y;g=b.z?b.z:0;if(v=Math.sqrt(k*k+l*l),p=Math.sqrt(k*k+l*l+g*g),1E-12>v/e){if(k=0,1E-12>p/e){v={x:b.x,y:b.y,z:b.z};break a}}else k=Math.atan2(l,k);b=g/p;l=(w=v/p)*(1-r)*(p=1/Math.sqrt(1-r*(2-r)*w*w));m=b*p;q=0;do q++,z=r*(F=e/Math.sqrt(1-r*m*m))/(F+(u=v*l+g*m-F*(1-r*m*m))),y=(h=b*(p=1/Math.sqrt(1-z*(2-z)*w*w)))*l-(z=w*(1-z)*p)*m,l=z,m=h;while(1E-24<y*y&&30>q);v=(f=Math.atan(h/Math.abs(z)),{x:k,y:f,z:u})}f=v}else f=b;else f=b;return c=f,a.from_greenwich&&(c={x:c.x-a.from_greenwich,y:c.y}),"longlat"===a.projName?c={x:c.x*ya,y:c.y*ya}:(c=a.forward(c),a.to_meter&&(c={x:c.x/a.to_meter,y:c.y/a.to_meter})),"enu"!==a.axis?xb(a,!0,c):c}function ba(b,a,c){var e,l,f;return Array.isArray(c)?(e=V(b,a,c),3===c.length?[e.x,e.y,e.z]:[e.x,e.y]):(l=V(b,a,c),2===(f=Object.keys(c)).length?l:(f.forEach(function(b){"x"!==b&&"y"!==b&&(l[b]=c[b])}),l))}function Ca(b){return b instanceof E?b:b.oProj?b.oProj:E(b)}function B(b,a,c){b=Ca(b);var e,l=!1;return void 0===a?(a=b,b=sa,l=!0):(void 0!==a.x||Array.isArray(a))&&(c=a,a=b,b=sa,l=!0),a=Ca(a),c?ba(b,a,c):(e={forward:function(c){return ba(b,a,c)},inverse:function(c){return ba(a,b,c)}},l&&(e.oProj=a),e)}function I(b,a){var c,e,l,f,h,g,k=b[1];c=b[0];var p=Math.PI/180*k,m=Math.PI/180*c;g=Math.floor((c+180)/6)+1;180===c&&(g=60);56<=k&&64>k&&3<=c&&12>c&&(g=32);72<=k&&84>k&&(0<=c&&9>c?g=31:9<=c&&21>c?g=33:21<=c&&33>c?g=35:33<=c&&42>c&&(g=37));h=Math.PI/180*(6*(g-1)-180+3);c=6378137/Math.sqrt(1-.00669438*Math.sin(p)*Math.sin(p));e=Math.tan(p)*Math.tan(p);l=.006739496752268451*Math.cos(p)*Math.cos(p);m=.9996*c*((f=Math.cos(p)*(m-h))+(1-e+l)*f*f*f/6+(5-18*e+e*e+72*l-.39089081163157013)*f*f*f*f*f/120)+5E5;f=.9996*(6378137*(.9983242984503243*p-.002514607064228144*Math.sin(2*p)+2.639046602129982E-6*Math.sin(4*p)-3.418046101696858E-9*Math.sin(6*p))+c*Math.tan(p)*(f*f/2+(5-e+9*l+4*l*l)*f*f*f*f/24+(61-58*e+e*e+600*l-2.2240339282485886)*f*f*f*f*f*f/720));0>k&&(f+=1E7);c=Math.round(f);e=Math.round(m);l=g;g="Z";p=(84>=k&&72<=k?g="X":72>k&&64<=k?g="W":64>k&&56<=k?g="V":56>k&&48<=k?g="U":48>k&&40<=k?g="T":40>k&&32<=k?g="S":32>k&&24<=k?g="R":24>k&&16<=k?g="Q":16>k&&8<=k?g="P":8>k&&0<=k?g="N":0>k&&-8<=k?g="M":-8>k&&-16<=k?g="L":-16>k&&-24<=k?g="K":-24>k&&-32<=k?g="J":-32>k&&-40<=k?g="H":-40>k&&-48<=k?g="G":-48>k&&-56<=k?g="F":-56>k&&-64<=k?g="E":-64>k&&-72<=k?g="D":-72>k&&-80<=k&&(g="C"),g);k=a||5;g="00000"+e;f="00000"+c;p=l+p;m=ca(l);e=Math.floor(e/1E5);l=Math.floor(c/1E5)%20;--m;c=bc.charCodeAt(m);m=cc.charCodeAt(m);e=c+e-1;l=m+l;h=!1;c=(e>nb&&(e=e-nb+Xa-1,h=!0),(e===ia||c<ia&&e>ia||(e>ia||c<ia)&&h)&&e++,(e===la||c<la&&e>la||(e>la||c<la)&&h)&&++e===ia&&e++,e>nb&&(e=e-nb+Xa-1),l>mb?(l=l-mb+Xa-1,h=!0):h=!1,(l===ia||m<ia&&l>ia||(l>ia||m<ia)&&h)&&l++,(l===la||m<la&&l>la||(l>la||m<la)&&h)&&++l===ia&&l++,l>mb&&(l=l-mb+Xa-1),String.fromCharCode(e)+String.fromCharCode(l));return p+c+g.substr(g.length-5,k)+f.substr(f.length-5,k)}function J(b){b=ka(U(b.toUpperCase()));return b.lat&&b.lon?[b.lon,b.lat]:[(b.left+b.right)/2,(b.top+b.bottom)/2]}function ka(b){var a=b.easting,c=b.zoneNumber;if(0>c||60<c)return null;var e,f,h,g,k;k=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562));h=b.northing;"N">b.zoneLetter&&(h-=1E7);k=(f=h/.9996/6367449.145945056)+(3*k/2-27*k*k*k/32)*Math.sin(2*f)+(21*k*k/16-55*k*k*k*k/32)*Math.sin(4*f)+151*k*k*k/96*Math.sin(6*f);e=6378137/Math.sqrt(1-.00669438*Math.sin(k)*Math.sin(k));f=Math.tan(k)*Math.tan(k);h=.006739496752268451*Math.cos(k)*Math.cos(k);g=6335439.32722994/Math.pow(1-.00669438*Math.sin(k)*Math.sin(k),1.5);a=(a-5E5)/(.9996*e);e=k-e*Math.tan(k)/g*(a*a/2-(5+3*f+10*h-4*h*h-.06065547077041606)*a*a*a*a/24+(61+90*f+298*h+45*f*f-1.6983531815716497-3*h*h)*a*a*a*a*a*a/720);e=e/Math.PI*180;a=(a-(1+2*f+h)*a*a*a/6+(5-2*h+28*f-3*h*h+.05391597401814761+24*f*f)*a*a*a*a*a/120)/Math.cos(k);a=6*(c-1)-180+3+a/Math.PI*180;b.accuracy?(b=ka({northing:b.northing+b.accuracy,easting:b.easting+b.accuracy,zoneLetter:b.zoneLetter,zoneNumber:b.zoneNumber}),b={top:b.lat,right:b.lon,bottom:e,left:a}):b={lat:e,lon:a};return b}function ca(b){b%=Ba;return 0===b&&(b=Ba),b}function U(b){if(b&&0===b.length)throw"MGRSPoint coverting from nothing";for(var a,c=b.length,e,f="",h=0;!/[A-Z]/.test(a=b.charAt(h));){if(2<=h)throw"MGRSPoint bad conversion from: "+b;f+=a;h++}a=parseInt(f,10);if(0===h||h+3>c)throw"MGRSPoint bad conversion from: "+b;f=b.charAt(h++);if("A">=f||"B"===f||"Y"===f||"Z"<=f||"I"===f||"O"===f)throw"MGRSPoint zone letter "+f+" not handled: "+b;e=b.substring(h,h+=2);var g=ca(a),k;k=e.charAt(0);for(var p=bc.charCodeAt(g-1),m=1E5,q=!1;p!==k.charCodeAt(0);){if(++p===ia&&p++,p===la&&p++,p>nb){if(q)throw"Bad character: "+k;p=Xa;q=!0}m+=1E5}k=m;e=e.charAt(1);if("V"<e)throw"MGRSPoint given invalid Northing "+e;g=cc.charCodeAt(g-1);p=0;for(m=!1;g!==e.charCodeAt(0);){if(++g===ia&&g++,g===la&&g++,g>mb){if(m)throw"Bad character: "+e;g=Xa;m=!0}p+=1E5}for(g=p;g<N(f);)g+=2E6;c-=h;if(0!=c%2)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+b;var u,v,w,z,F,c=c/2,p=e=0;return 0<c&&(u=1E5/Math.pow(10,c),v=b.substring(h,h+c),e=parseFloat(v)*u,w=b.substring(h+c),p=parseFloat(w)*u),z=e+k,F=p+g,{easting:z,northing:F,zoneLetter:f,zoneNumber:a,accuracy:u}}function N(b){var a;switch(b){case "C":a=11E5;break;case "D":a=2E6;break;case "E":a=28E5;break;case "F":a=37E5;break;case "G":a=46E5;break;case "H":a=55E5;break;case "J":a=64E5;break;case "K":a=73E5;break;case "L":a=82E5;break;case "M":a=91E5;break;case "N":a=0;break;case "P":a=8E5;break;case "Q":a=17E5;break;case "R":a=26E5;break;case "S":a=35E5;break;case "T":a=44E5;break;case "U":a=53E5;break;case "V":a=62E5;break;case "W":a=7E6;break;case "X":a=79E5;break;default:a=-1}if(0<=a)return a;throw"Invalid zone letter: "+b;}function O(b,a,c){if(!(this instanceof O))return new O(b,a,c);Array.isArray(b)?(this.x=b[0],this.y=b[1],this.z=b[2]||0):"object"==typeof b?(this.x=b.x,this.y=b.y,this.z=b.z||0):"string"==typeof b&&void 0===a?(b=b.split(","),this.x=parseFloat(b[0],10),this.y=parseFloat(b[1],10),this.z=parseFloat(b[2],10)||0):(this.x=b,this.y=a,this.z=c||0);console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}function Da(b,a,c,e){var f;return b<y?(e.value=S.AREA_0,f=0):(f=Math.atan2(a,c),Math.abs(f)<=K?e.value=S.AREA_0:f>K&&f<=x+K?(e.value=S.AREA_1,f-=x):f>x+K||f<=-(x+K)?(e.value=S.AREA_2,f=0<=f?f-R:f+R):(e.value=S.AREA_3,f+=x)),f}function qa(b,a){var c=b+a;return c<-R?c+=La:c>+R&&(c-=La),c}function cb(b,a,c,e){for(;e;--e){var f=b(a);if(a-=f,Math.abs(f)<c)break}return a}var ra=1,da=2,Jb=4,jb=5,Ja=4.84813681109536E-6,x=Math.PI/2,Kb=.16666666666666666,xa=.04722222222222222,wa=.022156084656084655,y=1E-10,aa=.017453292519943295,ya=57.29577951308232,K=Math.PI/4,La=2*Math.PI,R=3.14159265359,M={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},W={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},Ea=/[\s_\-\/\(\)]/g,Aa=function(b){var c,e,f={},h=b.split("+").map(function(b){return b.trim()}).filter(function(b){return b}).reduce(function(b,a){var c=a.split("\x3d");return c.push(!0),b[c[0].toLowerCase()]=c[1],b},{}),g={proj:"projName",datum:"datumCode",rf:function(b){f.rf=parseFloat(b)},lat_0:function(b){f.lat0=b*aa},lat_1:function(b){f.lat1=b*aa},lat_2:function(b){f.lat2=b*aa},lat_ts:function(b){f.lat_ts=b*aa},lon_0:function(b){f.long0=b*aa},lon_1:function(b){f.long1=b*aa},lon_2:function(b){f.long2=b*aa},alpha:function(b){f.alpha=parseFloat(b)*aa},lonc:function(b){f.longc=b*aa},x_0:function(b){f.x0=parseFloat(b)},y_0:function(b){f.y0=parseFloat(b)},k_0:function(b){f.k0=parseFloat(b)},k:function(b){f.k0=parseFloat(b)},a:function(b){f.a=parseFloat(b)},b:function(b){f.b=parseFloat(b)},r_a:function(){f.R_A=!0},zone:function(b){f.zone=parseInt(b,10)},south:function(){f.utmSouth=!0},towgs84:function(b){f.datum_params=b.split(",").map(function(b){return parseFloat(b)})},to_meter:function(b){f.to_meter=parseFloat(b)},units:function(b){f.units=b;(b=a(W,b))&&(f.to_meter=b.to_meter)},from_greenwich:function(b){f.from_greenwich=b*aa},pm:function(b){var c=a(M,b);f.from_greenwich=(c||parseFloat(b))*aa},nadgrids:function(b){"@null"===b?f.datumCode="none":f.nadgrids=b},axis:function(b){3===b.length&&-1!=="ewnsud".indexOf(b.substr(0,1))&&-1!=="ewnsud".indexOf(b.substr(1,1))&&-1!=="ewnsud".indexOf(b.substr(2,1))&&(f.axis=b)}};for(c in h)b=h[c],c in g?"function"==typeof(e=g[c])?e(b):f[e]=b:f[c]=b;return"string"==typeof f.datumCode&&"WGS84"!==f.datumCode&&(f.datumCode=f.datumCode.toLowerCase()),f},ta=1,Sa=/\s/,G=/[A-Za-z]/,X=/[A-Za-z84]/,za=/[,\]]/,Ta=/[\d\.E\-\+]/;e.prototype.readCharicter=function(){var b=this.text[this.place++];if(4!==this.state)for(;Sa.test(b);){if(this.place>=this.text.length)return;b=this.text[this.place++]}switch(this.state){case ta:return this.neutral(b);case 2:return this.keyword(b);case 4:return this.quoted(b);case 5:return this.afterquote(b);case 3:return this.number(b)}};e.prototype.afterquote=function(b){if('"'===b)return this.word+='"',void(this.state=4);if(za.test(b))return this.word=this.word.trim(),void this.afterItem(b);throw Error("havn't handled \""+b+'" in afterquote yet, index '+this.place);};e.prototype.afterItem=function(b){return","===b?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=ta)):"]"===b?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=ta,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0};e.prototype.number=function(b){if(!Ta.test(b)){if(za.test(b))return this.word=parseFloat(this.word),void this.afterItem(b);throw Error("havn't handled \""+b+'" in number yet, index '+this.place);}this.word+=b};e.prototype.quoted=function(b){'"'!==b?this.word+=b:this.state=5};e.prototype.keyword=function(b){if(X.test(b))this.word+=b;else{if("["===b)return b=[],b.push(this.word),this.level++,null===this.root?this.root=b:this.currentObject.push(b),this.stack.push(this.currentObject),this.currentObject=b,void(this.state=ta);if(!za.test(b))throw Error("havn't handled \""+b+'" in keyword yet, index '+this.place);this.afterItem(b)}};e.prototype.neutral=function(b){if(G.test(b))return this.word=b,void(this.state=2);if('"'===b)return this.word="",void(this.state=4);if(Ta.test(b))return this.word=b,void(this.state=3);if(!za.test(b))throw Error("havn't handled \""+b+'" in neutral yet, index '+this.place);this.afterItem(b)};e.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw Error('unable to parse string "'+this.text+'". State is '+this.state);};var ga=.017453292519943295,Ua=function(b){b=(new e(b)).output();var a=b.shift(),c=b.shift();b.unshift(["name",c]);b.unshift(["type",a]);a={};return f(b,a),k(a),a};!function(b){b("EPSG:4326","+title\x3dWGS 84 (long/lat) +proj\x3dlonglat +ellps\x3dWGS84 +datum\x3dWGS84 +units\x3ddegrees");b("EPSG:4269","+title\x3dNAD83 (long/lat) +proj\x3dlonglat +a\x3d6378137.0 +b\x3d6356752.31414036 +ellps\x3dGRS80 +datum\x3dNAD83 +units\x3ddegrees");b("EPSG:3857","+title\x3dWGS 84 / Pseudo-Mercator +proj\x3dmerc +a\x3d6378137 +b\x3d6378137 +lat_ts\x3d0.0 +lon_0\x3d0.0 +x_0\x3d0.0 +y_0\x3d0 +k\x3d1.0 +units\x3dm +nadgrids\x3d@null +no_defs");b.WGS84=b["EPSG:4326"];b["EPSG:3785"]=b["EPSG:3857"];b.GOOGLE=b["EPSG:3857"];b["EPSG:900913"]=b["EPSG:3857"];b["EPSG:102113"]=b["EPSG:3857"]}(h);var T="PROJECTEDCRS PROJCRS GEOGCS GEOCCS PROJCS LOCAL_CS GEODCRS GEODETICCRS GEODETICDATUM ENGCRS ENGINEERINGCRS".split(" "),Y=["3857","900913","3785","102113"],ua=function(b,a){b=b||{};var c,e;if(!a)return b;for(e in a)void 0!==(c=a[e])&&(b[e]=c);return b},oa=function(b,a,c){b*=a;return c/Math.sqrt(1-b*b)},C=function(b){return Math.abs(b)<=R?b:b-(0>b?-1:1)*La},ha=function(b,a,c){c*=b;return c=Math.pow((1-c)/(1+c),.5*b),Math.tan(.5*(x-a))/c},va=function(b,a){for(var c,e,f=.5*b,l=x-2*Math.atan(a),h=0;15>=h;h++)if(c=b*Math.sin(l),e=x-2*Math.atan(a*Math.pow((1-c)/(1+c),f))-l,l+=e,1E-10>=Math.abs(e))return l;return-9999},db=[{init:function(){var b=this.b/this.a;this.es=1-b*b;"x0"in this||(this.x0=0);"y0"in this||(this.y0=0);this.e=Math.sqrt(this.es);this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=oa(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(b){var a=b.x,c=b.y;if(90<c*ya&&-90>c*ya&&180<a*ya&&-180>a*ya||Math.abs(Math.abs(c)-x)<=y)return null;this.sphere?(a=this.x0+this.a*this.k0*C(a-this.long0),c=this.y0+this.a*this.k0*Math.log(Math.tan(K+.5*c))):(c=ha(this.e,c,Math.sin(c)),a=this.x0+this.a*this.k0*C(a-this.long0),c=this.y0-this.a*this.k0*Math.log(c));return b.x=a,b.y=c,b},inverse:function(b){var a,c,e=b.x-this.x0;c=b.y-this.y0;if(this.sphere)c=x-2*Math.atan(Math.exp(-c/(this.a*this.k0)));else if(-9999===(c=va(this.e,Math.exp(-c/(this.a*this.k0)))))return null;return a=C(this.long0+e/(this.a*this.k0)),b.x=a,b.y=c,b},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:u,inverse:u,names:["longlat","identity"]}],Ma={},c=[],D={start:function(){db.forEach(v)},add:v,get:function(b){if(!b)return!1;b=b.toLowerCase();return void 0!==Ma[b]&&c[Ma[b]]?c[Ma[b]]:void 0}},ea={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl \x26 S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah \x26 Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},Va=ea.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};ea.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r\x3d6370997)"};var pa={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};E.projections=D;E.projections.start();var xb=function(b,a,c){var e,f,l,h=c.x,r=c.y,g=c.z||0,k={};for(l=0;3>l;l++)if(!a||2!==l||void 0!==c.z)switch(0===l?(e=h,f="x"):1===l?(e=r,f="y"):(e=g,f="z"),b.axis[l]){case "e":k[f]=e;break;case "w":k[f]=-e;break;case "n":k[f]=e;break;case "s":k[f]=-e;break;case "u":void 0!==c[f]&&(k.z=e);break;case "d":void 0!==c[f]&&(k.z=-e);break;default:return null}return k},lb=function(b){var a={x:b[0],y:b[1]};return 2<b.length&&(a.z=b[2]),3<b.length&&(a.m=b[3]),a},sa=E("WGS84"),Ba=6,bc="AJSAJS",cc="AFAFAF",Xa=65,ia=73,la=79,mb=86,nb=90,dc={forward:I,inverse:function(b){b=ka(U(b.toUpperCase()));return b.lat&&b.lon?[b.lon,b.lat,b.lon,b.lat]:[b.left,b.bottom,b.right,b.top]},toPoint:J};O.fromMGRS=function(b){return new O(J(b))};O.prototype.toMGRS=function(b){return I([this.x,this.y],b)};var ec=function(b){var a=[];a[0]=1-b*(.25+b*(.046875+b*(.01953125+.01068115234375*b)));a[1]=b*(.75-b*(.046875+b*(.01953125+.01068115234375*b)));var c=b*b;return a[2]=c*(.46875-b*(.013020833333333334+.007120768229166667*b)),c*=b,a[3]=c*(.3645833333333333-.005696614583333333*b),a[4]=c*b*.3076171875,a},eb=function(b,a,c,e){return c*=a,a*=a,e[0]*b-c*(e[1]+a*(e[2]+a*(e[3]+a*e[4])))},Ya=function(b,a,c){for(var e=1/(1-a),f=b,l=20;l;--l){var h=Math.sin(f),r=1-a*h*h;if(r=(eb(f,h,Math.cos(f),c)-b)*r*Math.sqrt(r)*e,f-=r,Math.abs(r)<y)break}return f},yb={init:function(){this.x0=void 0!==this.x0?this.x0:0;this.y0=void 0!==this.y0?this.y0:0;this.long0=void 0!==this.long0?this.long0:0;this.lat0=void 0!==this.lat0?this.lat0:0;this.es&&(this.en=ec(this.es),this.ml0=eb(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(b){var a,c,e=b.y,f=C(b.x-this.long0),h=Math.sin(e),g=Math.cos(e);if(this.es){c=g*f;var k=Math.pow(c,2),p=this.ep2*Math.pow(g,2),m=Math.pow(p,2),q=Math.pow(Math.abs(g)>y?Math.tan(e):0,2),u=Math.pow(q,2);a=1-this.es*Math.pow(h,2);c/=Math.sqrt(a);e=eb(e,h,g,this.en);a=this.a*this.k0*c*(1+k/6*(1-q+p+k/20*(5-18*q+u+14*p-58*q*p+k/42*(61+179*u-u*q-479*q))))+this.x0;c=this.a*this.k0*(e-this.ml0+h*f*c/2*(1+k/12*(5-q+9*p+4*m+k/30*(61+u-58*q+270*p-330*q*p+k/56*(1385+543*u-u*q-3111*q)))))+this.y0}else{h=g*Math.sin(f);if(Math.abs(Math.abs(h)-1)<y)return 93;if(a=.5*this.a*this.k0*Math.log((1+h)/(1-h))+this.x0,c=g*Math.cos(f)/Math.sqrt(1-Math.pow(h,2)),1<=(h=Math.abs(c))){if(h-1>y)return 93;c=0}else c=Math.acos(c);0>e&&(c=-c);c=this.a*this.k0*(c-this.lat0)+this.y0}return b.x=a,b.y=c,b},inverse:function(b){var a,c,e=1/this.a*(b.x-this.x0),f=1/this.a*(b.y-this.y0);if(this.es)if(a=this.ml0+f/this.k0,c=Ya(a,this.es,this.en),Math.abs(c)<x){var f=Math.cos(c),h=Math.abs(f)>y?Math.tan(c):0,g=this.ep2*Math.pow(f,2),k=Math.pow(g,2),p=Math.pow(h,2),m=Math.pow(p,2);a=1-this.es*Math.pow(Math.sin(c),2);var e=e*Math.sqrt(a)/this.k0,q=Math.pow(e,2);a=c-a*h*q/(1-this.es)*.5*(1-q/12*(5+3*p-9*g*p+g-4*k-q/30*(61+90*p-252*g*p+45*m+46*g-q/56*(1385+3633*p+4095*m+1574*m*p))));c=C(this.long0+e*(1-q/6*(1+2*p+g-q/20*(5+28*p+24*m+8*g*p+6*g-q/42*(61+662*p+1320*m+720*m*p))))/f)}else a=x*(0>f?-1:1),c=0;else a=Math.exp(e/this.k0),c=.5*(a-1/a),g=Math.cos(this.lat0+f/this.k0),a=Math.sqrt((1-Math.pow(g,2))/(1+Math.pow(c,2))),a=Math.asin(a),0>f&&(a=-a),c=0===c&&0===g?0:C(Math.atan2(c,g)+this.long0);return b.x=c,b.y=a,b},names:["Transverse_Mercator","Transverse Mercator","tmerc"]},Ga=function(b){b=Math.exp(b);return(b-1/b)/2},Nb=function(b,a){b=Math.abs(b);a=Math.abs(a);var c=Math.max(b,a);return c*Math.sqrt(1+Math.pow(Math.min(b,a)/(c||1),2))},Ob=function(b,a){for(var c,e=2*Math.cos(2*a),f=b.length-1,l=b[f],h=0;0<=--f;)c=e*l-h+b[f],h=l,l=c;return a+c*Math.sin(2*a)},Pb=function(b,a,c){var e,f=Math.sin(a);a=Math.cos(a);var l=Ga(c),h;c=Math.exp(c);h=(c+1/c)/2;for(var g=2*a*h,r=-2*f*l,k=b.length-1,p=b[k],m=0,q=0,u=0;0<=--k;)c=q,e=m,p=g*(q=p)-c-r*(m=u)+b[k],u=r*q-e+g*m;return g=f*h,r=a*l,[g*p-r*u,g*u+r*p]},ob={init:function(){if(void 0===this.es||0>=this.es)throw Error("incorrect elliptical usage");this.x0=void 0!==this.x0?this.x0:0;this.y0=void 0!==this.y0?this.y0:0;this.long0=void 0!==this.long0?this.long0:0;this.lat0=void 0!==this.lat0?this.lat0:0;this.cgb=[];this.cbg=[];this.utg=[];this.gtu=[];var b=this.es/(1+Math.sqrt(1-this.es)),b=b/(2-b),a;this.cgb[0]=b*(2+b*(-2/3+b*(b*(116/45+b*(26/45+-2854/675*b))-2)));this.cbg[0]=b*(b*(2/3+b*(4/3+b*(-82/45+b*(32/45+4642/4725*b))))-2);a=b*b;this.cgb[1]=a*(7/3+b*(b*(-227/45+b*(2704/315+2323/945*b))-1.6));this.cbg[1]=a*(5/3+b*(-16/15+b*(-13/9+b*(904/315+-1522/945*b))));a*=b;this.cgb[2]=a*(56/15+b*(-136/35+b*(-1262/105+73814/2835*b)));this.cbg[2]=a*(-26/15+b*(34/21+b*(1.6+-12686/2835*b)));a*=b;this.cgb[3]=a*(4279/630+b*(-332/35+-399572/14175*b));this.cbg[3]=a*(1237/630+b*(-24832/14175*b-2.4));a*=b;this.cgb[4]=a*(4174/315+-144838/6237*b);this.cbg[4]=a*(-734/315+109598/31185*b);a*=b;this.cgb[5]=601676/22275*a;this.cbg[5]=444337/155925*a;a=Math.pow(b,2);this.Qn=this.k0/(1+b)*(1+a*(.25+a*(.015625+a/256)));this.utg[0]=b*(b*(2/3+b*(-37/96+b*(1/360+b*(81/512+-96199/604800*b))))-.5);this.gtu[0]=b*(.5+b*(-2/3+b*(.3125+b*(41/180+b*(-127/288+7891/37800*b)))));this.utg[1]=a*(-1/48+b*(-1/15+b*(437/1440+b*(-46/105+.2890188388723545*b))));this.gtu[1]=a*(13/48+b*(b*(557/1440+b*(281/630+-1.0248393063822752*b))-.6));a*=b;this.utg[2]=a*(-17/480+b*(37/840+b*(209/4480+-5569/90720*b)));this.gtu[2]=a*(61/240+b*(-103/140+b*(15061/26880+167603/181440*b)));a*=b;this.utg[3]=a*(-4397/161280+b*(11/504+830251/7257600*b));this.gtu[3]=a*(49561/161280+b*(-179/168+.9096203979276896*b));a*=b;this.utg[4]=a*(-4583/161280+108847/3991680*b);this.gtu[4]=a*(34729/80640+-1.713007555715889*b);a*=b;this.utg[5]=-.03233083094085698*a;this.gtu[5]=.6650675310896665*a;b=Ob(this.cbg,this.lat0);a=-this.Qn;for(var c=this.gtu,e=2*b,f,h=2*Math.cos(e),g=c.length-1,k=c[g],p=0;0<=--g;)f=h*k-p+c[g],p=k,k=f;this.Zb=a*(b+Math.sin(e)*f)},forward:function(b){var a=C(b.x-this.long0),c=b.y,c=Ob(this.cbg,c),e=Math.sin(c),f=Math.cos(c),h=Math.sin(a),a=Math.cos(a),c=Math.atan2(e,a*f),a=Math.atan2(h*f,Nb(e,f*a)),a=Math.tan(a),e=Math.abs(a),f=e*(1+e/(Nb(1,e)+1)),h=1+f,g=h-1,a=(e=0===g?f:f*Math.log(h)/g,0>a?-e:e),e=Pb(this.gtu,2*c,2*a),c=c+e[0],a=a+e[1],k,p;return 2.623395162778>=Math.abs(a)?(k=this.a*this.Qn*a+this.x0,p=this.a*(this.Qn*c+this.Zb)+this.y0):(k=1/0,p=1/0),b.x=k,b.y=p,b},inverse:function(b){var a=1/this.a*(b.x-this.x0),c=1/this.a*(b.y-this.y0),c=(c-this.Zb)/this.Qn,a=a/this.Qn;if(2.623395162778>=Math.abs(a))var e=Pb(this.utg,2*c,2*a),c=c+e[0],a=a+e[1],a=Math.atan(Ga(a)),e=Math.cos(c),f=Math.sin(a),a=Math.cos(a),c=Math.atan2(Math.sin(c)*a,Nb(f,a*e)),a=Math.atan2(f,a*e),a=C(a+this.long0),c=Ob(this.cgb,c);else a=1/0,c=1/0;return b.x=a,b.y=c,b},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc"]},Qb={init:function(){var b;b=this.zone;void 0===b&&(0>(b=Math.floor(30*(C(this.long0)+Math.PI)/Math.PI)+1)?b=0:60<b&&(b=60));if(void 0===b)throw Error("unknown utm zone");this.lat0=0;this.long0=(6*Math.abs(b)-183)*aa;this.x0=5E5;this.y0=this.utmSouth?1E7:0;this.k0=.9996;ob.init.apply(this);this.forward=ob.forward;this.inverse=ob.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"},Ab=function(b,a){return Math.pow((1-b)/(1+b),a)},Sb=function(){var b=Math.sin(this.lat0),a=Math.cos(this.lat0),a=a*a;this.rc=Math.sqrt(1-this.es)/(1-this.es*b*b);this.C=Math.sqrt(1+this.es*a*a/(1-this.es));this.phic0=Math.asin(b/this.C);this.ratexp=.5*this.C*this.e;this.K=Math.tan(.5*this.phic0+K)/(Math.pow(Math.tan(.5*this.lat0+K),this.C)*Ab(this.e*b,this.ratexp))},pb=function(b){var a=b.x,c=b.y;return b.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*c+K),this.C)*Ab(this.e*Math.sin(c),this.ratexp))-x,b.x=this.C*a,b},Tb=function(b){for(var a=b.x/this.C,c=b.y,e=Math.pow(Math.tan(.5*c+K)/this.K,1/this.C),f=20;0<f&&(c=2*Math.atan(e*Ab(this.e*Math.sin(b.y),-.5*this.e))-x,!(1E-14>Math.abs(c-b.y)));--f)b.y=c;return f?(b.x=a,b.y=c,b):null},wc={init:function(){Sb.apply(this);this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(b){var a,c,e,f;return b.x=C(b.x-this.long0),pb.apply(this,[b]),a=Math.sin(b.y),c=Math.cos(b.y),e=Math.cos(b.x),f=this.k0*this.R2/(1+this.sinc0*a+this.cosc0*c*e),b.x=f*c*Math.sin(b.x),b.y=f*(this.cosc0*a-this.sinc0*c*e),b.x=this.a*b.x+this.x0,b.y=this.a*b.y+this.y0,b},inverse:function(b){var a,c,e,f;(b.x=(b.x-this.x0)/this.a,b.y=(b.y-this.y0)/this.a,b.x/=this.k0,b.y/=this.k0,f=Math.sqrt(b.x*b.x+b.y*b.y))?(e=2*Math.atan2(f,this.R2),a=Math.sin(e),c=Math.cos(e),e=Math.asin(c*this.sinc0+b.y*a*this.cosc0/f),a=Math.atan2(b.x*a,f*this.cosc0*c-b.y*this.sinc0*a)):(e=this.phic0,a=0);return b.x=a,b.y=e,Tb.apply(this,[b]),b.x=C(b.x+this.long0),b},names:"Stereographic_North_Pole;Oblique_Stereographic;Polar_Stereographic;sterea;Oblique Stereographic Alternative;Double_Stereographic".split(";")},xc={init:function(){this.coslat0=Math.cos(this.lat0);this.sinlat0=Math.sin(this.lat0);this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=y&&(this.k0=.5*(1+(0>this.lat0?-1:1)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=y&&(0<this.lat0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=y&&(this.k0=.5*this.cons*oa(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/ha(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=oa(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-x,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(b){var a,c,e,f,h,g,k=b.x,p=b.y,m=Math.sin(p),q=Math.cos(p),u=C(k-this.long0);return Math.abs(Math.abs(k-this.long0)-Math.PI)<=y&&Math.abs(p+this.lat0)<=y?(b.x=NaN,b.y=NaN,b):this.sphere?(a=2*this.k0/(1+this.sinlat0*m+this.coslat0*q*Math.cos(u)),b.x=this.a*a*q*Math.sin(u)+this.x0,b.y=this.a*a*(this.coslat0*m-this.sinlat0*q*Math.cos(u))+this.y0,b):(c=2*Math.atan(this.ssfn_(p,m,this.e))-x,f=Math.cos(c),e=Math.sin(c),Math.abs(this.coslat0)<=y?(h=ha(this.e,p*this.con,this.con*m),g=2*this.a*this.k0*h/this.cons,b.x=this.x0+g*Math.sin(k-this.long0),b.y=this.y0-this.con*g*Math.cos(k-this.long0),b):(Math.abs(this.sinlat0)<y?(a=2*this.a*this.k0/(1+f*Math.cos(u)),b.y=a*e):(a=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*e+this.cosX0*f*Math.cos(u))),b.y=a*(this.cosX0*e-this.sinX0*f*Math.cos(u))+this.y0),b.x=a*f*Math.sin(u)+this.x0,b))},inverse:function(b){b.x-=this.x0;b.y-=this.y0;var a,c,e,f=Math.sqrt(b.x*b.x+b.y*b.y);if(this.sphere)return e=2*Math.atan(f/(2*this.a*this.k0)),a=this.long0,c=this.lat0,f<=y?(b.x=a,b.y=c,b):(c=Math.asin(Math.cos(e)*this.sinlat0+b.y*Math.sin(e)*this.coslat0/f),a=C(Math.abs(this.coslat0)<y?0<this.lat0?this.long0+Math.atan2(b.x,-1*b.y):this.long0+Math.atan2(b.x,b.y):this.long0+Math.atan2(b.x*Math.sin(e),f*this.coslat0*Math.cos(e)-b.y*this.sinlat0*Math.sin(e))),b.x=a,b.y=c,b);if(Math.abs(this.coslat0)<=y){if(f<=y)return c=this.lat0,a=this.long0,b.x=a,b.y=c,b;b.x*=this.con;b.y*=this.con;a=f*this.cons/(2*this.a*this.k0);c=this.con*va(this.e,a);a=this.con*C(this.con*this.long0+Math.atan2(b.x,-1*b.y))}else c=2*Math.atan(f*this.cosX0/(2*this.a*this.k0*this.ms1)),a=this.long0,f<=y?e=this.X0:(e=Math.asin(Math.cos(c)*this.sinX0+b.y*Math.sin(c)*this.cosX0/f),a=C(this.long0+Math.atan2(b.x*Math.sin(c),f*this.cosX0*Math.cos(c)-b.y*this.sinX0*Math.sin(c)))),c=-1*va(this.e,Math.tan(.5*(x+e)));return b.x=a,b.y=c,b},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(b,a,c){return a*=c,Math.tan(.5*(x+b))*Math.pow((1-a)/(1+a),.5*c)}},yc={init:function(){var b=this.lat0;this.lambda0=this.long0;var a=Math.sin(b),c=this.a,e=1/this.rf,e=2*e-Math.pow(e,2),f=this.e=Math.sqrt(e);this.R=this.k0*c*Math.sqrt(1-e)/(1-e*Math.pow(a,2));this.alpha=Math.sqrt(1+e/(1-e)*Math.pow(Math.cos(b),4));this.b0=Math.asin(a/this.alpha);this.K=Math.log(Math.tan(Math.PI/4+this.b0/2))-this.alpha*Math.log(Math.tan(Math.PI/4+b/2))+this.alpha*f/2*Math.log((1+f*a)/(1-f*a))},forward:function(b){var a=2*(Math.atan(Math.exp(-this.alpha*(Math.log(Math.tan(Math.PI/4-b.y/2))+this.e/2*Math.log((1+this.e*Math.sin(b.y))/(1-this.e*Math.sin(b.y))))+this.K))-Math.PI/4),c=this.alpha*(b.x-this.lambda0),e=Math.atan(Math.sin(c)/(Math.sin(this.b0)*Math.tan(a)+Math.cos(this.b0)*Math.cos(c))),a=Math.asin(Math.cos(this.b0)*Math.sin(a)-Math.sin(this.b0)*Math.cos(a)*Math.cos(c));return b.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,b.x=this.R*e+this.x0,b},inverse:function(a){for(var b=(a.x-this.x0)/this.R,c=2*(Math.atan(Math.exp((a.y-this.y0)/this.R))-Math.PI/4),e=Math.asin(Math.cos(this.b0)*Math.sin(c)+Math.sin(this.b0)*Math.cos(c)*Math.cos(b)),b=this.lambda0+Math.atan(Math.sin(b)/(Math.cos(this.b0)*Math.cos(b)-Math.sin(this.b0)*Math.tan(c)))/this.alpha,f=e,h=-1E3,g=0;1E-7<Math.abs(f-h);){if(20<++g)return;c=1/this.alpha*(Math.log(Math.tan(Math.PI/4+e/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(f))/2));h=f;f=2*Math.atan(Math.exp(c))-Math.PI/2}return a.x=b,a.y=f,a},names:["somerc"]},zc={init:function(){this.no_off=this.no_off||!1;this.no_rot=this.no_rot||!1;isNaN(this.k0)&&(this.k0=1);var a=Math.sin(this.lat0),c=Math.cos(this.lat0),e=this.e*a;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(c,4));this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-e*e);a=ha(this.e,this.lat0,a);c=this.bl/c*Math.sqrt((1-this.es)/(1-e*e));1>c*c&&(c=1);var f;if(isNaN(this.longc)){var e=ha(this.e,this.lat1,Math.sin(this.lat1)),h=ha(this.e,this.lat2,Math.sin(this.lat2));0<=this.lat0?this.el=(c+Math.sqrt(c*c-1))*Math.pow(a,this.bl):this.el=(c-Math.sqrt(c*c-1))*Math.pow(a,this.bl);e=Math.pow(e,this.bl);h=Math.pow(h,this.bl);a=.5*((f=this.el/e)-1/f);f=(this.el*this.el-h*e)/(this.el*this.el+h*e);e=(h-e)/(h+e);h=C(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(f*Math.tan(.5*this.bl*h)/e)/this.bl;this.long0=C(this.long0);f=C(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*f)/a);this.alpha=Math.asin(c*Math.sin(this.gamma0))}else f=0<=this.lat0?c+Math.sqrt(c*c-1):c-Math.sqrt(c*c-1),this.el=f*Math.pow(a,this.bl),this.gamma0=Math.asin(Math.sin(this.alpha)/c),this.long0=this.longc-Math.asin(.5*(f-1/f)*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:0<=this.lat0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(c*c-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(c*c-1),Math.cos(this.alpha))},forward:function(a){var b,c;c=a.y;b=C(a.x-this.long0);if(Math.abs(Math.abs(c)-x)<=y)b=0<c?-1:1,c=this.al/this.bl*Math.log(Math.tan(K+b*this.gamma0*.5)),b=-1*b*x*this.al/this.bl;else{c=ha(this.e,c,Math.sin(c));c=this.el/Math.pow(c,this.bl);var e=.5*(c-1/c),f=Math.sin(this.bl*b);c=(e*Math.sin(this.gamma0)-f*Math.cos(this.gamma0))/(.5*(c+1/c));c=Math.abs(Math.abs(c)-1)<=y?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-c)/(1+c))/this.bl;b=Math.abs(Math.cos(this.bl*b))<=y?this.al*this.bl*b:this.al*Math.atan2(e*Math.cos(this.gamma0)+f*Math.sin(this.gamma0),Math.cos(this.bl*b))/this.bl}return this.no_rot?(a.x=this.x0+b,a.y=this.y0+c):(b-=this.uc,a.x=this.x0+c*Math.cos(this.alpha)+b*Math.sin(this.alpha),a.y=this.y0+b*Math.cos(this.alpha)-c*Math.sin(this.alpha)),a},inverse:function(a){var b,c;this.no_rot?(c=a.y-this.y0,b=a.x-this.x0):(c=(a.x-this.x0)*Math.cos(this.alpha)-(a.y-this.y0)*Math.sin(this.alpha),b=(a.y-this.y0)*Math.cos(this.alpha)+(a.x-this.x0)*Math.sin(this.alpha),b+=this.uc);var e=Math.exp(-1*this.bl*c/this.al);c=.5*(e-1/e);var f=Math.sin(this.bl*b/this.al),e=(f*Math.cos(this.gamma0)+c*Math.sin(this.gamma0))/(.5*(e+1/e)),h=Math.pow(this.el/Math.sqrt((1+e)/(1-e)),1/this.bl);return Math.abs(e-1)<y?(a.x=this.long0,a.y=x):Math.abs(e+1)<y?(a.x=this.long0,a.y=-1*x):(a.y=va(this.e,h),a.x=C(this.long0-Math.atan2(c*Math.cos(this.gamma0)-f*Math.sin(this.gamma0),Math.cos(this.bl*b/this.al))/this.bl)),a},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},Bc={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<y)){var a=this.b/this.a;this.e=Math.sqrt(1-a*a);var a=Math.sin(this.lat1),c=oa(this.e,a,Math.cos(this.lat1)),e=ha(this.e,this.lat1,a),f=Math.sin(this.lat2),h=oa(this.e,f,Math.cos(this.lat2)),f=ha(this.e,this.lat2,f),g=ha(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>y?this.ns=Math.log(c/h)/Math.log(e/f):this.ns=a;isNaN(this.ns)&&(this.ns=a);this.f0=c/(this.ns*Math.pow(e,this.ns));this.rh=this.a*this.f0*Math.pow(g,this.ns);this.title||(this.title="Lambert Conformal Conic")}},forward:function(a){var b=a.x,c=a.y;Math.abs(2*Math.abs(c)-Math.PI)<=y&&(c=(0>c?-1:1)*(x-2*y));if(Math.abs(Math.abs(c)-x)>y)c=ha(this.e,c,Math.sin(c)),c=this.a*this.f0*Math.pow(c,this.ns);else{if(0>=c*this.ns)return null;c=0}b=this.ns*C(b-this.long0);return a.x=this.k0*c*Math.sin(b)+this.x0,a.y=this.k0*(this.rh-c*Math.cos(b))+this.y0,a},inverse:function(a){var b,c,e,f,h=(a.x-this.x0)/this.k0,g=this.rh-(a.y-this.y0)/this.k0;0<this.ns?(b=Math.sqrt(h*h+g*g),c=1):(b=-Math.sqrt(h*h+g*g),c=-1);var k=0;if(0!==b&&(k=Math.atan2(c*h,c*g)),0!==b||0<this.ns){if(c=1/this.ns,e=Math.pow(b/(this.a*this.f0),c),-9999===(b=va(this.e,e)))return null}else b=-x;return f=C(k/this.ns+this.long0),a.x=f,a.y=b,a},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},Ib={init:function(){this.a=6377397.155;this.es=.006674372230614;this.e=Math.sqrt(this.es);this.lat0||(this.lat0=.863937979737193);this.long0||(this.long0=.4334234309119251);this.k0||(this.k0=.9999);this.s45=.785398163397448;this.s90=2*this.s45;this.fi0=this.lat0;this.e2=this.es;this.e=Math.sqrt(this.e2);this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2));this.uq=1.04216856380474;this.u0=Math.asin(Math.sin(this.fi0)/this.alfa);this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2);this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g;this.k1=this.k0;this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2));this.s0=1.37008346281555;this.n=Math.sin(this.s0);this.ro0=this.k1*this.n0/Math.tan(this.s0);this.ad=this.s90-this.uq},forward:function(a){var b,c,e,f,h,g,k,p=a.y,m=C(a.x-this.long0);return b=Math.pow((1+this.e*Math.sin(p))/(1-this.e*Math.sin(p)),this.alfa*this.e/2),c=2*(Math.atan(this.k*Math.pow(Math.tan(p/2+this.s45),this.alfa)/b)-this.s45),e=-m*this.alfa,f=Math.asin(Math.cos(this.ad)*Math.sin(c)+Math.sin(this.ad)*Math.cos(c)*Math.cos(e)),h=Math.asin(Math.cos(c)*Math.sin(e)/Math.cos(f)),g=this.n*h,k=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(f/2+this.s45),this.n),a.y=k*Math.cos(g)/1,a.x=k*Math.sin(g)/1,this.czech||(a.y*=-1,a.x*=-1),a},inverse:function(a){var b,c,e;b=a.x;a.x=a.y;a.y=b;this.czech||(a.y*=-1,a.x*=-1);b=Math.sqrt(a.x*a.x+a.y*a.y);e=Math.atan2(a.y,a.x)/Math.sin(this.s0);c=2*(Math.atan(Math.pow(this.ro0/b,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45);b=Math.asin(Math.cos(this.ad)*Math.sin(c)-Math.sin(this.ad)*Math.cos(c)*Math.cos(e));a.x=this.long0-Math.asin(Math.cos(c)*Math.sin(e)/Math.cos(b))/this.alfa;e=b;var f=c=0;do a.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(b/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(e))/(1-this.e*Math.sin(e)),this.e/2))-this.s45),1E-10>Math.abs(e-a.y)&&(c=1),e=a.y,f+=1;while(0===c&&15>f);return 15<=f?null:a},names:["Krovak","krovak"]},fa=function(a,c,e,f,h){return a*h-c*Math.sin(2*h)+e*Math.sin(4*h)-f*Math.sin(6*h)},vb=function(a){return 1-.25*a*(1+a/16*(3+1.25*a))},na=function(a){return.375*a*(1+.25*a*(1+.46875*a))},ib=function(a){return.05859375*a*a*(1+.75*a)},ab=function(a){return 35/3072*a*a*a},bb=function(a,c,e){c*=e;return a/Math.sqrt(1-c*c)},qb=function(a){return Math.abs(a)<x?a:a-(0>a?-1:1)*Math.PI},ja=function(a,c,e,f,h){var b,l;b=a/c;for(var g=0;15>g;g++)if(l=(a-(c*b-e*Math.sin(2*b)+f*Math.sin(4*b)-h*Math.sin(6*b)))/(c-2*e*Math.cos(2*b)+4*f*Math.cos(4*b)-6*h*Math.cos(6*b)),b+=l,1E-10>=Math.abs(l))return b;return NaN},Bb={init:function(){this.sphere||(this.e0=vb(this.es),this.e1=na(this.es),this.e2=ib(this.es),this.e3=ab(this.es),this.ml0=this.a*fa(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(a){var b,c,e=a.x;c=a.y;if(e=C(e-this.long0),this.sphere)b=this.a*Math.asin(Math.cos(c)*Math.sin(e)),c=this.a*(Math.atan2(Math.tan(c),Math.cos(e))-this.lat0);else{var f=Math.sin(c),h=Math.cos(c),g=bb(this.a,this.e,f),k=Math.tan(c)*Math.tan(c);b=e*Math.cos(c);var e=b*b,p=this.es*h*h/(1-this.es);b=g*b*(1-e*k*(1/6-(8-k+8*p)*e/120));c=this.a*fa(this.e0,this.e1,this.e2,this.e3,c)-this.ml0+g*f/h*e*(.5+(5-k+6*p)*e/24)}return a.x=b+this.x0,a.y=c+this.y0,a},inverse:function(a){a.x-=this.x0;a.y-=this.y0;var b,c,e=a.x/this.a;b=a.y/this.a;if(this.sphere)c=b+this.lat0,b=Math.asin(Math.sin(c)*Math.cos(e)),c=Math.atan2(Math.tan(e),Math.cos(c));else{c=ja(this.ml0/this.a+b,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(c)-x)<=y)return a.x=this.long0,a.y=x,0>b&&(a.y*=-1),a;b=bb(this.a,this.e,Math.sin(c));var f=Math.pow(Math.tan(c),2),e=e*this.a/b,h=e*e;b=c-b*Math.tan(c)/(b*b*b/this.a/this.a*(1-this.es))*e*e*(.5-(1+3*f)*e*e/24);c=e*(1-h*(f/3+(1+3*f)*f*h/15))/Math.cos(c)}return a.x=C(c+this.long0),a.y=qb(b),a},names:["Cassini","Cassini_Soldner","cass"]},Pa=function(a,c){var b;return 1E-7<a?(b=a*c,(1-a*a)*(c/(1-b*b)-.5/a*Math.log((1-b)/(1+b)))):2*c},Qa={init:function(){var a=Math.abs(this.lat0);if(Math.abs(a-x)<y?this.mode=0>this.lat0?this.S_POLE:this.N_POLE:Math.abs(a)<y?this.mode=this.EQUIT:this.mode=this.OBLIQ,0<this.es){var c;this.qp=Pa(this.e,1);this.mmf=.5/(1-this.es);var a=this.es,e=[];switch(this.apa=(e[0]=.3333333333333333*a,c=a*a,e[0]+=.17222222222222222*c,e[1]=.06388888888888888*c,c*=a,e[0]+=.10257936507936508*c,e[1]+=.0664021164021164*c,e[2]=.016415012942191543*c,e),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp);this.dd=1/this.rq;this.xmf=1;this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),c=Math.sin(this.lat0),this.sinb1=Pa(this.e,c)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*c*c)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(a){var b,c,e,f,h,g,k,p,m;f=a.x;var q=a.y;if(f=C(f-this.long0),this.sphere)if(h=Math.sin(q),g=Math.cos(q),e=Math.cos(f),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((c=this.mode===this.EQUIT?1+g*e:1+this.sinph0*h+this.cosph0*g*e)<=y)return null;b=(c=Math.sqrt(2/c))*g*Math.sin(f);c*=this.mode===this.EQUIT?h:this.cosph0*h-this.sinph0*g*e}else{if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(e=-e),Math.abs(q+this.phi0)<y)return null;c=K-.5*q;b=(c=2*(this.mode===this.S_POLE?Math.cos(c):Math.sin(c)))*Math.sin(f);c*=e}}else{switch(k=0,p=0,m=0,e=Math.cos(f),f=Math.sin(f),h=Math.sin(q),g=Pa(this.e,h),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(k=g/this.qp,p=Math.sqrt(1-k*k)),this.mode){case this.OBLIQ:m=1+this.sinb1*k+this.cosb1*p*e;break;case this.EQUIT:m=1+p*e;break;case this.N_POLE:m=x+q;g=this.qp-g;break;case this.S_POLE:m=q-x,g=this.qp+g}if(Math.abs(m)<y)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:m=Math.sqrt(2/m);c=this.mode===this.OBLIQ?this.ymf*m*(this.cosb1*k-this.sinb1*p*e):(m=Math.sqrt(2/(1+p*e)))*k*this.ymf;b=this.xmf*m*p*f;break;case this.N_POLE:case this.S_POLE:0<=g?(b=(m=Math.sqrt(g))*f,c=e*(this.mode===this.S_POLE?m:-m)):b=c=0}}return a.x=this.a*b+this.x0,a.y=this.a*c+this.y0,a},inverse:function(a){a.x-=this.x0;a.y-=this.y0;var b,c,e,f,h;b=a.x/this.a;var g=a.y/this.a;if(this.sphere){h=f=0;if(e=Math.sqrt(b*b+g*g),1<(c=.5*e))return null;switch(c=2*Math.asin(c),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(h=Math.sin(c),f=Math.cos(c)),this.mode){case this.EQUIT:c=Math.abs(e)<=y?0:Math.asin(g*h/e);b*=h;g=f*e;break;case this.OBLIQ:c=Math.abs(e)<=y?this.phi0:Math.asin(f*this.sinph0+g*h*this.cosph0/e);b*=h*this.cosph0;g=(f-Math.sin(c)*this.sinph0)*e;break;case this.N_POLE:g=-g;c=x-c;break;case this.S_POLE:c-=x}b=0!==g||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(b,g):0}else{if(c=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(b/=this.dd,g*=this.dd,(h=Math.sqrt(b*b+g*g))<y)return a.x=0,a.y=this.phi0,a;f=2*Math.asin(.5*h/this.rq);e=Math.cos(f);b*=f=Math.sin(f);this.mode===this.OBLIQ?(c=e*this.sinb1+g*f*this.cosb1/h,g=h*this.cosb1*e-g*this.sinb1*f):(c=g*f/h,g=h*e)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(g=-g),!(c=b*b+g*g))return a.x=0,a.y=this.phi0,a;c=1-c/this.qp;this.mode===this.S_POLE&&(c=-c)}b=Math.atan2(b,g);g=Math.asin(c);c=this.apa;e=g+g;c=g+c[0]*Math.sin(e)+c[1]*Math.sin(e+e)+c[2]*Math.sin(e+e+e)}return a.x=C(this.long0+b),a.y=c,a},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4},ma=function(a){return 1<Math.abs(a)&&(a=1<a?1:-1),Math.asin(a)},hc={init:function(){Math.abs(this.lat1+this.lat2)<y||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=oa(this.e3,this.sin_po,this.cos_po),this.qs1=Pa(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=oa(this.e3,this.sin_po,this.cos_po),this.qs2=Pa(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Pa(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>y?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(a){var b=a.x,c=a.y;this.sin_phi=Math.sin(c);this.cos_phi=Math.cos(c);var c=Pa(this.e3,this.sin_phi,this.cos_phi),c=this.a*Math.sqrt(this.c-this.ns0*c)/this.ns0,b=this.ns0*C(b-this.long0),e=this.rh-c*Math.cos(b)+this.y0;return a.x=c*Math.sin(b)+this.x0,a.y=e,a},inverse:function(a){var b,c,e,f,h,g;return a.x-=this.x0,a.y=this.rh-a.y+this.y0,0<=this.ns0?(b=Math.sqrt(a.x*a.x+a.y*a.y),e=1):(b=-Math.sqrt(a.x*a.x+a.y*a.y),e=-1),f=0,0!==b&&(f=Math.atan2(e*a.x,e*a.y)),e=b*this.ns0/this.a,this.sphere?g=Math.asin((this.c-e*e)/(2*this.ns0)):(c=(this.c-e*e)/this.ns0,g=this.phi1z(this.e3,c)),h=C(f/this.ns0+this.long0),a.x=h,a.y=g,a},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(a,c){var b,e,f,h,g,l=ma(.5*c);if(a<y)return l;for(var k=a*a,p=1;25>=p;p++)if(b=Math.sin(l),e=Math.cos(l),f=a*b,h=1-f*f,g=.5*h*h/e*(c/(1-k)-b/h+.5/a*Math.log((1-f)/(1+f))),l+=g,1E-7>=Math.abs(g))return l;return null}},Cb={init:function(){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0);this.infinity_dist=1E3*this.a;this.rc=1},forward:function(a){var b,c,e,f,h,g,k,p=a.y;return e=C(a.x-this.long0),b=Math.sin(p),c=Math.cos(p),f=Math.cos(e),0<(h=this.sin_p14*b+this.cos_p14*c*f)||Math.abs(h)<=y?(g=this.x0+1*this.a*c*Math.sin(e)/h,k=this.y0+1*this.a*(this.cos_p14*b-this.sin_p14*c*f)/h):(g=this.x0+this.infinity_dist*c*Math.sin(e),k=this.y0+this.infinity_dist*(this.cos_p14*b-this.sin_p14*c*f)),a.x=g,a.y=k,a},inverse:function(a){var b,c,e,f,h,g;return a.x=(a.x-this.x0)/this.a,a.y=(a.y-this.y0)/this.a,a.x/=this.k0,a.y/=this.k0,(b=Math.sqrt(a.x*a.x+a.y*a.y))?(f=Math.atan2(b,this.rc),c=Math.sin(f),e=Math.cos(f),g=ma(e*this.sin_p14+a.y*c*this.cos_p14/b),h=Math.atan2(a.x*c,b*this.cos_p14*e-a.y*this.sin_p14*c),h=C(this.long0+h)):(g=this.phic0,h=0),a.x=h,a.y=g,a},names:["gnom"]},Db={init:function(){this.sphere||(this.k0=oa(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(a){var b,c;c=a.y;b=C(a.x-this.long0);this.sphere?(b=this.x0+this.a*b*Math.cos(this.lat_ts),c=this.y0+this.a*Math.sin(c)/Math.cos(this.lat_ts)):(c=Pa(this.e,Math.sin(c)),b=this.x0+this.a*this.k0*b,c=this.y0+this.a*c*.5/this.k0);return a.x=b,a.y=c,a},inverse:function(a){a.x-=this.x0;a.y-=this.y0;var b,c;if(this.sphere)b=C(this.long0+a.x/this.a/Math.cos(this.lat_ts)),c=Math.asin(a.y/this.a*Math.cos(this.lat_ts));else{a:if(b=this.e,c=2*a.y*this.k0/this.a,1E-6>Math.abs(Math.abs(c)-(1-(1-b*b)/(2*b)*Math.log((1-b)/(1+b)))))b=0>c?-1*x:x;else{for(var e,f,h,g,k=Math.asin(.5*c),p=0;30>p;p++)if(f=Math.sin(k),h=Math.cos(k),g=b*f,e=Math.pow(1-g*g,2)/(2*h)*(c/(1-b*b)-f/(1-g*g)+.5/b*Math.log((1-g)/(1+g))),k+=e,1E-10>=Math.abs(e)){b=k;break a}b=NaN}c=b;b=C(this.long0+a.x/(this.a*this.k0))}return a.x=b,a.y=c,a},names:["cea"]},ic={init:function(){this.x0=this.x0||0;this.y0=this.y0||0;this.lat0=this.lat0||0;this.long0=this.long0||0;this.lat_ts=this.lat_ts||0;this.title=this.title||"Equidistant Cylindrical (Plate Carre)";this.rc=Math.cos(this.lat_ts)},forward:function(a){var b=a.y,c=C(a.x-this.long0),b=qb(b-this.lat0);return a.x=this.x0+this.a*c*this.rc,a.y=this.y0+this.a*b,a},inverse:function(a){var b=a.y;return a.x=C(this.long0+(a.x-this.x0)/(this.a*this.rc)),a.y=qb(this.lat0+(b-this.y0)/this.a),a},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},jc={init:function(){this.temp=this.b/this.a;this.es=1-Math.pow(this.temp,2);this.e=Math.sqrt(this.es);this.e0=vb(this.es);this.e1=na(this.es);this.e2=ib(this.es);this.e3=ab(this.es);this.ml0=this.a*fa(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(a){var b,c,e,f=a.y,h=C(a.x-this.long0);(e=h*Math.sin(f),this.sphere)?Math.abs(f)<=y?(b=this.a*h,c=-1*this.a*this.lat0):(b=this.a*Math.sin(e)/Math.tan(f),c=this.a*(qb(f-this.lat0)+(1-Math.cos(e))/Math.tan(f))):Math.abs(f)<=y?(b=this.a*h,c=-1*this.ml0):(c=bb(this.a,this.e,Math.sin(f))/Math.tan(f),b=c*Math.sin(e),c=this.a*fa(this.e0,this.e1,this.e2,this.e3,f)-this.ml0+c*(1-Math.cos(e)));return a.x=b+this.x0,a.y=c+this.y0,a},inverse:function(a){var b,c,e,f,h,g,k;if(b=a.x-this.x0,e=a.y-this.y0,this.sphere)if(Math.abs(e+this.a*this.lat0)<=y)b=C(b/this.a+this.long0),c=0;else{f=this.lat0+e/this.a;h=b*b/this.a/this.a+f*f;g=f;var p;for(e=20;e;--e)if(p=Math.tan(g),k=-1*(f*(g*p+1)-g-.5*(g*g+h)*p)/((g-f)/p-1),g+=k,Math.abs(k)<=y){c=g;break}b=C(this.long0+Math.asin(b*Math.tan(g)/this.a)/Math.sin(c))}else if(Math.abs(e+this.ml0)<=y)c=0,b=C(this.long0+b/this.a);else{f=(this.ml0+e)/this.a;h=b*b/this.a/this.a+f*f;g=f;var m,q,u,v,w;for(e=20;e;--e)if(w=this.e*Math.sin(g),m=Math.sqrt(1-w*w)*Math.tan(g),q=this.a*fa(this.e0,this.e1,this.e2,this.e3,g),u=this.e0-2*this.e1*Math.cos(2*g)+4*this.e2*Math.cos(4*g)-6*this.e3*Math.cos(6*g),v=q/this.a,k=(f*(m*v+1)-v-.5*m*(v*v+h))/(this.es*Math.sin(2*g)*(v*v+h-2*f*v)/(4*m)+(f-v)*(m*u-2/Math.sin(2*g))-u),g-=k,Math.abs(k)<=y){c=g;break}m=Math.sqrt(1-this.es*Math.pow(Math.sin(c),2))*Math.tan(c);b=C(this.long0+Math.asin(b*m/this.a)/Math.sin(c))}return a.x=b,a.y=c,a},names:["Polyconic","poly"]},Rc={init:function(){this.A=[];this.A[1]=.6399175073;this.A[2]=-.1358797613;this.A[3]=.063294409;this.A[4]=-.02526853;this.A[5]=.0117879;this.A[6]=-.0055161;this.A[7]=.0026906;this.A[8]=-.001333;this.A[9]=6.7E-4;this.A[10]=-3.4E-4;this.B_re=[];this.B_im=[];this.B_re[1]=.7557853228;this.B_im[1]=0;this.B_re[2]=.249204646;this.B_im[2]=.003371507;this.B_re[3]=-.001541739;this.B_im[3]=.04105856;this.B_re[4]=-.10162907;this.B_im[4]=.01727609;this.B_re[5]=-.26623489;this.B_im[5]=-.36249218;this.B_re[6]=-.6870983;this.B_im[6]=-1.1651967;this.C_re=[];this.C_im=[];this.C_re[1]=1.3231270439;this.C_im[1]=0;this.C_re[2]=-.577245789;this.C_im[2]=-.007809598;this.C_re[3]=.508307513;this.C_im[3]=-.112208952;this.C_re[4]=-.15094762;this.C_im[4]=.18200602;this.C_re[5]=1.01418179;this.C_im[5]=1.64497696;this.C_re[6]=1.9660549;this.C_im[6]=2.5127645;this.D=[];this.D[1]=1.5627014243;this.D[2]=.5185406398;this.D[3]=-.03333098;this.D[4]=-.1052906;this.D[5]=-.0368594;this.D[6]=.007317;this.D[7]=.0122;this.D[8]=.00394;this.D[9]=-.0013},forward:function(a){var b,c=a.x-this.long0,e=(a.y-this.lat0)/Ja*1E-5,f=1,h=0;for(b=1;10>=b;b++)f*=e,h+=this.A[b]*f;var f=h,h=1,g=0,k=0,p=0;for(b=1;6>=b;b++)e=g*f+h*c,h=h*f-g*c,g=e,k=k+this.B_re[b]*h-this.B_im[b]*g,p=p+this.B_im[b]*h+this.B_re[b]*g;return a.x=p*this.a+this.x0,a.y=k*this.a+this.y0,a},inverse:function(a){var b,c,e=(a.y-this.y0)/this.a,f=(a.x-this.x0)/this.a,h=1,g=0,k=0,p=0;for(b=1;6>=b;b++)c=g*e+h*f,h=h*e-g*f,g=c,k=k+this.C_re[b]*h-this.C_im[b]*g,p=p+this.C_im[b]*h+this.C_re[b]*g;for(c=0;c<this.iterations;c++){var m,q=k,u=p,h=e,g=f;for(b=2;6>=b;b++)m=u*k+q*p,q=q*k-u*p,u=m,h+=(b-1)*(this.B_re[b]*q-this.B_im[b]*u),g+=(b-1)*(this.B_im[b]*q+this.B_re[b]*u);var q=1,u=0,v=this.B_re[1],w=this.B_im[1];for(b=2;6>=b;b++)m=u*k+q*p,q=q*k-u*p,u=m,v+=b*(this.B_re[b]*q-this.B_im[b]*u),w+=b*(this.B_im[b]*q+this.B_re[b]*u);p=v*v+w*w;k=(h*v+g*w)/p;p=(g*v-h*w)/p}e=k;f=1;k=0;for(b=1;9>=b;b++)f*=e,k+=this.D[b]*f;b=this.lat0+k*Ja*1E5;return a.x=this.long0+p,a.y=b,a},names:["New_Zealand_Map_Grid","nzmg"]},kc={init:function(){},forward:function(a){var b=a.y,c=C(a.x-this.long0),b=this.y0+this.a*Math.log(Math.tan(Math.PI/4+b/2.5))*1.25;return a.x=this.x0+this.a*c,a.y=b,a},inverse:function(a){a.x-=this.x0;a.y-=this.y0;var b=C(this.long0+a.x/this.a),c=2.5*(Math.atan(Math.exp(.8*a.y/this.a))-Math.PI/4);return a.x=b,a.y=c,a},names:["Miller_Cylindrical","mill"]},Vb={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=ec(this.es)},forward:function(a){var b,c;b=a.x;c=a.y;if(b=C(b-this.long0),this.sphere){if(this.m)for(var e=this.n*Math.sin(c),f=20;f;--f){var h=(this.m*c+Math.sin(c)-e)/(this.m+Math.cos(c));if(c-=h,Math.abs(h)<y)break}else c=1!==this.n?Math.asin(this.n*Math.sin(c)):c;b=this.a*this.C_x*b*(this.m+Math.cos(c));c*=this.a*this.C_y}else e=Math.sin(c),f=Math.cos(c),c=this.a*eb(c,e,f,this.en),b=this.a*b*f/Math.sqrt(1-this.es*e*e);return a.x=b,a.y=c,a},inverse:function(a){var b,c,e,f;return a.x-=this.x0,e=a.x/this.a,a.y-=this.y0,b=a.y/this.a,this.sphere?(b/=this.C_y,e/=this.C_x*(this.m+Math.cos(b)),this.m?b=ma((this.m*b+Math.sin(b))/this.n):1!==this.n&&(b=ma(Math.sin(b)/this.n)),e=C(e+this.long0),b=qb(b)):(b=Ya(a.y/this.a,this.es,this.en),(f=Math.abs(b))<x?(f=Math.sin(b),c=this.long0+a.x*Math.sqrt(1-this.es*f*f)/(this.a*Math.cos(b)),e=C(c)):f-y<x&&(e=this.long0)),a.x=e,a.y=b,a},names:["Sinusoidal","sinu"]},rb={init:function(){},forward:function(a){for(var b=a.y,c=C(a.x-this.long0),e=b,f=Math.PI*Math.sin(b);;){var h=-(e+Math.sin(e)-f)/(1+Math.cos(e));if(e+=h,Math.abs(h)<y)break}e/=2;Math.PI/2-Math.abs(b)<y&&(c=0);b=1.4142135623731*this.a*Math.sin(e)+this.y0;return a.x=.900316316158*this.a*c*Math.cos(e)+this.x0,a.y=b,a},inverse:function(a){var b;a.x-=this.x0;a.y-=this.y0;b=a.y/(1.4142135623731*this.a);.999999999999<Math.abs(b)&&(b=.999999999999);b=Math.asin(b);var c=C(this.long0+a.x/(.900316316158*this.a*Math.cos(b)));c<-Math.PI&&(c=-Math.PI);c>Math.PI&&(c=Math.PI);b=(2*b+Math.sin(2*b))/Math.PI;1<Math.abs(b)&&(b=1);b=Math.asin(b);return a.x=c,a.y=b,a},names:["Mollweide","moll"]},wb={init:function(){Math.abs(this.lat1+this.lat2)<y||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=vb(this.es),this.e1=na(this.es),this.e2=ib(this.es),this.e3=ab(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=oa(this.e,this.sinphi,this.cosphi),this.ml1=fa(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<y?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=oa(this.e,this.sinphi,this.cosphi),this.ml2=fa(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=fa(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(a){var b,c=a.x;b=a.y;this.sphere||(b=fa(this.e0,this.e1,this.e2,this.e3,b));b=this.a*(this.g-b);var c=this.ns*C(c-this.long0),e=this.y0+this.rh-b*Math.cos(c);return a.x=this.x0+b*Math.sin(c),a.y=e,a},inverse:function(a){a.x-=this.x0;a.y=this.rh-a.y+this.y0;var b,c,e,f;0<=this.ns?(c=Math.sqrt(a.x*a.x+a.y*a.y),b=1):(c=-Math.sqrt(a.x*a.x+a.y*a.y),b=-1);var h=0;return(0!==c&&(h=Math.atan2(b*a.x,b*a.y)),this.sphere)?(f=C(this.long0+h/this.ns),e=qb(this.g-c/this.a),a.x=f,a.y=e,a):(e=ja(this.g-c/this.a,this.e0,this.e1,this.e2,this.e3),f=C(this.long0+h/this.ns),a.x=f,a.y=e,a)},names:["Equidistant_Conic","eqdc"]},lc={init:function(){this.R=this.a},forward:function(a){var b,c,e=a.y;b=C(a.x-this.long0);Math.abs(e)<=y&&(c=this.y0);var f=ma(2*Math.abs(e/Math.PI));(Math.abs(b)<=y||Math.abs(Math.abs(e)-x)<=y)&&(c=0<=e?this.y0+Math.PI*this.R*Math.tan(.5*f):this.y0+Math.PI*this.R*-Math.tan(.5*f));var h=.5*Math.abs(Math.PI/b-b/Math.PI),g=h*h,k=Math.sin(f),f=Math.cos(f),f=f/(k+f-1),k=f*(2/k-1),p=k*k,m=Math.PI*this.R*(h*(f-p)+Math.sqrt(g*(f-p)*(f-p)-(p+g)*(f*f-p)))/(p+g);0>b&&(m=-m);b=this.x0+m;f=g+f;return m=Math.PI*this.R*(k*f-h*Math.sqrt((p+g)*(g+1)-f*f))/(p+g),c=0<=e?this.y0+m:this.y0-m,a.x=b,a.y=c,a},inverse:function(a){var b,c,e,f,h,g,k,p,m,q,u,v,w;return a.x-=this.x0,a.y-=this.y0,u=Math.PI*this.R,e=a.x/u,f=a.y/u,h=e*e+f*f,g=-Math.abs(f)*(1+h),k=g-2*f*f+e*e,p=-2*g+1+2*f*f+h*h,w=f*f/p+(2*k*k*k/p/p/p-9*g*k/p/p)/27,m=(g-k*k/3/p)/p,q=2*Math.sqrt(-m/3),u=3*w/m/q,1<Math.abs(u)&&(u=0<=u?1:-1),v=Math.acos(u)/3,c=0<=a.y?(-q*Math.cos(v+Math.PI/3)-k/3/p)*Math.PI:-(-q*Math.cos(v+Math.PI/3)-k/3/p)*Math.PI,b=Math.abs(e)<y?this.long0:C(this.long0+Math.PI*(h-1+Math.sqrt(1+2*(e*e-f*f)+h*h))/2/e),a.x=b,a.y=c,a},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},kb={init:function(){this.sin_p12=Math.sin(this.lat0);this.cos_p12=Math.cos(this.lat0)},forward:function(a){var b,c,e,f,h,g,k,p,m,q,u,v,w,z,F,E,B,D,H,I,G,M,O,K=a.y,N=Math.sin(a.y),P=Math.cos(a.y),J=C(a.x-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=y?(a.x=this.x0+this.a*(x-K)*Math.sin(J),a.y=this.y0-this.a*(x-K)*Math.cos(J),a):Math.abs(this.sin_p12+1)<=y?(a.x=this.x0+this.a*(x+K)*Math.sin(J),a.y=this.y0+this.a*(x+K)*Math.cos(J),a):(D=this.sin_p12*N+this.cos_p12*P*Math.cos(J),E=Math.acos(D),B=E/Math.sin(E),a.x=this.x0+this.a*B*P*Math.sin(J),a.y=this.y0+this.a*B*(this.cos_p12*N-this.sin_p12*P*Math.cos(J)),a):(b=vb(this.es),c=na(this.es),e=ib(this.es),f=ab(this.es),Math.abs(this.sin_p12-1)<=y?(h=this.a*fa(b,c,e,f,x),g=this.a*fa(b,c,e,f,K),a.x=this.x0+(h-g)*Math.sin(J),a.y=this.y0-(h-g)*Math.cos(J),a):Math.abs(this.sin_p12+1)<=y?(h=this.a*fa(b,c,e,f,x),g=this.a*fa(b,c,e,f,K),a.x=this.x0+(h+g)*Math.sin(J),a.y=this.y0+(h+g)*Math.cos(J),a):(k=N/P,p=bb(this.a,this.e,this.sin_p12),m=bb(this.a,this.e,N),q=Math.atan((1-this.es)*k+this.es*p*this.sin_p12/(m*P)),u=Math.atan2(Math.sin(J),this.cos_p12*Math.tan(q)-this.sin_p12*Math.cos(J)),H=0===u?Math.asin(this.cos_p12*Math.sin(q)-this.sin_p12*Math.cos(q)):Math.abs(Math.abs(u)-Math.PI)<=y?-Math.asin(this.cos_p12*Math.sin(q)-this.sin_p12*Math.cos(q)):Math.asin(Math.sin(J)*Math.cos(q)/Math.sin(u)),v=this.e*this.sin_p12/Math.sqrt(1-this.es),w=this.e*this.cos_p12*Math.cos(u)/Math.sqrt(1-this.es),z=v*w,F=w*w,I=H*H,G=I*H,M=G*H,O=M*H,E=p*H*(1-I*F*(1-F)/6+G/8*z*(1-2*F)+M/120*(F*(4-7*F)-3*v*v*(1-7*F))-O/48*z),a.x=this.x0+E*Math.sin(u),a.y=this.y0+E*Math.cos(u),a))},inverse:function(a){a.x-=this.x0;a.y-=this.y0;var b,c,e,f,h,g,k,p,m,q,u,v,w,z,F,E,B,D,H,J,I,G,K;return this.sphere?(b=Math.sqrt(a.x*a.x+a.y*a.y))>2*x*this.a?void 0:(c=b/this.a,e=Math.sin(c),f=Math.cos(c),h=this.long0,Math.abs(b)<=y?g=this.lat0:(g=ma(f*this.sin_p12+a.y*e*this.cos_p12/b),k=Math.abs(this.lat0)-x,h=C(Math.abs(k)<=y?0<=this.lat0?this.long0+Math.atan2(a.x,-a.y):this.long0-Math.atan2(-a.x,a.y):this.long0+Math.atan2(a.x*e,b*this.cos_p12*f-a.y*this.sin_p12*e))),a.x=h,a.y=g,a):(p=vb(this.es),m=na(this.es),q=ib(this.es),u=ab(this.es),Math.abs(this.sin_p12-1)<=y?(v=this.a*fa(p,m,q,u,x),b=Math.sqrt(a.x*a.x+a.y*a.y),w=v-b,g=ja(w/this.a,p,m,q,u),h=C(this.long0+Math.atan2(a.x,-1*a.y)),a.x=h,a.y=g,a):Math.abs(this.sin_p12+1)<=y?(v=this.a*fa(p,m,q,u,x),b=Math.sqrt(a.x*a.x+a.y*a.y),w=b-v,g=ja(w/this.a,p,m,q,u),h=C(this.long0+Math.atan2(a.x,a.y)),a.x=h,a.y=g,a):(b=Math.sqrt(a.x*a.x+a.y*a.y),E=Math.atan2(a.x,a.y),z=bb(this.a,this.e,this.sin_p12),B=Math.cos(E),D=this.e*this.cos_p12*B,H=-D*D/(1-this.es),J=3*this.es*(1-H)*this.sin_p12*this.cos_p12*B/(1-this.es),I=b/z,G=I-H*(1+H)*Math.pow(I,3)/6-J*(1+3*H)*Math.pow(I,4)/24,K=1-H*G*G/2-I*G*G*G/6,F=Math.asin(this.sin_p12*Math.cos(G)+this.cos_p12*Math.sin(G)*B),h=C(this.long0+Math.asin(Math.sin(E)*Math.sin(G)/Math.cos(F))),g=Math.atan((1-this.es*K*this.sin_p12/Math.sin(F))*Math.tan(F)/(1-this.es)),a.x=h,a.y=g,a))},names:["Azimuthal_Equidistant","aeqd"]},Eb={init:function(){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0)},forward:function(a){var b,c,e,f,h,g,k,p=a.y;return e=C(a.x-this.long0),b=Math.sin(p),c=Math.cos(p),f=Math.cos(e),(0<(h=this.sin_p14*b+this.cos_p14*c*f)||Math.abs(h)<=y)&&(g=1*this.a*c*Math.sin(e),k=this.y0+1*this.a*(this.cos_p14*b-this.sin_p14*c*f)),a.x=g,a.y=k,a},inverse:function(a){var b,c,e,f,h,g,k;return a.x-=this.x0,a.y-=this.y0,b=Math.sqrt(a.x*a.x+a.y*a.y),c=ma(b/this.a),e=Math.sin(c),f=Math.cos(c),g=this.long0,Math.abs(b)<=y?(k=this.lat0,a.x=g,a.y=k,a):(k=ma(f*this.sin_p14+a.y*e*this.cos_p14/b),h=Math.abs(this.lat0)-x,Math.abs(h)<=y?(g=C(0<=this.lat0?this.long0+Math.atan2(a.x,-a.y):this.long0-Math.atan2(-a.x,a.y)),a.x=g,a.y=k,a):(g=C(this.long0+Math.atan2(a.x*e,b*this.cos_p14*f-a.y*this.sin_p14*e)),a.x=g,a.y=k,a))},names:["ortho"]},S={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4},Cc={init:function(){this.x0=this.x0||0;this.y0=this.y0||0;this.lat0=this.lat0||0;this.long0=this.long0||0;this.lat_ts=this.lat_ts||0;this.title=this.title||"Quadrilateralized Spherical Cube";this.lat0>=x-K/2?this.face=5:this.lat0<=-(x-K/2)?this.face=6:Math.abs(this.long0)<=K?this.face=1:Math.abs(this.long0)<=x+K?this.face=0<this.long0?2:4:this.face=3;0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(a){var b,c,e,f,h,g,k=0,p=0,m={value:0};if(a.x-=this.long0,b=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(a.y)):a.y,c=a.x,5===this.face)f=x-b,c>=K&&c<=x+K?(m.value=S.AREA_0,e=c-x):c>x+K||c<=-(x+K)?(m.value=S.AREA_1,e=0<c?c-R:c+R):c>-(x+K)&&c<=-K?(m.value=S.AREA_2,e=c+x):(m.value=S.AREA_3,e=c);else if(6===this.face)f=x+b,c>=K&&c<=x+K?(m.value=S.AREA_0,e=-c+x):c<K&&c>=-K?(m.value=S.AREA_1,e=-c):c<-K&&c>=-(x+K)?(m.value=S.AREA_2,e=-c-x):(m.value=S.AREA_3,e=0<c?-c+R:-c-R);else{var q,u;2===this.face?c=qa(c,+x):3===this.face?c=qa(c,+R):4===this.face&&(c=qa(c,-x));q=Math.sin(b);b=Math.cos(b);u=Math.sin(c);c=b*Math.cos(c);b*=u;1===this.face?e=Da(f=Math.acos(c),q,b,m):2===this.face?e=Da(f=Math.acos(b),q,-c,m):3===this.face?e=Da(f=Math.acos(-c),q,-b,m):4===this.face?e=Da(f=Math.acos(-b),q,c,m):(f=e=0,m.value=S.AREA_0)}return g=Math.atan(12/R*(e+Math.acos(Math.sin(e)*Math.cos(K))-x)),h=Math.sqrt((1-Math.cos(f))/(Math.cos(g)*Math.cos(g))/(1-Math.cos(Math.atan(1/Math.cos(e))))),m.value===S.AREA_1?g+=x:m.value===S.AREA_2?g+=R:m.value===S.AREA_3&&(g+=1.5*R),k=h*Math.cos(g),p=h*Math.sin(g),k=k*this.a+this.x0,p=p*this.a+this.y0,a.x=k,a.y=p,a},inverse:function(a){var b,c,e,f,h,g,k,p,m,q=0,u=0;if(a.x=(a.x-this.x0)/this.a,a.y=(a.y-this.y0)/this.a,c=Math.atan(Math.sqrt(a.x*a.x+a.y*a.y)),b=Math.atan2(a.y,a.x),0<=a.x&&a.x>=Math.abs(a.y)?u=S.AREA_0:0<=a.y&&a.y>=Math.abs(a.x)?(u=S.AREA_1,b-=x):0>a.x&&-a.x>=Math.abs(a.y)?(u=S.AREA_2,b=0>b?b+R:b-R):(u=S.AREA_3,b+=x),m=R/12*Math.tan(b),h=Math.sin(m)/(Math.cos(m)-1/Math.sqrt(2)),g=Math.atan(h),e=Math.cos(b),f=Math.tan(c),-1>(k=1-e*e*f*f*(1-Math.cos(Math.atan(1/Math.cos(g)))))?k=-1:1<k&&(k=1),5===this.face)p=Math.acos(k),m=x-p,u===S.AREA_0?q=g+x:u===S.AREA_1?q=0>g?g+R:g-R:u===S.AREA_2?q=g-x:q=g;else if(6===this.face)p=Math.acos(k),m=p-x,u===S.AREA_0?q=-g+x:u===S.AREA_1?q=-g:u===S.AREA_2?q=-g-x:q=0>g?-g-R:-g+R;else{var v;m=(p=k)*p;q=1<=(m+=(v=1<=m?0:Math.sqrt(1-m)*Math.sin(g))*v)?0:Math.sqrt(1-m);u===S.AREA_1?(m=q,q=-v,v=m):u===S.AREA_2?(q=-q,v=-v):u===S.AREA_3&&(m=q,q=v,v=-m);2===this.face?(m=p,p=-q,q=m):3===this.face?(p=-p,q=-q):4===this.face&&(m=p,p=q,q=-m);m=Math.acos(-v)-x;q=Math.atan2(q,p);2===this.face?q=qa(q,-x):3===this.face?q=qa(q,-R):4===this.face&&(q=qa(q,+x))}0!==this.es&&(u=0>m?1:0,g=Math.tan(m),g=this.b/Math.sqrt(g*g+this.one_minus_f_squared),m=Math.atan(Math.sqrt(this.a*this.a-g*g)/(this.one_minus_f*g)),u&&(m=-m));return q+=this.long0,a.x=q,a.y=m,a},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},Fb=[[1,2.2199E-17,-7.15515E-5,3.1103E-6],[.9986,-4.82243E-4,-2.4897E-5,-1.3309E-6],[.9954,-8.3103E-4,-4.48605E-5,-9.86701E-7],[.99,-.00135364,-5.9661E-5,3.6777E-6],[.9822,-.00167442,-4.49547E-6,-5.72411E-6],[.973,-.00214868,-9.03571E-5,1.8736E-8],[.96,-.00305085,-9.00761E-5,1.64917E-6],[.9427,-.00382792,-6.53386E-5,-2.6154E-6],[.9216,-.00467746,-1.0457E-4,4.81243E-6],[.8962,-.00536223,-3.23831E-5,-5.43432E-6],[.8679,-.00609363,-1.13898E-4,3.32484E-6],[.835,-.00698325,-6.40253E-5,9.34959E-7],[.7986,-.00755338,-5.00009E-5,9.35324E-7],[.7597,-.00798324,-3.5971E-5,-2.27626E-6],[.7186,-.00851367,-7.01149E-5,-8.6303E-6],[.6732,-.00986209,-1.99569E-4,1.91974E-5],[.6213,-.010418,8.83923E-5,6.24051E-6],[.5722,-.00906601,1.82E-4,6.24051E-6],[.5322,-.00677797,2.75608E-4,6.24051E-6]],Oa=[[-5.20417E-18,.0124,1.21431E-18,-8.45284E-11],[.062,.0124,-1.26793E-9,4.22642E-10],[.124,.0124,5.07171E-9,-1.60604E-9],[.186,.0123999,-1.90189E-8,6.00152E-9],[.248,.0124002,7.10039E-8,-2.24E-8],[.31,.0123992,-2.64997E-7,8.35986E-8],[.372,.0124029,9.88983E-7,-3.11994E-7],[.434,.0123893,-3.69093E-6,-4.35621E-7],[.4958,.0123198,-1.02252E-5,-3.45523E-7],[.5571,.0121916,-1.54081E-5,-5.82288E-7],[.6176,.0119938,-2.41424E-5,-5.25327E-7],[.6769,.011713,-3.20223E-5,-5.16405E-7],[.7346,.0113541,-3.97684E-5,-6.09052E-7],[.7903,.0109107,-4.89042E-5,-1.04739E-6],[.8435,.0103431,-6.4615E-5,-1.40374E-9],[.8936,.00969686,-6.4636E-5,-8.547E-6],[.9394,.00840947,-1.92841E-4,-4.2106E-6],[.9761,.00616527,-2.56E-4,-4.2106E-6],[1,.00328947,-3.19159E-4,-4.2106E-6]],Wb=ya/5,Dc=1/Wb,Gb=function(a,c){return a[0]+c*(a[1]+c*(a[2]+c*a[3]))},Ec={init:function(){this.x0=this.x0||0;this.y0=this.y0||0;this.long0=this.long0||0;this.es=0;this.title=this.title||"Robinson"},forward:function(a){var b=C(a.x-this.long0),c=Math.abs(a.y),e=Math.floor(c*Wb);0>e?e=0:18<=e&&(e=17);c=ya*(c-Dc*e);b={x:Gb(Fb[e],c)*b,y:Gb(Oa[e],c)};return 0>a.y&&(b.y=-b.y),b.x=b.x*this.a*.8487+this.x0,b.y=b.y*this.a*1.3523+this.y0,b},inverse:function(a){var b={x:(a.x-this.x0)/(.8487*this.a),y:Math.abs(a.y-this.y0)/(1.3523*this.a)};if(1<=b.y)b.x/=Fb[18][0],b.y=0>a.y?-x:x;else{var c=Math.floor(18*b.y);for(0>c?c=0:18<=c&&(c=17);;)if(Oa[c][0]>b.y)--c;else{if(!(Oa[c+1][0]<=b.y))break;++c}var e=Oa[c],f=5*(b.y-e[0])/(Oa[c+1][0]-e[0]),f=cb(function(a){return(Gb(e,a)-b.y)/(e[1]+a*(2*e[2]+3*a*e[3]))},f,y,100);b.x/=Gb(Fb[c],f);b.y=(5*c+f)*aa;0>a.y&&(b.y=-b.y)}return b.x=C(b.x+this.long0),b},names:["Robinson","robin"]};return B.defaultDatum="WGS84",B.Proj=E,B.WGS84=new B.Proj("WGS84"),B.Point=O,B.toPoint=lb,B.defs=h,B.transform=V,B.mgrs=dc,B.version="2.5.0",function(a){a.Proj.projections.add(yb);a.Proj.projections.add(ob);a.Proj.projections.add(Qb);a.Proj.projections.add(wc);a.Proj.projections.add(xc);a.Proj.projections.add(yc);a.Proj.projections.add(zc);a.Proj.projections.add(Bc);a.Proj.projections.add(Ib);a.Proj.projections.add(Bb);a.Proj.projections.add(Qa);a.Proj.projections.add(hc);a.Proj.projections.add(Cb);a.Proj.projections.add(Db);a.Proj.projections.add(ic);a.Proj.projections.add(jc);a.Proj.projections.add(Rc);a.Proj.projections.add(kc);a.Proj.projections.add(Vb);a.Proj.projections.add(rb);a.Proj.projections.add(wb);a.Proj.projections.add(lc);a.Proj.projections.add(kb);a.Proj.projections.add(Eb);a.Proj.projections.add(Cc);a.Proj.projections.add(Ec)}(B),B});(function(a){var e,g;if("function"===typeof define&&define.amd)define(["leaflet","proj4"],a);else if("object"===typeof module&&"object"===typeof module.exports)e=require("leaflet"),g=require("proj4"),module.exports=a(e,g);else{if("undefined"===typeof window.L||"undefined"===typeof window.proj4)throw"Leaflet and proj4 must be loaded first";a(window.L,window.proj4)}})(function(a,e){e.__esModule&&e["default"]&&(e=e["default"]);a.Proj={};a.Proj._isProj4Obj=function(a){return"undefined"!==typeof a.inverse&&"undefined"!==typeof a.forward};a.Proj.Projection=a.Class.extend({initialize:function(e,f,m){var g=a.Proj._isProj4Obj(e);this._proj=g?e:this._projFromCodeDef(e,f);this.bounds=g?f:m},project:function(e){e=this._proj.forward([e.lng,e.lat]);return new a.Point(e[0],e[1])},unproject:function(e,f){var g=this._proj.inverse([e.x,e.y]);return new a.LatLng(g[1],g[0],f)},_projFromCodeDef:function(a,f){if(f)e.defs(a,f);else if(void 0===e.defs[a]){var g=a.split(":");3<g.length&&(a=g[g.length-3]+":"+g[g.length-1]);if(void 0===e.defs[a])throw"No projection definition for code "+a;}return e(a)}});a.Proj.CRS=a.Class.extend({includes:a.CRS,options:{transformation:new a.Transformation(1,0,-1,0)},initialize:function(e,f,m){var g;a.Proj._isProj4Obj(e)?(g=e.srsCode,m=f||{},this.projection=new a.Proj.Projection(e,m.bounds)):(g=e,m=m||{},this.projection=new a.Proj.Projection(g,f,m.bounds));a.Util.setOptions(this,m);this.code=g;this.transformation=this.options.transformation;this.options.origin&&(this.transformation=new a.Transformation(1,-this.options.origin[0],-1,this.options.origin[1]));if(this.options.scales)this._scales=this.options.scales;else if(this.options.resolutions)for(this._scales=[],e=this.options.resolutions.length-1;0<=e;e--)this.options.resolutions[e]&&(this._scales[e]=1/this.options.resolutions[e]);this.infinite=!this.options.bounds},scale:function(a){var e=Math.floor(a),g;if(a===e)return this._scales[a];g=this._scales[e];return g+(this._scales[e+1]-g)*(a-e)},zoom:function(a){var e=this._closestElement(this._scales,a),g=this._scales.indexOf(e),k;if(a===e)return g;if(void 0===e)return-Infinity;k=this._scales[g+1];return void 0===k?Infinity:(a-e)/(k-e)+g},distance:a.CRS.Earth.distance,R:a.CRS.Earth.R,_closestElement:function(a,e){for(var f,g=a.length;g--;)a[g]<=e&&(void 0===f||f<a[g])&&(f=a[g]);return f}});a.Proj.GeoJSON=a.GeoJSON.extend({initialize:function(e,f){this._callLevel=0;a.GeoJSON.prototype.initialize.call(this,e,f)},addData:function(e){var f;e&&(e.crs&&"name"===e.crs.type?f=new a.Proj.CRS(e.crs.properties.name):e.crs&&e.crs.type&&(f=new a.Proj.CRS(e.crs.type+":"+e.crs.properties.code)),void 0!==f&&(this.options.coordsToLatLng=function(e){e=a.point(e[0],e[1]);return f.projection.unproject(e)}));this._callLevel++;try{a.GeoJSON.prototype.addData.call(this,e)}finally{this._callLevel--,0===this._callLevel&&delete this.options.coordsToLatLng}}});a.Proj.geoJson=function(e,f){return new a.Proj.GeoJSON(e,f)};a.Proj.ImageOverlay=a.ImageOverlay.extend({initialize:function(e,f,m){a.ImageOverlay.prototype.initialize.call(this,e,null,m);this._projectedBounds=f},_animateZoom:function(e){var f=this._map.getZoomScale(e.zoom),g=a.point(this._projectedBounds.min.x,this._projectedBounds.max.y);e=this._projectedToNewLayerPoint(g,e.zoom,e.center);a.DomUtil.setTransform(this._image,e,f)},_reset:function(){var e=this._map.getZoom(),f=this._map.getPixelOrigin(),e=a.bounds(this._transform(this._projectedBounds.min,e)._subtract(f),this._transform(this._projectedBounds.max,e)._subtract(f)),f=e.getSize();a.DomUtil.setPosition(this._image,e.min);this._image.style.width=f.x+"px";this._image.style.height=f.y+"px"},_projectedToNewLayerPoint:function(a,e,m){var f=this._map.getSize()._divideBy(2);m=this._map.project(m,e)._subtract(f)._round().add(this._map._getMapPanePos());return this._transform(a,e)._subtract(m)},_transform:function(a,e){var f=this._map.options.crs,g=f.transformation,f=f.scale(e);return g.transform(a,f)}});a.Proj.imageOverlay=function(e,f,m){return new a.Proj.ImageOverlay(e,f,m)};return a.Proj});(function(a){function e(){var a=new Date,e=a.getFullYear(),f=a.getMonth()+1,g=a.getDate(),m=a.getHours(),v=a.getMinutes(),a=a.getSeconds();1<=f&&9>=f&&(f="0"+f);0<=g&&9>=g&&(g="0"+g);0<=m&&9>=m&&(m="0"+m);0<=v&&9>=v&&(v="0"+v);0<=a&&9>=a&&(a="0"+a);return e+"-"+f+"-"+g+" "+m+":"+v+":"+a}function g(a,f){var h=sessionStorage.getItem("currentUser");if(!h)return null;var g={},k=e(),h=JSON.parse(h);g.userId=h.userId;g.phoneNumber=h.phoneNumber;g.gisTimestamp=k;g.clickOrSuspend="clickFeatureLayer"==a?"0":"1";g.addressId=f.featureAttr.addressid;g.clickOrSuspendGisId=f.latlng?f.latlng.lat+","+f.latlng.lng:"";g.scale=f.resolution?JSON.stringify(f.resolution):f.zoom;return g}function f(a,f){var h=sessionStorage.getItem("currentUser");if(!h)return null;var g={},k=e(),h=JSON.parse(h);g.userId=h.userId;g.phoneNumber=h.phoneNumber;g.gisTimestamp=k;g.operationName=a;g.coordinate=f.latlng?f.latlng.lat+","+f.latlng.lng:"";g.scale=f.resolution?JSON.stringify(f.resolution):f.zoom;f.centerRectBounds?g.currentCenter=f.centerRectBounds.northEast.lat+","+f.centerRectBounds.northEast.lng+" "+f.centerRectBounds.southWest.lat+f.centerRectBounds.southWest.lng:f.centerRectBounds="";return g}function m(a,h){if(a&&h){var k={clickFeatureLayer:"1",zoomInMap:"2",zoomOutMap:"2",moveendMap:"2"}[a],p=null;"1"===k?p=g(a,h):"2"===k&&(p=f(a,h));if(p){var m=sessionStorage.getItem("currentOpenProductCode"),k={appId:m?m:"",type:k,createTime:e(),datas:[p]};console.log(k);$.ajax({type:"post",contentType:"application/json",async:!0,url:reqPrefix+"/api/product/etl/dataCollect",data:JSON.stringify(k),dataType:"json",success:function(){}})}}}a.Z={};(function(a){a.Zmap=L.Map.extend({initialize:function(a,e){this._eventFunction={};e.zoomControl=!1;e.attributionControl=!1;L.Map.prototype.initialize.call(this,a,e)},off:function(a,e){e&&L.Map.prototype.off.call(this,a,e)},getResolution:function(){var a=this.getBounds(),a=a._northEast.lat-a._southWest.lat,e=this.getSize().y;return 40008600*a/360/e},getBounds:function(){var a=L.Map.prototype.getBounds.call(this);a.northEast=a._northEast;a.southWest=a._southWest;return a},getRectangleBouds:function(a,e){var f=this.getCenter(),h=this.latLngToLayerPoint(f),f=[h.x+a/2,h.y-e/2],h=this.layerPointToLatLng([h.x-a/2,h.y+e/2]),f=this.layerPointToLatLng(f);return{southWest:h,northEast:f}},opentip:function(a,e){var f=new L.tooltip({direction:(e||{}).direction||"right"});this.mapTipLayer=(new L.circleMarker([0,0],{opacity:0,fillOpacity:0})).bindTooltip(f).addTo(this);this.mapTipLayer.openTooltip();this.mapTipLayer.setTooltipContent(a);var h=this;this.on("mousemove",function(a){null!=h.mapTipLayer&&h.mapTipLayer.setLatLng(a.latlng)})},closetip:function(){this.mapTipLayer.closeTooltip();this.mapTipLayer&&(this.mapTipLayer.remove(),this.mapTipLayer=null)},hasFeature:function(a){return this.hasLayer(a)},addFeature:function(a){a.addTo(this)},removeFeature:function(a){a.remove()},addEvent:function(a,e){var f=Object.keys(this._eventFunction).length,f="map_event_"+a+f;this.on(a,this._eventFunction[f]=function(a){e(a)});return f},removeEvent:function(a,e){if(e)this._eventFunction[e]&&this.off(a,this._eventFunction[e]);else for(var f in this._eventFunction)-1!=f.indexOf(a)&&this.off(a,this._eventFunction[f])},setListen:function(a){this._keepListen=a},setCenterRectangleSize:function(a){this._centerRectangleSize=a},getRectangleBouds:function(a,e){var f=this.getCenter(),h=this.latLngToLayerPoint(f),f=[h.x+a/2,h.y-e/2],h=this.layerPointToLatLng([h.x-a/2,h.y+e/2]),f=this.layerPointToLatLng(f);return{southWest:h,northEast:f}},addBaseLayerByUrl:function(e,f){var h=f||{},g=null;switch(e.toUpperCase()){case "TILELAYER":g=L.tileLayer(h.url,{zIndex:f.zIndex,noWrap:void 0==h.noWrap?!1:h.noWrap});break;case "WMSLAYER":g=L.tileLayer.wms(h.url,{zIndex:f.zIndex,layers:h.layerName,format:h.format||"image/png"});break;case "WMTSLAYER":for(var k=h.leftTopLatLng?h.leftTopLatLng:[90,-180],g=[],m=0;22>m;++m)g[m]={identifier:""+m,topLeftCorner:new L.LatLng(k[0],k[1])};k=h.tilematrixSet?h.tilematrixSet.replace(/[^0-9]/ig,""):"";k=L.CRS["EPSG"+k]||null;null!=k&&this.options.crs==k||console.log("\u56fe\u5c42\u672a\u8bbe\u7f6e\u5750\u6807\u7cfb\u6216\u4e0eMap\u5750\u6807\u7cfb\u4e0d\u540c\uff0c\u53ef\u80fd\u5bfc\u81f4\u56fe\u5c42\u65e0\u6cd5\u6b63\u5e38\u52a0\u8f7d,\u8bf7\u6b63\u786e\u914d\u7f6eMap\u53ca\u56fe\u5c42\u5750\u6807\u7cfb\uff01");g={zIndex:f.zIndex,layer:h.layerName||"",tilematrixSet:h.tilematrixSet||"EPSG:4326",format:h.format||"image/png",matrixIds:g,minZoom:void 0==h.minZoom?0:h.minZoom,maxZoom:void 0==h.maxZoom?22:h.maxZoom};k&&(g.crs=k);g=new L.TileLayer.WMTS(h.url,g);break;case "ESRIMAPLAYER":g=L.esri.dynamicMapLayer({zIndex:f.zIndex,url:h.url});break;case "ESRITILEMAPLAYER":g=L.esri.tiledMapLayer({zIndex:f.zIndex,url:h.url,continuousWorld:!1});break;case "ESRITILELAYER":g=new a.esriTileLayer(h.url,{zIndex:f.zIndex,minZoom:void 0==h.minZoom?0:h.minZoom,maxZoom:void 0==h.maxZoom?22:h.maxZoom});break;case "GAODETILELAYER":g=new L.tileLayer(h.url,{zIndex:f.zIndex,maxZoom:void 0==h.maxZoom?20:h.maxZoom,minZoom:void 0==h.minZoom?1:h.minZoom,subdomains:h.subdomains||["1","2","3","4"]});break;default:console.log("\u4e0d\u652f\u6301\u8be5\u56fe\u5c42\u7c7b\u578b\uff01")}null!=g&&this.addLayer(g);return g}});a.zmap=function(e,f){var h=new a.Zmap(e,f);f&&f.center||h.setView([41,120],2);h.setListen(!0);h.setCenterRectangleSize([300,200]);var g=h.getZoom(),k=h.getZoom(),q={};h.on("zoomend moveend",function(a){if(1==h._keepListen){var e={};"mousemove"==a.type?(q.mousemove&&clearTimeout(q.mousemove),q.mousemove=setTimeout(function(){var f=h.getBounds();e.bounds={northEast:f._northEast,southWest:f._southWest};a.latlng&&(e.latlng=a.latlng);f=h.getZoom();e.zoom=f;e.center=h.getCenter();e.resolution=h.getResolution();e.centerRectBounds=h.getRectangleBouds(h._centerRectangleSize[0],h._centerRectangleSize[1]);m(a.type+"Map",e)},1E3)):"moveend"==a.type?(q.moveend&&clearTimeout(q.moveend),q.moveend=setTimeout(function(){var f=h.getBounds();e.bounds={northEast:f._northEast,southWest:f._southWest};e.center=h.getCenter();e.resolution=h.getResolution();e.centerRectBounds=h.getRectangleBouds(h._centerRectangleSize[0],h._centerRectangleSize[1]);a.latlng&&(e.latlng=a.latlng);f=h.getZoom();e.zoom=f;k==f?m(a.type+"Map",e):k=f},1E3)):"zoomend"==a.type&&(q.zoomend&&clearTimeout(q.zoomend),q.zoomend=setTimeout(function(){var f=h.getBounds();e.bounds={northEast:f._northEast,southWest:f._southWest};e.center=h.getCenter();e.resolution=h.getResolution();e.centerRectBounds=h.getRectangleBouds(h._centerRectangleSize[0],h._centerRectangleSize[1]);a.latlng&&(e.latlng=a.latlng);f=h.getZoom();e.zoom=f;var k=a.type;if("zoomend"==a.type||"moveend"==a.type)f>g?k="zoomIn":f<g&&(k="zoomOut"),g=f;m(k+"Map",e)},1E3))}});return h};L.map=a.zmap;a.esriTileLayer=L.TileLayer.extend({getTileUrl:function(a){var e=a.x.toString(16),e="C"+"00000000".substring(0,8-e.length)+e,f=a.y.toString(16),f="R"+"00000000".substring(0,8-f.length)+f;return L.Util.template(this._url,L.extend({s:this._getSubdomain(a),z:1<a.z.toString().length?"L"+a.z:"L0"+a.z,x:e,y:f},this.options))}})})(Z);(function(a){a.VectorGridLayer=function(a,e){var f=e||{},h={};f.renderFactory=f.renderFactory?f.renderFactory:L.svg.tile;h[f.layerName]=e.vectorTileLayerStyles;f.vectorTileLayerStyles=h;return{layer:L.vectorGrid.protobuf(a,f)}};a.VectorGridLayer.prototype={};a.vectorGridLayer=function(e,f){return(new a.VectorGridLayer(e,f)).layer}})(Z);(function(a){a.FeatureLayer=L.FeatureGroup.extend({initialize:function(a){this._eventFunction={};L.FeatureGroup.prototype.initialize.call(this,a)},addFeature:function(a){this.addLayer(a)},addFeatures:function(a){if("[object Array]"==Object.prototype.toString.call(a))for(var e=0,f=a.length;e<f;e++)this.addLayer(a[e]);else this.addLayer(a)},removeFeature:function(a){this.removeLayer(a)},clearFeature:function(){this.clearLayers()},addEvent:function(a,e){var f=Object.keys(this._eventFunction).length,f="layer_event_"+a+f;this.on(a,this._eventFunction[f]=function(a){e(a)});return f},removeEvent:function(a,e){if(e)this._eventFunction[e]&&this.off(a,this._eventFunction[e]);else for(var f in this._eventFunction)-1!=f.indexOf(a)&&this.off(a,this._eventFunction[f])},onAdd:function(a){this.clickLayerListen=this._sendListen.bind(this);this.on("click",this.clickLayerListen);this.on("mouseover",this.clickLayerListen);L.FeatureGroup.prototype.onAdd.call(this,a)},onRemove:function(a){this.clickLayerListen&&(this.off("click",this.clickLayerListen),this.off("mouseover",this.clickLayerListen));L.FeatureGroup.prototype.onRemove.call(this,a)},_sendListen:function(a){m(a.type+"FeatureLayer",{latlng:a.latlng,layerName:a.layer.layerName,featureAttr:a.layer.attributes||{}})}});a.featureLayer=function(e,f){var h=new a.FeatureLayer(e);h.layerType="featureLayer";h.layerName="";f&&(h.attributes=f.attributes,h.layerName=f.layerName||"");return h};L.featureLayer=Z.featureLayer})(Z);(function(a){function e(a,e){var f=Object.prototype.toString.call(a);if("[object Array]"==f)for(var h=0,f=a.length;h<f;h++){var g=a[h].properties,k;for(k in g)e[k]&&(g[e[k]]=g[k],delete g[k]);a[h].properties={}}else if("[object Object]"==f){k=a.properties;for(h in k)e[h]&&(k[e[h]]=k[h],delete k[h]);a.properties=k}return a}function f(a,e,f){a=a.split(",").reverse();a=[parseFloat(a[0]),parseFloat(a[1])];a=[2.003750834E7*a[0]/180,Math.log(Math.tan((90+a[1])*Math.PI/360))/(Math.PI/180)*2.003750834E7/180];var h=[],g="",k;f=void 0==f?30:f;for(var m=0;m<f;m++){var p=12*m,p=[(a[0]+e*Math.cos(3.14*p/180))/2.003750834E7*180,180/Math.PI*(2*Math.atan(Math.exp((a[1]+e*Math.sin(3.14*p/180))/2.003750834E7*180*Math.PI/180))-Math.PI/2)];h.push(p);g=g+(p[0]+","+p[1])+" ";0==m&&(k=p)}return g+k[0]+","+k[1]}a.wfsQuery=function(a,e,h,g){e=e||{};a=a+"service\x3dWFS\x26request\x3dGetFeature\x26version\x3d1.0.0\x26maxFeatures\x3d200\x26typeName\x3d"+e.layerName+"\x26outputFormat\x3djson\x26Filter\x3d";var k;k='\x3cFilter xmlns\x3d"http://www.opengis.net/ogc" xmlns:gml\x3d"http://www.opengis.net/gml"\x3e\x3cIntersects\x3e\x3cPropertyName\x3e'+e.field+"\x3c/PropertyName\x3e";k+="\x3cgml:polygon\x3e\x3cgml:outerBoundaryIs\x3e\x3cgml:LinearRing\x3e";"polygon"==e.geometry?k=k+"\x3cgml:coordinates\x3e"+e.coordString+"\x3c/gml:coordinates\x3e":"circle"==e.geometry&&(e=f(e.coordString,e.radius),k=k+"\x3cgml:coordinates\x3e"+e+"\x3c/gml:coordinates\x3e");$.ajax({type:"POST",contentType:"text/plain;charset\x3dUTF-8",async:!0,url:a+(k+"\x3c/gml:LinearRing\x3e\x3c/gml:outerBoundaryIs\x3e\x3c/gml:polygon\x3e\x3c/Intersects\x3e\x3c/Filter\x3e"),success:function(a){h(a)},error:function(a){g(a)}})};a.vectorTileClick=function(f,h,g,k){var p=null;a.wfsQuery(f,h,function(a){if(a.features&&0<a.features.length){$.ajax({type:"get",dataType:"json",async:!1,url:"./assets/utils/dataBaseTableConfig.json",success:function(a){p=a}});a=a.features[0];var f=a.properties,k=h.coordString.split(",");m("clickFeatureLayer",{latlng:{lat:k[0],lng:k[1]},layerName:h.layerName,featureAttr:f||{}});a=p?e(a,p.geo_gd_segment_pl):a;g(a)}else g(null)},function(a){k(a)})}})(Z);(function(a){a.addFeatureLayer=function(a,e,f,g,k){return new Z.AddFeatureLayer(a,e,f,g,k)};a.AddFeatureLayer=function(e,f,g,k,m){this._data=f;this._zmap=e;this._style=k||{};this._featureType=g.toLocaleLowerCase();this._eventKeys={};this._addFeatureLayerEvent={};this._tempColor=null;this._layerName=this._style.layerName||"";this._visible=0==this._style.visible?!1:!0;this._minZoom=void 0!=this._style.minZoom?this._style.minZoom:0;this._maxZoom=void 0!=this._style.maxZoom?this._style.maxZoom:22;this.layer=new Z.featureLayer;this.layer.attributes=m||{};this._visible&&this._zmap.addLayer(this.layer);this.setData(f);this._addMoveEvent();for(var h in this.layer)a.addFeatureLayer.prototype[h]=this.layer[h]};a.AddFeatureLayer.prototype={setVisible:function(a){this._visible=a;var e=this._zmap.hasLayer(this.layer),f=this._zmap.getZoom();a?e||(this._clearLayer(),this._zmap.addLayer(this.layer),this._addMoveEvent(),f>=this._minZoom&&f<=this._maxZoom&&this._addCurExtentFeatureToLayer()):e&&(this._clearLayer(),this._zmap.removeLayer(this.layer),this._removeMoveEvent())},getVisible:function(){return this._visible},setMinZoom:function(a){this._minZoom=a;this._visible&&(a=this._zmap.getZoom(),this._updateFeature(this,a))},getMinZoom:function(){return this._minZoom},setMaxZoom:function(a){this._maxZoom=a;this._visible&&(a=this._zmap.getZoom(),this._updateFeature(this,a))},getMaxZoom:function(){return this._maxZoom},setData:function(a){this._data=a;this._dataType=Object.prototype.toString.call(a);"[object Array]"==this._dataType?this._alldata=a:"[object String]"==this._dataType&&(this._alldata=this._getData(a)||[]);this.layer instanceof L.FeatureGroup&&this.refresh()},refresh:function(){"[object String]"==this._dataType&&(this._alldata=this._getData(this._data)||[]);this._updateFeature(this,this._zmap.getZoom())},removeFromMap:function(){this._zmap.hasLayer(this.layer)&&(this._clearLayer(),this._zmap.removeLayer(this.layer),this._removeMoveEvent())},addToMap:function(){this._zmap.hasLayer(this.layer)||(this._zmap.addLayer(this.layer),this._updateFeature(),this._addMoveEvent())},onAdd:function(a){this._map=a;console.log(a)},addEvent:function(a,e){var f=Object.keys(this._eventKeys).length,f="layer_event_"+a+f;this.layer.on(a,this._eventKeys[f]=function(a){e(a)});return f},removeEvent:function(a,e){if(e)this._eventKeys[e]&&this.layer.off(a,this._eventKeys[e]);else for(var f in this._eventKeys)-1!=f.indexOf(a)&&this.layer.off(a,this._eventKeys[f])},_getBounds:function(){var a=this._zmap.getBounds();return{maxLat:a._northEast.lat,minLat:a._southWest.lat,maxLng:a._northEast.lng,minLng:a._southWest.lng}},_addCurExtentFeatureToLayer:function(){var a=this._alldata;if(null==this._tempColor){for(var e="0123456789abcdef".split(""),f="#",g=0;6>g;g++)f+=e[Math.floor(16*Math.random())];this._tempColor=f}e=this._getBounds();f=0;for(g=a.length;f<g;f++){var k=this._isInCurExtent(a[f],e);k.layerName=this._layerName;k&&("marker"==this._featureType.toLowerCase()?(k=new Z.marker([k.lat,k.lng],this._style,k),this.layer.addFeature(k)):"circlemarker"==this._featureType.toLowerCase()?(k=new Z.circleMarker([k.lat,k.lng],this._style,k),this.layer.addFeature(k)):"polyline"==this._featureType.toLowerCase()?(k=new Z.polyline(k.linePaths,this._style,k),this.layer.addFeature(k)):"polygon"==this._featureType.toLowerCase()&&(k=new Z.polygon([k.linePaths],this._style,k),this.layer.addFeature(k)))}},_isInCurExtent:function(a,e){if("marker"==this._featureType.toLowerCase()||"circlemarker"==this._featureType.toLowerCase()){var f=a.centerLat||a.lat,h=a.centerLng||a.lng;return f&&h&&f>e.minLat&&f<e.maxLat&&h<e.maxLng&&h>e.minLng?(a.lat=f,a.lng=h,a):!1}if("polyline"==this._featureType.toLowerCase()||"polygon"==this._featureType.toLowerCase()){f=this._stringLatlngToArray(a.SHAPE||a.POINTS||a.shape);if(0<f.length)for(h=0;h<f.length;h++)if(f[h][0]>e.minLat&&f[h][0]<e.maxLat&&f[h][1]<e.maxLng&&f[h][1]>e.minLng)return a.linePaths=f,a;return!1}},_clearLayer:function(){this.layer.clearFeature()},_addMoveEvent:function(){this._addFeatureLayerEvent=this._updateFeature.bind(this);this._eventKey=this._zmap.on("moveend",this._addFeatureLayerEvent)},_removeMoveEvent:function(){this._zmap.off("moveend",this._addFeatureLayerEvent)},_updateFeature:function(){var a=this._zmap.getZoom();if(this._visible){var e=this._zmap.hasLayer(this.layer);a>=this._minZoom&&a<=this._maxZoom?(this._clearLayer(),this._addCurExtentFeatureToLayer(),e||this._zmap.addLayer(this.layer)):e&&this._zmap.removeLayer(this.layer)}},_getData:function(a){var e;$.ajax({type:"get",async:!1,url:a,dataType:"json",success:function(a){e=a},error:function(a){console.log(a)}});return e},_stringLatlngToArray:function(a){a=a.replace("MULTILINESTRING","");a=a.replace("LINESTRING","");a=a.replace("POLYGON","");a=a.replace(/\(/g,"").replace(/\)/g,"");a=a.split(",");for(var e=[],f=0;f<a.length;f++){a[f]=a[f].replace(/(^\s*)|(\s*$)/g,"");a[f]=a[f].split(" ");var h=[parseFloat(a[f][1]),parseFloat(a[f][0])];e.push(h)}return e}}})(Z);(function(a){a.HeatLayer=L.HeatLayer.extend({initialize:function(a,e){null!=a&&void 0!=a?"object"==typeof a?(this._alldata=a,this._serviceUrl=""):"string"==typeof a?(this._serviceUrl=a,this._alldata=this._getDataFromService()):(this._alldata=[],this._serviceUrl=""):(this._alldata=[],this._serviceUrl="");this._options=e||{};var f={minOpacity:this._options.maxOpacity||1,maxZoom:this._options.maxZoom||22,minZoom:this._options.minZoom||0,max:this._options.max||1,radius:this._options.radius||25,blur:this._options.blur||15,gradient:this._options.gradient||{1:"rgba(255,0,0,1)","0.9":"rgba(255,255,0,1)","0.8":"rgba(0,255,0,1)","0.5":"rgba(0,255,255,1)",0:"rgba(0,0,255,1)"}};this._heatData=this._getHeatmapData();L.HeatLayer.prototype.initialize.call(this,this._heatData,f)},_getHeatmapData:function(){var a=this._alldata.length;if(0==a)return[[0,0,0]];for(var e=[],f=0;f<a;f++){var g=this._alldata[f].centerLat||this._alldata[f].lat,k=this._alldata[f].centerLng||this._alldata[f].lng;g&&k&&e.push([g,k,.5])}return e},_getDataFromService:function(a){var e;void 0!=a&&(this._serviceUrl=a);if(""==this._serviceUrl)return[];$.ajax({type:"get",async:!1,url:this._serviceUrl,dataType:"json",success:function(a){e=a},error:function(a){console.log(a)}});return e},onAdd:function(a){this._map=a;this._eventFunction=this._updateFeature.bind(this);this._map.on("moveend",this._eventFunction);this._zminZoom=void 0!=this._options.minZoom?this._options.minZoom:0;this._zmaxZoom=void 0!=this._options.maxZoom?this._options.maxZoom:this._map.getMaxZoom();this._resetEventFunction=this._reset.bind(this);this._animateZoomEventFunction=this._animateZoom.bind(this);t=a;this._canvas||this._initCanvas();this._isShow&&t._panes.overlayPane.appendChild(this._canvas);t.on("moveend",this._resetEventFunction);t.options.zoomAnimation&&L.Browser.any3d&&t.on("zoomanim",this._animateZoomEventFunction);this._reset()},onRemove:function(){this._map.off("moveend",this._eventFunction);this._isShow&&t.getPanes().overlayPane.removeChild(this._canvas);t.off("moveend",this._resetEventFunction);t.options.zoomAnimation&&t.off("zoomanim",this._animateZoomEventFunction);this._map=null},_updateFeature:function(){var a=this._map.getZoom(),e=this.getShowState();a>=this._zminZoom&&a<=this._zmaxZoom?e||this.addCanvas(this._map):e&&this.removeCanvas(this._map)},setOptions:function(a){L.HeatLayer.prototype.setOptions.call(this,a)},addData:function(a){var e=a.lat;a=a.lng;e&&a&&(e=[e,a,.5],this._heatData.push(e),L.HeatLayer.prototype.addLatLng.call(this,e))},setData:function(a){this._alldata=a;this._heatData=this._getHeatmapData();L.HeatLayer.prototype.setLatLngs.call(this,this._heatData)},refresh:function(a){this._alldata=this._getDataFromService(a);this._heatData=this._getHeatmapData();L.HeatLayer.prototype.setLatLngs.call(this,this._heatData)},redraw:function(){L.HeatLayer.prototype.redraw.call(this)}});a.heatLayer=function(e,f){return new a.HeatLayer(e,f)}})(Z);(function(a){a.MarkerClusterLayer=L.MarkerClusterGroup.extend({initialize:function(a,e,f){null!=a&&void 0!=a?"object"==typeof a?(this._alldata=a,this._serviceUrl=""):"string"==typeof a?(this._serviceUrl=a,this._alldata=this._getDataFromService()):(this._alldata=[],this._serviceUrl=""):(this._alldata=[],this._serviceUrl="");this._allMarkers=[];this._options=e||{};this._iconStyle=f||{};this._eventKeys={};this._isAddFeatures=!0;L.MarkerClusterGroup.prototype.initialize.call(this,{showCoverageOnHover:this._options.showCoverageOnHover||!1,zoomToBoundsOnClick:this._options.zoomToBoundsOnClick||!1,spiderfyOnMaxZoom:this._options.spiderfyOnMaxZoom||!1,disableClusteringAtZoom:this._options.disableClusteringAtZoom||18,maxClusterRadius:this._options.maxClusterRadius||80,animate:this._options.animate||!0,iconCreateFunction:this._options.IconCreateFunction||null});this._alldata!=[]&&void 0!=this._alldata&&this._addDataToLayer()},onAdd:function(a){this._zmap=a;this._eventFunction=this._updateEvent.bind(this);this._zmap.on("moveend",this._eventFunction);this._zminZoom=void 0!=this._options.minZoom?this._options.minZoom:0;this._zmaxZoom=void 0!=this._options.maxZoom?this._options.maxZoom:this._map.getMaxZoom();var e,f;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";this._featureGroup.addTo(a);this._nonPointGroup.addTo(a);this._gridClusters||this._generateInitialClusters();this._maxLat=a.options.crs.projection.MAX_LATITUDE;a=0;for(e=this._needsRemoving.length;a<e;a++)f=this._needsRemoving[a],f.newlatlng=f.layer._latlng,f.layer._latlng=f.latlng;a=0;for(e=this._needsRemoving.length;a<e;a++)f=this._needsRemoving[a],this._removeLayer(f.layer,!0),f.layer._latlng=f.newlatlng;this._needsRemoving=[];this._zoom=Math.round(this._map._zoom);this._currentShownBounds=this._getExpandedVisibleBounds();this._zoomEndEventFunction=this._zoomEnd.bind(this);this._moveEndEventFunction=this._moveEnd.bind(this);this._map.on("zoomend",this._zoomEndEventFunction);this._map.on("moveend",this._moveEndEventFunction);this._spiderfierOnAdd&&this._spiderfierOnAdd();this._bindEvents();e=this._needsClustering;this._needsClustering=[];this.addLayers(e,!0);a=this._zmap.getZoom();(a>this._zmaxZoom||a<this._zminZoom)&&this.clearLayers()},onRemove:function(a){this._zmap.off("moveend",this._eventFunction);a.off("zoomend",this._zoomEndEventFunction);a.off("moveend",this._moveEndEventFunction);this._unbindEvents();this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","");this._spiderfierOnRemove&&this._spiderfierOnRemove();delete this._maxLat;this._hideCoverage();this._featureGroup.remove();this._nonPointGroup.remove();this._featureGroup.clearLayers();this._zmap=null},_addDataToLayer:function(){var a=this._alldata.length;if(0!=a)for(var e=0;e<a;e++){var f=this._alldata[e].centerLat||this._alldata[e].lat,g=this._alldata[e].centerLng||this._alldata[e].lng,k;k=this._iconStyle.type&&"divIcon"==this._iconStyle.type?L.divIcon(this._iconStyle):L.icon(this._iconStyle);f&&g&&(this._alldata[e].lat=f,this._alldata[e].lng=g,f=L.marker(new L.LatLng(f,g),{icon:k}),f.attributes=this._alldata[e],this.addFeature(f))}},_updateEvent:function(){if(this._zmap){var a=this._zmap.getZoom();a>=this._zminZoom&&a<=this._zmaxZoom?this._isAddFeatures||(this._addFeatures(),this._isAddFeatures=!0):this._isAddFeatures&&(this.clearLayers(),this._isAddFeatures=!1)}},_addFeatures:function(){if(this._allMarkers)for(var a=0,e=this._allMarkers.length;a<e;a++)this.addLayer(this._allMarkers[a])},_getDataFromService:function(a){var e=[];void 0!=a&&(this._serviceUrl=a);if(""==this._serviceUrl)return e;$.ajax({type:"get",async:!1,url:this._serviceUrl,dataType:"json",success:function(a){e=a},error:function(a){console.log("\u6570\u636e\u83b7\u53d6\u5931\u8d25\uff01"+a)}});return e},addEvent:function(a,e){var f=Object.keys(this._eventKeys).length,f="layer_event_"+a+f;this.on(a,this._eventKeys[f]=function(a){e(a)});return f},removeEvent:function(a,e){if(e)this._eventKeys[e]&&this.off(a,this._eventKeys[e]);else for(var f in this._eventKeys)-1!=f.indexOf(a)&&this.off(a,this._eventKeys[f])},addFeature:function(a){this._allMarkers.push(a);L.MarkerClusterGroup.prototype.addLayer.call(this,a)},clearFeatures:function(){this._allMarkers=[];L.MarkerClusterGroup.prototype.clearLayers.call(this)},setFeatures:function(a){this._allMarkers=a;this.clearLayers();this._addFeatures()},setData:function(a){this._alldata=a;this.clearFeatures();this._addDataToLayer()},refresh:function(a){this._alldata=this._getDataFromService(a);this.clearFeatures();this._addDataToLayer()}});a.markerClusterLayer=function(e,f,g){return new a.MarkerClusterLayer(e,f,g)}})(Z);(function(a){a.draw=function(a){this._map=a;this._type=null;this._pointAry=[];this._container=this._map._container;this._currentLayer=this._tempLayer=null;this._layerAry=[];this._radius=this._center=null;this.eventElement={}};a.draw.prototype={startDraw:function(a,e){this.stop();this._type=a.toLowerCase();this._map.doubleClickZoom.disable();this.eventElement.mousemove=this._onMove.bind(this);this.eventElement.click=this._onClick.bind(this);this.eventElement.dblclick=this._onFinish.bind(this,e);this.eventElement.mousedown=this._onmouseDown.bind(this);this.eventElement.mouseup=this._onmouseUp.bind(this,e);this._map.on("mousemove",this.eventElement.mousemove);this._map.on("click",this.eventElement.click);this._container.style.cursor="crosshair";if("circle"==this._type||"rectangle"==this._type)this._map.on("mousedown",this.eventElement.mousedown),this._map.on("mouseup",this.eventElement.mouseup);this._map.on("dblclick",this.eventElement.dblclick)},_onClick:function(a){a=a.latlng;"polyline"==this._type?(this._pointAry.push(a),1<this._pointAry.length&&(this._currentLayer?this._currentLayer.addLatLng(a):(this._currentLayer=new L.polyline([this._pointAry[0],this._pointAry[1]]),this._currentLayer.addTo(this._map)))):"polygon"==this._type?(this._pointAry.push(a),1<this._pointAry.length&&(this._currentLayer?this._currentLayer.addLatLng(a):(this._currentLayer=new L.polyline([this._pointAry[0],this._pointAry[1]]),this._currentLayer.addTo(this._map)))):"point"==this._type&&(this._pointAry.push(a),this._currentLayer=new L.circleMarker(a),this._currentLayer.addTo(this._map),this._layerAry.push(this._currentLayer),this._currentLayer=null)},_onmouseDown:function(a){this._map.dragging.disable();this._center=a.latlng;"circle"==this._type&&(this._currentLayer=L.circle(this._center,{radius:0}),this._currentLayer.addTo(this._map));"rectangle"==this._type&&(this._currentLayer=L.rectangle([this._center,this._center]),this._currentLayer.addTo(this._map))},_onmouseUp:function(a){var e;"circle"==this._type?e={type:this._type,center:this._center,radius:this._radius}:(e=this._currentLayer.getLatLngs(),e[0].push(e[0][0]),e={type:this._type,rectBounds:e});this._layerAry.push(this._currentLayer);this._currentLayer=this._center=null;this._map.dragging.enable();a&&a(e)},_onMove:function(a){a=a.latlng;"polyline"==this._type?0<this._pointAry.length&&(this._tempLayer?this._tempLayer.setLatLngs([this._pointAry[this._pointAry.length-1],a]):(this._tempLayer=new L.polyline([this._pointAry[this._pointAry.length-1],a]),this._tempLayer.addTo(this._map))):"polygon"==this._type?0<this._pointAry.length&&(this._tempLayer?this._tempLayer.setLatLngs([this._pointAry[0],a]):(this._tempLayer=new L.polyline([this._pointAry[this._pointAry.length-1],a]),this._tempLayer.addTo(this._map)),this._tempLayer1?this._tempLayer1.setLatLngs([this._pointAry[this._pointAry.length-1],a]):(this._tempLayer1=new L.polyline([this._pointAry[this._pointAry.length-1],a]),this._tempLayer1.addTo(this._map))):"circle"==this._type?this._center&&(this._radius=L.latLng(a).distanceTo(this._center),this._currentLayer.setRadius(this._radius)):"rectangle"==this._type&&this._center&&(this._rectBounds=[this._center,a],this._currentLayer.setBounds(this._rectBounds))},_onFinish:function(a){this._tempLayer&&(this._tempLayer.remove(),this._tempLayer=null);this._tempLayer1&&(this._tempLayer1.remove(),this._tempLayer1=null);if("point"==this._type||"polyline"==this._type)"point"==this._type&&(this._layerAry[this._layerAry.length-1].remove(),this._layerAry.pop()),this._pointAry.pop();"polygon"==this._type&&(this._pointAry.pop(),this._currentLayer&&(this._currentLayer.remove(),this._currentLayer=null),this._pointAry.push(this._pointAry[0]),this._currentLayer=(new L.polygon(this._pointAry)).addTo(this._map));if("circle"==this._type||"rectangle"==this._type)this._layerAry[this._layerAry.length-1].remove(),this._pointAry.pop(),this._layerAry[this._layerAry.length-2].remove(),this._pointAry.pop();var e={type:this._type,latLngAry:this._pointAry||[]};this._pointAry=[];this._currentLayer&&(this._layerAry.push(this._currentLayer),this._currentLayer=null);a&&a(e)},clearResult:function(){if(0<this._layerAry.length)for(var a=0;a<this._layerAry.length;a++)this._layerAry[a].remove()},cancel:function(){this._pointAry=[];this._radius=this._center=null;this._currentLayer&&(this._currentLayer.remove(),this._currentLayer=null);this._tempLayer&&(this._tempLayer.remove(),this._tempLayer=null);this._tempLayer1&&(this._tempLayer1.remove(),this._tempLayer1=null)},stop:function(){this.cancel();this._map.off("mousedown",this.eventElement.mousedown);this._map.off("mouseup",this.eventElement.mouseup);this._map.off("mousemove",this.eventElement.mousemove);this._map.off("click",this.eventElement.click);this._map.off("dblclick",this.eventElement.dblclick);this._container.style.cursor=""}}})(Z);(function(a){a.CircleMarker=L.CircleMarker.extend({});a.circleMarker=function(e,f,g){e=new a.CircleMarker(e,f);g&&(e.attributes=g);return e};L.circleMarker=a.circleMarker})(Z);(function(a){a.Marker=L.Marker.extend({initialize:function(a,e){this.iconOpt=e||{};var f,h=null;void 0!=this.iconOpt.icon&&(this.iconOpt.icon instanceof L.Icon||this.iconOpt.icon instanceof L.DivIcon)?h=this.iconOpt.icon:void 0!=this.iconOpt.icon&&"string"==typeof this.iconOpt.icon||void 0!=this.iconOpt.iconUrl&&"string"==typeof this.iconOpt.iconUrl?(this.iconOpt.iconUrl=this.iconOpt.icon||this.iconOpt.iconUrl,h=L.icon(this.iconOpt)):this.iconOpt.html&&"string"==typeof this.iconOpt.html&&(h=L.divIcon(this.iconOpt));f=this.iconOpt;h&&(f.icon=h);L.Marker.prototype.initialize.call(this,a,f)},flashMarker:function(a,e){var f=0,h=this;this.intervalKey=setInterval(function(){f++;5<f?clearInterval(h.intervalKey):0==f%2?h.remove():h.addTo(e)},a)},setLatLng:function(a,e){L.Marker.prototype.setLatLng.call(this,a);e&&e instanceof Z.Zmap&&this.flashMarker(500,e)},setIcon:function(a){var e=Object.prototype.toString.call(a),f;"[object String]"==e?(this.iconOpt.iconUrl=a,f=L.icon(this.iconOpt)):"[object Object]"==e&&(f=e instanceof L.Icon?L.icon(a):a);L.Marker.prototype.setIcon.call(this,f)},setDivIcon:function(a){var e=Object.prototype.toString.call(a),f;"[object String]"==e?(this.iconOpt.html=a,f=L.divIcon(this.iconOpt)):"[object Object]"==e&&(f=L.divIcon(a));L.Marker.prototype.setIcon.call(this,f)},alertSelf:function(){alert("i am z.marker!")}});a.marker=function(e,f,g){e=new a.Marker(e,f);g&&(e.attributes=g);return e};L.marker=a.marker})(Z);(function(a){a.Polyline=L.Polyline.extend({});a.polyline=function(e,f,g){e=new a.Polyline(e,f,g);e.attributes=g||"";return e};L.polyline=a.polyline})(Z);(function(a){a.Polygon=L.Polygon.extend({});a.polygon=function(e,f,g){e=new a.Polygon(e,f);e.attributes=g||"";return e};L.polygon=a.polygon})(Z);(function(a){a.Popup=L.Popup.extend({});a.popup=function(e){return new a.Popup(e)}})(Z);(function(a){a.Tooltip=L.Tooltip.extend({});a.tooltip=function(e){return new a.Tooltip(e)}})(Z);(function(a){a.Proj={};a.Proj.crs=L.Proj.CRS.extend({initialize:function(a,e,f){L.Proj.CRS.prototype.initialize.call(this,a,e,f)}});a.Proj.CRS=function(a,e,f){return new Z.Proj.crs(a,e,f)}})(Z)})(window);